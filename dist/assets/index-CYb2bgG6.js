(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ex(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ap(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var dd={exports:{}},ho={},fd={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ys=Symbol.for("react.element"),lp=Symbol.for("react.portal"),cp=Symbol.for("react.fragment"),up=Symbol.for("react.strict_mode"),dp=Symbol.for("react.profiler"),fp=Symbol.for("react.provider"),hp=Symbol.for("react.context"),pp=Symbol.for("react.forward_ref"),mp=Symbol.for("react.suspense"),gp=Symbol.for("react.memo"),yp=Symbol.for("react.lazy"),Ac=Symbol.iterator;function vp(e){return e===null||typeof e!="object"?null:(e=Ac&&e[Ac]||e["@@iterator"],typeof e=="function"?e:null)}var hd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pd=Object.assign,md={};function Xr(e,t,n){this.props=e,this.context=t,this.refs=md,this.updater=n||hd}Xr.prototype.isReactComponent={};Xr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gd(){}gd.prototype=Xr.prototype;function Tl(e,t,n){this.props=e,this.context=t,this.refs=md,this.updater=n||hd}var Ll=Tl.prototype=new gd;Ll.constructor=Tl;pd(Ll,Xr.prototype);Ll.isPureReactComponent=!0;var $c=Array.isArray,yd=Object.prototype.hasOwnProperty,Rl={current:null},vd={key:!0,ref:!0,__self:!0,__source:!0};function xd(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)yd.call(t,r)&&!vd.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ys,type:e,key:i,ref:o,props:s,_owner:Rl.current}}function xp(e,t){return{$$typeof:Ys,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Al(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ys}function wp(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Oc=/\/+/g;function Ho(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wp(""+e.key):t.toString(36)}function Ci(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ys:case lp:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Ho(o,0):r,$c(s)?(n="",e!=null&&(n=e.replace(Oc,"$&/")+"/"),Ci(s,t,n,"",function(u){return u})):s!=null&&(Al(s)&&(s=xp(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Oc,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",$c(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Ho(i,l);o+=Ci(i,t,n,c,s)}else if(c=vp(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Ho(i,l++),o+=Ci(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function oi(e,t,n){if(e==null)return e;var r=[],s=0;return Ci(e,r,"","",function(i){return t.call(n,i,s++)}),r}function _p(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ut={current:null},Pi={transition:null},bp={ReactCurrentDispatcher:ut,ReactCurrentBatchConfig:Pi,ReactCurrentOwner:Rl};function wd(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:oi,forEach:function(e,t,n){oi(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return oi(e,function(){t++}),t},toArray:function(e){return oi(e,function(t){return t})||[]},only:function(e){if(!Al(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};he.Component=Xr;he.Fragment=cp;he.Profiler=dp;he.PureComponent=Tl;he.StrictMode=up;he.Suspense=mp;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bp;he.act=wd;he.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=pd({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Rl.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)yd.call(t,c)&&!vd.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ys,type:e.type,key:s,ref:i,props:r,_owner:o}};he.createContext=function(e){return e={$$typeof:hp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fp,_context:e},e.Consumer=e};he.createElement=xd;he.createFactory=function(e){var t=xd.bind(null,e);return t.type=e,t};he.createRef=function(){return{current:null}};he.forwardRef=function(e){return{$$typeof:pp,render:e}};he.isValidElement=Al;he.lazy=function(e){return{$$typeof:yp,_payload:{_status:-1,_result:e},_init:_p}};he.memo=function(e,t){return{$$typeof:gp,type:e,compare:t===void 0?null:t}};he.startTransition=function(e){var t=Pi.transition;Pi.transition={};try{e()}finally{Pi.transition=t}};he.unstable_act=wd;he.useCallback=function(e,t){return ut.current.useCallback(e,t)};he.useContext=function(e){return ut.current.useContext(e)};he.useDebugValue=function(){};he.useDeferredValue=function(e){return ut.current.useDeferredValue(e)};he.useEffect=function(e,t){return ut.current.useEffect(e,t)};he.useId=function(){return ut.current.useId()};he.useImperativeHandle=function(e,t,n){return ut.current.useImperativeHandle(e,t,n)};he.useInsertionEffect=function(e,t){return ut.current.useInsertionEffect(e,t)};he.useLayoutEffect=function(e,t){return ut.current.useLayoutEffect(e,t)};he.useMemo=function(e,t){return ut.current.useMemo(e,t)};he.useReducer=function(e,t,n){return ut.current.useReducer(e,t,n)};he.useRef=function(e){return ut.current.useRef(e)};he.useState=function(e){return ut.current.useState(e)};he.useSyncExternalStore=function(e,t,n){return ut.current.useSyncExternalStore(e,t,n)};he.useTransition=function(){return ut.current.useTransition()};he.version="18.3.1";fd.exports=he;var p=fd.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp=p,Sp=Symbol.for("react.element"),jp=Symbol.for("react.fragment"),Np=Object.prototype.hasOwnProperty,Ep=kp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cp={key:!0,ref:!0,__self:!0,__source:!0};function _d(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Np.call(t,r)&&!Cp.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Sp,type:e,key:i,ref:o,props:s,_owner:Ep.current}}ho.Fragment=jp;ho.jsx=_d;ho.jsxs=_d;dd.exports=ho;var a=dd.exports,bd={exports:{}},Ct={},kd={exports:{}},Sd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(w,E){var M=w.length;w.push(E);e:for(;0<M;){var D=M-1>>>1,C=w[D];if(0<s(C,E))w[D]=E,w[M]=C,M=D;else break e}}function n(w){return w.length===0?null:w[0]}function r(w){if(w.length===0)return null;var E=w[0],M=w.pop();if(M!==E){w[0]=M;e:for(var D=0,C=w.length,T=C>>>1;D<T;){var I=2*(D+1)-1,ee=w[I],ue=I+1,me=w[ue];if(0>s(ee,M))ue<C&&0>s(me,ee)?(w[D]=me,w[ue]=M,D=ue):(w[D]=ee,w[I]=M,D=I);else if(ue<C&&0>s(me,M))w[D]=me,w[ue]=M,D=ue;else break e}}return E}function s(w,E){var M=w.sortIndex-E.sortIndex;return M!==0?M:w.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,m=3,v=!1,x=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(w){for(var E=n(u);E!==null;){if(E.callback===null)r(u);else if(E.startTime<=w)r(u),E.sortIndex=E.expirationTime,t(c,E);else break;E=n(u)}}function _(w){if(b=!1,y(w),!x)if(n(c)!==null)x=!0,J(S);else{var E=n(u);E!==null&&ne(_,E.startTime-w)}}function S(w,E){x=!1,b&&(b=!1,g(A),A=-1),v=!0;var M=m;try{for(y(E),h=n(c);h!==null&&(!(h.expirationTime>E)||w&&!j());){var D=h.callback;if(typeof D=="function"){h.callback=null,m=h.priorityLevel;var C=D(h.expirationTime<=E);E=e.unstable_now(),typeof C=="function"?h.callback=C:h===n(c)&&r(c),y(E)}else r(c);h=n(c)}if(h!==null)var T=!0;else{var I=n(u);I!==null&&ne(_,I.startTime-E),T=!1}return T}finally{h=null,m=M,v=!1}}var N=!1,P=null,A=-1,$=5,O=-1;function j(){return!(e.unstable_now()-O<$)}function B(){if(P!==null){var w=e.unstable_now();O=w;var E=!0;try{E=P(!0,w)}finally{E?Y():(N=!1,P=null)}}else N=!1}var Y;if(typeof f=="function")Y=function(){f(B)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,K=X.port2;X.port1.onmessage=B,Y=function(){K.postMessage(null)}}else Y=function(){k(B,0)};function J(w){P=w,N||(N=!0,Y())}function ne(w,E){A=k(function(){w(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(w){w.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,J(S))},e.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<w?Math.floor(1e3/w):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(w){switch(m){case 1:case 2:case 3:var E=3;break;default:E=m}var M=m;m=E;try{return w()}finally{m=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(w,E){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var M=m;m=w;try{return E()}finally{m=M}},e.unstable_scheduleCallback=function(w,E,M){var D=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?D+M:D):M=D,w){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=M+C,w={id:d++,callback:E,priorityLevel:w,startTime:M,expirationTime:C,sortIndex:-1},M>D?(w.sortIndex=M,t(u,w),n(c)===null&&w===n(u)&&(b?(g(A),A=-1):b=!0,ne(_,M-D))):(w.sortIndex=C,t(c,w),x||v||(x=!0,J(S))),w},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(w){var E=m;return function(){var M=m;m=E;try{return w.apply(this,arguments)}finally{m=M}}}})(Sd);kd.exports=Sd;var Pp=kd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tp=p,Et=Pp;function R(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jd=new Set,Rs={};function cr(e,t){Br(e,t),Br(e+"Capture",t)}function Br(e,t){for(Rs[e]=t,e=0;e<t.length;e++)jd.add(t[e])}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ta=Object.prototype.hasOwnProperty,Lp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zc={},Mc={};function Rp(e){return Ta.call(Mc,e)?!0:Ta.call(zc,e)?!1:Lp.test(e)?Mc[e]=!0:(zc[e]=!0,!1)}function Ap(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $p(e,t,n,r){if(t===null||typeof t>"u"||Ap(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tt[e]=new dt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tt[t]=new dt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tt[e]=new dt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tt[e]=new dt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tt[e]=new dt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tt[e]=new dt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tt[e]=new dt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tt[e]=new dt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tt[e]=new dt(e,5,!1,e.toLowerCase(),null,!1,!1)});var $l=/[\-:]([a-z])/g;function Ol(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tt[e]=new dt(e,1,!1,e.toLowerCase(),null,!1,!1)});tt.xlinkHref=new dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tt[e]=new dt(e,1,!1,e.toLowerCase(),null,!0,!0)});function zl(e,t,n,r){var s=tt.hasOwnProperty(t)?tt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($p(t,n,s,r)&&(n=null),r||s===null?Rp(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xn=Tp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ai=Symbol.for("react.element"),br=Symbol.for("react.portal"),kr=Symbol.for("react.fragment"),Ml=Symbol.for("react.strict_mode"),La=Symbol.for("react.profiler"),Nd=Symbol.for("react.provider"),Ed=Symbol.for("react.context"),Dl=Symbol.for("react.forward_ref"),Ra=Symbol.for("react.suspense"),Aa=Symbol.for("react.suspense_list"),Il=Symbol.for("react.memo"),Sn=Symbol.for("react.lazy"),Cd=Symbol.for("react.offscreen"),Dc=Symbol.iterator;function os(e){return e===null||typeof e!="object"?null:(e=Dc&&e[Dc]||e["@@iterator"],typeof e=="function"?e:null)}var Me=Object.assign,Go;function ms(e){if(Go===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Go=t&&t[1]||""}return`
`+Go+e}var qo=!1;function Wo(e,t){if(!e||qo)return"";qo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{qo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ms(e):""}function Op(e){switch(e.tag){case 5:return ms(e.type);case 16:return ms("Lazy");case 13:return ms("Suspense");case 19:return ms("SuspenseList");case 0:case 2:case 15:return e=Wo(e.type,!1),e;case 11:return e=Wo(e.type.render,!1),e;case 1:return e=Wo(e.type,!0),e;default:return""}}function $a(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case kr:return"Fragment";case br:return"Portal";case La:return"Profiler";case Ml:return"StrictMode";case Ra:return"Suspense";case Aa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ed:return(e.displayName||"Context")+".Consumer";case Nd:return(e._context.displayName||"Context")+".Provider";case Dl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Il:return t=e.displayName||null,t!==null?t:$a(e.type)||"Memo";case Sn:t=e._payload,e=e._init;try{return $a(e(t))}catch{}}return null}function zp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $a(t);case 8:return t===Ml?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Pd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mp(e){var t=Pd(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function li(e){e._valueTracker||(e._valueTracker=Mp(e))}function Td(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Pd(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Fi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Oa(e,t){var n=t.checked;return Me({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ic(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Fn(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ld(e,t){t=t.checked,t!=null&&zl(e,"checked",t,!1)}function za(e,t){Ld(e,t);var n=Fn(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ma(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ma(e,t.type,Fn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Fc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ma(e,t,n){(t!=="number"||Fi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var gs=Array.isArray;function Or(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Fn(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Da(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(R(91));return Me({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Uc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(R(92));if(gs(n)){if(1<n.length)throw Error(R(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Fn(n)}}function Rd(e,t){var n=Fn(t.value),r=Fn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Bc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ad(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ia(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ad(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ci,$d=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ci=ci||document.createElement("div"),ci.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ci.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function As(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ws={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dp=["Webkit","ms","Moz","O"];Object.keys(ws).forEach(function(e){Dp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ws[t]=ws[e]})});function Od(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ws.hasOwnProperty(e)&&ws[e]?(""+t).trim():t+"px"}function zd(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Od(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Ip=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fa(e,t){if(t){if(Ip[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(R(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(R(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(R(61))}if(t.style!=null&&typeof t.style!="object")throw Error(R(62))}}function Ua(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ba=null;function Fl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Va=null,zr=null,Mr=null;function Vc(e){if(e=ei(e)){if(typeof Va!="function")throw Error(R(280));var t=e.stateNode;t&&(t=vo(t),Va(e.stateNode,e.type,t))}}function Md(e){zr?Mr?Mr.push(e):Mr=[e]:zr=e}function Dd(){if(zr){var e=zr,t=Mr;if(Mr=zr=null,Vc(e),t)for(e=0;e<t.length;e++)Vc(t[e])}}function Id(e,t){return e(t)}function Fd(){}var Ko=!1;function Ud(e,t,n){if(Ko)return e(t,n);Ko=!0;try{return Id(e,t,n)}finally{Ko=!1,(zr!==null||Mr!==null)&&(Fd(),Dd())}}function $s(e,t){var n=e.stateNode;if(n===null)return null;var r=vo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(R(231,t,typeof n));return n}var Ha=!1;if(pn)try{var as={};Object.defineProperty(as,"passive",{get:function(){Ha=!0}}),window.addEventListener("test",as,as),window.removeEventListener("test",as,as)}catch{Ha=!1}function Fp(e,t,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var _s=!1,Ui=null,Bi=!1,Ga=null,Up={onError:function(e){_s=!0,Ui=e}};function Bp(e,t,n,r,s,i,o,l,c){_s=!1,Ui=null,Fp.apply(Up,arguments)}function Vp(e,t,n,r,s,i,o,l,c){if(Bp.apply(this,arguments),_s){if(_s){var u=Ui;_s=!1,Ui=null}else throw Error(R(198));Bi||(Bi=!0,Ga=u)}}function ur(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Bd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Hc(e){if(ur(e)!==e)throw Error(R(188))}function Hp(e){var t=e.alternate;if(!t){if(t=ur(e),t===null)throw Error(R(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Hc(s),e;if(i===r)return Hc(s),t;i=i.sibling}throw Error(R(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?e:t}function Vd(e){return e=Hp(e),e!==null?Hd(e):null}function Hd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Hd(e);if(t!==null)return t;e=e.sibling}return null}var Gd=Et.unstable_scheduleCallback,Gc=Et.unstable_cancelCallback,Gp=Et.unstable_shouldYield,qp=Et.unstable_requestPaint,Ue=Et.unstable_now,Wp=Et.unstable_getCurrentPriorityLevel,Ul=Et.unstable_ImmediatePriority,qd=Et.unstable_UserBlockingPriority,Vi=Et.unstable_NormalPriority,Kp=Et.unstable_LowPriority,Wd=Et.unstable_IdlePriority,po=null,rn=null;function Qp(e){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(po,e,void 0,(e.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:Xp,Jp=Math.log,Yp=Math.LN2;function Xp(e){return e>>>=0,e===0?32:31-(Jp(e)/Yp|0)|0}var ui=64,di=4194304;function ys(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Hi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ys(l):(i&=o,i!==0&&(r=ys(i)))}else o=n&~s,o!==0?r=ys(o):i!==0&&(r=ys(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Kt(t),s=1<<n,r|=e[n],t&=~s;return r}function Zp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function em(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Kt(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Zp(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function qa(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Kd(){var e=ui;return ui<<=1,!(ui&4194240)&&(ui=64),e}function Qo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Xs(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kt(t),e[t]=n}function tm(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Kt(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Bl(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Kt(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var _e=0;function Qd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jd,Vl,Yd,Xd,Zd,Wa=!1,fi=[],Rn=null,An=null,$n=null,Os=new Map,zs=new Map,En=[],nm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qc(e,t){switch(e){case"focusin":case"focusout":Rn=null;break;case"dragenter":case"dragleave":An=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":Os.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zs.delete(t.pointerId)}}function ls(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=ei(t),t!==null&&Vl(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function rm(e,t,n,r,s){switch(t){case"focusin":return Rn=ls(Rn,e,t,n,r,s),!0;case"dragenter":return An=ls(An,e,t,n,r,s),!0;case"mouseover":return $n=ls($n,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Os.set(i,ls(Os.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,zs.set(i,ls(zs.get(i)||null,e,t,n,r,s)),!0}return!1}function ef(e){var t=Xn(e.target);if(t!==null){var n=ur(t);if(n!==null){if(t=n.tag,t===13){if(t=Bd(n),t!==null){e.blockedOn=t,Zd(e.priority,function(){Yd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ti(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ka(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ba=r,n.target.dispatchEvent(r),Ba=null}else return t=ei(n),t!==null&&Vl(t),e.blockedOn=n,!1;t.shift()}return!0}function Wc(e,t,n){Ti(e)&&n.delete(t)}function sm(){Wa=!1,Rn!==null&&Ti(Rn)&&(Rn=null),An!==null&&Ti(An)&&(An=null),$n!==null&&Ti($n)&&($n=null),Os.forEach(Wc),zs.forEach(Wc)}function cs(e,t){e.blockedOn===t&&(e.blockedOn=null,Wa||(Wa=!0,Et.unstable_scheduleCallback(Et.unstable_NormalPriority,sm)))}function Ms(e){function t(s){return cs(s,e)}if(0<fi.length){cs(fi[0],e);for(var n=1;n<fi.length;n++){var r=fi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Rn!==null&&cs(Rn,e),An!==null&&cs(An,e),$n!==null&&cs($n,e),Os.forEach(t),zs.forEach(t),n=0;n<En.length;n++)r=En[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<En.length&&(n=En[0],n.blockedOn===null);)ef(n),n.blockedOn===null&&En.shift()}var Dr=xn.ReactCurrentBatchConfig,Gi=!0;function im(e,t,n,r){var s=_e,i=Dr.transition;Dr.transition=null;try{_e=1,Hl(e,t,n,r)}finally{_e=s,Dr.transition=i}}function om(e,t,n,r){var s=_e,i=Dr.transition;Dr.transition=null;try{_e=4,Hl(e,t,n,r)}finally{_e=s,Dr.transition=i}}function Hl(e,t,n,r){if(Gi){var s=Ka(e,t,n,r);if(s===null)ia(e,t,r,qi,n),qc(e,r);else if(rm(s,e,t,n,r))r.stopPropagation();else if(qc(e,r),t&4&&-1<nm.indexOf(e)){for(;s!==null;){var i=ei(s);if(i!==null&&Jd(i),i=Ka(e,t,n,r),i===null&&ia(e,t,r,qi,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ia(e,t,r,null,n)}}var qi=null;function Ka(e,t,n,r){if(qi=null,e=Fl(r),e=Xn(e),e!==null)if(t=ur(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Bd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qi=e,null}function tf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wp()){case Ul:return 1;case qd:return 4;case Vi:case Kp:return 16;case Wd:return 536870912;default:return 16}default:return 16}}var Tn=null,Gl=null,Li=null;function nf(){if(Li)return Li;var e,t=Gl,n=t.length,r,s="value"in Tn?Tn.value:Tn.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Li=s.slice(e,1<r?1-r:void 0)}function Ri(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function hi(){return!0}function Kc(){return!1}function Pt(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hi:Kc,this.isPropagationStopped=Kc,this}return Me(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hi)},persist:function(){},isPersistent:hi}),t}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=Pt(Zr),Zs=Me({},Zr,{view:0,detail:0}),am=Pt(Zs),Jo,Yo,us,mo=Me({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==us&&(us&&e.type==="mousemove"?(Jo=e.screenX-us.screenX,Yo=e.screenY-us.screenY):Yo=Jo=0,us=e),Jo)},movementY:function(e){return"movementY"in e?e.movementY:Yo}}),Qc=Pt(mo),lm=Me({},mo,{dataTransfer:0}),cm=Pt(lm),um=Me({},Zs,{relatedTarget:0}),Xo=Pt(um),dm=Me({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Pt(dm),hm=Me({},Zr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Pt(hm),mm=Me({},Zr,{data:0}),Jc=Pt(mm),gm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ym={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vm[e])?!!t[e]:!1}function Wl(){return xm}var wm=Me({},Zs,{key:function(e){if(e.key){var t=gm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ri(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ym[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wl,charCode:function(e){return e.type==="keypress"?Ri(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ri(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_m=Pt(wm),bm=Me({},mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yc=Pt(bm),km=Me({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wl}),Sm=Pt(km),jm=Me({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nm=Pt(jm),Em=Me({},mo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Cm=Pt(Em),Pm=[9,13,27,32],Kl=pn&&"CompositionEvent"in window,bs=null;pn&&"documentMode"in document&&(bs=document.documentMode);var Tm=pn&&"TextEvent"in window&&!bs,rf=pn&&(!Kl||bs&&8<bs&&11>=bs),Xc=" ",Zc=!1;function sf(e,t){switch(e){case"keyup":return Pm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function of(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sr=!1;function Lm(e,t){switch(e){case"compositionend":return of(t);case"keypress":return t.which!==32?null:(Zc=!0,Xc);case"textInput":return e=t.data,e===Xc&&Zc?null:e;default:return null}}function Rm(e,t){if(Sr)return e==="compositionend"||!Kl&&sf(e,t)?(e=nf(),Li=Gl=Tn=null,Sr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rf&&t.locale!=="ko"?null:t.data;default:return null}}var Am={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Am[e.type]:t==="textarea"}function af(e,t,n,r){Md(r),t=Wi(t,"onChange"),0<t.length&&(n=new ql("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ks=null,Ds=null;function $m(e){vf(e,0)}function go(e){var t=Er(e);if(Td(t))return e}function Om(e,t){if(e==="change")return t}var lf=!1;if(pn){var Zo;if(pn){var ea="oninput"in document;if(!ea){var tu=document.createElement("div");tu.setAttribute("oninput","return;"),ea=typeof tu.oninput=="function"}Zo=ea}else Zo=!1;lf=Zo&&(!document.documentMode||9<document.documentMode)}function nu(){ks&&(ks.detachEvent("onpropertychange",cf),Ds=ks=null)}function cf(e){if(e.propertyName==="value"&&go(Ds)){var t=[];af(t,Ds,e,Fl(e)),Ud($m,t)}}function zm(e,t,n){e==="focusin"?(nu(),ks=t,Ds=n,ks.attachEvent("onpropertychange",cf)):e==="focusout"&&nu()}function Mm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return go(Ds)}function Dm(e,t){if(e==="click")return go(t)}function Im(e,t){if(e==="input"||e==="change")return go(t)}function Fm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Jt=typeof Object.is=="function"?Object.is:Fm;function Is(e,t){if(Jt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ta.call(t,s)||!Jt(e[s],t[s]))return!1}return!0}function ru(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function su(e,t){var n=ru(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ru(n)}}function uf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?uf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function df(){for(var e=window,t=Fi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Fi(e.document)}return t}function Ql(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Um(e){var t=df(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&uf(n.ownerDocument.documentElement,n)){if(r!==null&&Ql(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=su(n,i);var o=su(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bm=pn&&"documentMode"in document&&11>=document.documentMode,jr=null,Qa=null,Ss=null,Ja=!1;function iu(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ja||jr==null||jr!==Fi(r)||(r=jr,"selectionStart"in r&&Ql(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ss&&Is(Ss,r)||(Ss=r,r=Wi(Qa,"onSelect"),0<r.length&&(t=new ql("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=jr)))}function pi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:pi("Animation","AnimationEnd"),animationiteration:pi("Animation","AnimationIteration"),animationstart:pi("Animation","AnimationStart"),transitionend:pi("Transition","TransitionEnd")},ta={},ff={};pn&&(ff=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);function yo(e){if(ta[e])return ta[e];if(!Nr[e])return e;var t=Nr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ff)return ta[e]=t[n];return e}var hf=yo("animationend"),pf=yo("animationiteration"),mf=yo("animationstart"),gf=yo("transitionend"),yf=new Map,ou="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(e,t){yf.set(e,t),cr(t,[e])}for(var na=0;na<ou.length;na++){var ra=ou[na],Vm=ra.toLowerCase(),Hm=ra[0].toUpperCase()+ra.slice(1);Bn(Vm,"on"+Hm)}Bn(hf,"onAnimationEnd");Bn(pf,"onAnimationIteration");Bn(mf,"onAnimationStart");Bn("dblclick","onDoubleClick");Bn("focusin","onFocus");Bn("focusout","onBlur");Bn(gf,"onTransitionEnd");Br("onMouseEnter",["mouseout","mouseover"]);Br("onMouseLeave",["mouseout","mouseover"]);Br("onPointerEnter",["pointerout","pointerover"]);Br("onPointerLeave",["pointerout","pointerover"]);cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cr("onBeforeInput",["compositionend","keypress","textInput","paste"]);cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gm=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function au(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Vp(r,t,void 0,e),e.currentTarget=null}function vf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;au(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;au(s,l,u),i=c}}}if(Bi)throw e=Ga,Bi=!1,Ga=null,e}function Ee(e,t){var n=t[tl];n===void 0&&(n=t[tl]=new Set);var r=e+"__bubble";n.has(r)||(xf(t,e,2,!1),n.add(r))}function sa(e,t,n){var r=0;t&&(r|=4),xf(n,e,r,t)}var mi="_reactListening"+Math.random().toString(36).slice(2);function Fs(e){if(!e[mi]){e[mi]=!0,jd.forEach(function(n){n!=="selectionchange"&&(Gm.has(n)||sa(n,!1,e),sa(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mi]||(t[mi]=!0,sa("selectionchange",!1,t))}}function xf(e,t,n,r){switch(tf(t)){case 1:var s=im;break;case 4:s=om;break;default:s=Hl}n=s.bind(null,t,n,e),s=void 0,!Ha||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function ia(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Xn(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Ud(function(){var u=i,d=Fl(n),h=[];e:{var m=yf.get(e);if(m!==void 0){var v=ql,x=e;switch(e){case"keypress":if(Ri(n)===0)break e;case"keydown":case"keyup":v=_m;break;case"focusin":x="focus",v=Xo;break;case"focusout":x="blur",v=Xo;break;case"beforeblur":case"afterblur":v=Xo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=cm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Sm;break;case hf:case pf:case mf:v=fm;break;case gf:v=Nm;break;case"scroll":v=am;break;case"wheel":v=Cm;break;case"copy":case"cut":case"paste":v=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Yc}var b=(t&4)!==0,k=!b&&e==="scroll",g=b?m!==null?m+"Capture":null:m;b=[];for(var f=u,y;f!==null;){y=f;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,g!==null&&(_=$s(f,g),_!=null&&b.push(Us(f,_,y)))),k)break;f=f.return}0<b.length&&(m=new v(m,x,null,n,d),h.push({event:m,listeners:b}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",m&&n!==Ba&&(x=n.relatedTarget||n.fromElement)&&(Xn(x)||x[mn]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(x=n.relatedTarget||n.toElement,v=u,x=x?Xn(x):null,x!==null&&(k=ur(x),x!==k||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=u),v!==x)){if(b=Qc,_="onMouseLeave",g="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(b=Yc,_="onPointerLeave",g="onPointerEnter",f="pointer"),k=v==null?m:Er(v),y=x==null?m:Er(x),m=new b(_,f+"leave",v,n,d),m.target=k,m.relatedTarget=y,_=null,Xn(d)===u&&(b=new b(g,f+"enter",x,n,d),b.target=y,b.relatedTarget=k,_=b),k=_,v&&x)t:{for(b=v,g=x,f=0,y=b;y;y=gr(y))f++;for(y=0,_=g;_;_=gr(_))y++;for(;0<f-y;)b=gr(b),f--;for(;0<y-f;)g=gr(g),y--;for(;f--;){if(b===g||g!==null&&b===g.alternate)break t;b=gr(b),g=gr(g)}b=null}else b=null;v!==null&&lu(h,m,v,b,!1),x!==null&&k!==null&&lu(h,k,x,b,!0)}}e:{if(m=u?Er(u):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var S=Om;else if(eu(m))if(lf)S=Im;else{S=Mm;var N=zm}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=Dm);if(S&&(S=S(e,u))){af(h,S,n,d);break e}N&&N(e,m,u),e==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&Ma(m,"number",m.value)}switch(N=u?Er(u):window,e){case"focusin":(eu(N)||N.contentEditable==="true")&&(jr=N,Qa=u,Ss=null);break;case"focusout":Ss=Qa=jr=null;break;case"mousedown":Ja=!0;break;case"contextmenu":case"mouseup":case"dragend":Ja=!1,iu(h,n,d);break;case"selectionchange":if(Bm)break;case"keydown":case"keyup":iu(h,n,d)}var P;if(Kl)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Sr?sf(e,n)&&(A="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(rf&&n.locale!=="ko"&&(Sr||A!=="onCompositionStart"?A==="onCompositionEnd"&&Sr&&(P=nf()):(Tn=d,Gl="value"in Tn?Tn.value:Tn.textContent,Sr=!0)),N=Wi(u,A),0<N.length&&(A=new Jc(A,e,null,n,d),h.push({event:A,listeners:N}),P?A.data=P:(P=of(n),P!==null&&(A.data=P)))),(P=Tm?Lm(e,n):Rm(e,n))&&(u=Wi(u,"onBeforeInput"),0<u.length&&(d=new Jc("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=P))}vf(h,t)})}function Us(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wi(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=$s(e,n),i!=null&&r.unshift(Us(e,i,s)),i=$s(e,t),i!=null&&r.push(Us(e,i,s))),e=e.return}return r}function gr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function lu(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=$s(n,i),c!=null&&o.unshift(Us(n,c,l))):s||(c=$s(n,i),c!=null&&o.push(Us(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var qm=/\r\n?/g,Wm=/\u0000|\uFFFD/g;function cu(e){return(typeof e=="string"?e:""+e).replace(qm,`
`).replace(Wm,"")}function gi(e,t,n){if(t=cu(t),cu(e)!==t&&n)throw Error(R(425))}function Ki(){}var Ya=null,Xa=null;function Za(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var el=typeof setTimeout=="function"?setTimeout:void 0,Km=typeof clearTimeout=="function"?clearTimeout:void 0,uu=typeof Promise=="function"?Promise:void 0,Qm=typeof queueMicrotask=="function"?queueMicrotask:typeof uu<"u"?function(e){return uu.resolve(null).then(e).catch(Jm)}:el;function Jm(e){setTimeout(function(){throw e})}function oa(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ms(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ms(t)}function On(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function du(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var es=Math.random().toString(36).slice(2),nn="__reactFiber$"+es,Bs="__reactProps$"+es,mn="__reactContainer$"+es,tl="__reactEvents$"+es,Ym="__reactListeners$"+es,Xm="__reactHandles$"+es;function Xn(e){var t=e[nn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mn]||n[nn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=du(e);e!==null;){if(n=e[nn])return n;e=du(e)}return t}e=n,n=e.parentNode}return null}function ei(e){return e=e[nn]||e[mn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Er(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(R(33))}function vo(e){return e[Bs]||null}var nl=[],Cr=-1;function Vn(e){return{current:e}}function Ce(e){0>Cr||(e.current=nl[Cr],nl[Cr]=null,Cr--)}function Se(e,t){Cr++,nl[Cr]=e.current,e.current=t}var Un={},ot=Vn(Un),yt=Vn(!1),rr=Un;function Vr(e,t){var n=e.type.contextTypes;if(!n)return Un;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function vt(e){return e=e.childContextTypes,e!=null}function Qi(){Ce(yt),Ce(ot)}function fu(e,t,n){if(ot.current!==Un)throw Error(R(168));Se(ot,t),Se(yt,n)}function wf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(R(108,zp(e)||"Unknown",s));return Me({},n,r)}function Ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Un,rr=ot.current,Se(ot,e),Se(yt,yt.current),!0}function hu(e,t,n){var r=e.stateNode;if(!r)throw Error(R(169));n?(e=wf(e,t,rr),r.__reactInternalMemoizedMergedChildContext=e,Ce(yt),Ce(ot),Se(ot,e)):Ce(yt),Se(yt,n)}var un=null,xo=!1,aa=!1;function _f(e){un===null?un=[e]:un.push(e)}function Zm(e){xo=!0,_f(e)}function Hn(){if(!aa&&un!==null){aa=!0;var e=0,t=_e;try{var n=un;for(_e=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}un=null,xo=!1}catch(s){throw un!==null&&(un=un.slice(e+1)),Gd(Ul,Hn),s}finally{_e=t,aa=!1}}return null}var Pr=[],Tr=0,Yi=null,Xi=0,At=[],$t=0,sr=null,dn=1,fn="";function Kn(e,t){Pr[Tr++]=Xi,Pr[Tr++]=Yi,Yi=e,Xi=t}function bf(e,t,n){At[$t++]=dn,At[$t++]=fn,At[$t++]=sr,sr=e;var r=dn;e=fn;var s=32-Kt(r)-1;r&=~(1<<s),n+=1;var i=32-Kt(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,dn=1<<32-Kt(t)+s|n<<s|r,fn=i+e}else dn=1<<i|n<<s|r,fn=e}function Jl(e){e.return!==null&&(Kn(e,1),bf(e,1,0))}function Yl(e){for(;e===Yi;)Yi=Pr[--Tr],Pr[Tr]=null,Xi=Pr[--Tr],Pr[Tr]=null;for(;e===sr;)sr=At[--$t],At[$t]=null,fn=At[--$t],At[$t]=null,dn=At[--$t],At[$t]=null}var Nt=null,jt=null,Ae=!1,Wt=null;function kf(e,t){var n=Ot(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function pu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nt=e,jt=On(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nt=e,jt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=sr!==null?{id:dn,overflow:fn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ot(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Nt=e,jt=null,!0):!1;default:return!1}}function rl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sl(e){if(Ae){var t=jt;if(t){var n=t;if(!pu(e,t)){if(rl(e))throw Error(R(418));t=On(n.nextSibling);var r=Nt;t&&pu(e,t)?kf(r,n):(e.flags=e.flags&-4097|2,Ae=!1,Nt=e)}}else{if(rl(e))throw Error(R(418));e.flags=e.flags&-4097|2,Ae=!1,Nt=e}}}function mu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nt=e}function yi(e){if(e!==Nt)return!1;if(!Ae)return mu(e),Ae=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Za(e.type,e.memoizedProps)),t&&(t=jt)){if(rl(e))throw Sf(),Error(R(418));for(;t;)kf(e,t),t=On(t.nextSibling)}if(mu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(R(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){jt=On(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}jt=null}}else jt=Nt?On(e.stateNode.nextSibling):null;return!0}function Sf(){for(var e=jt;e;)e=On(e.nextSibling)}function Hr(){jt=Nt=null,Ae=!1}function Xl(e){Wt===null?Wt=[e]:Wt.push(e)}var eg=xn.ReactCurrentBatchConfig;function ds(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(R(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gu(e){var t=e._init;return t(e._payload)}function jf(e){function t(g,f){if(e){var y=g.deletions;y===null?(g.deletions=[f],g.flags|=16):y.push(f)}}function n(g,f){if(!e)return null;for(;f!==null;)t(g,f),f=f.sibling;return null}function r(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function s(g,f){return g=In(g,f),g.index=0,g.sibling=null,g}function i(g,f,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<f?(g.flags|=2,f):y):(g.flags|=2,f)):(g.flags|=1048576,f)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,f,y,_){return f===null||f.tag!==6?(f=pa(y,g.mode,_),f.return=g,f):(f=s(f,y),f.return=g,f)}function c(g,f,y,_){var S=y.type;return S===kr?d(g,f,y.props.children,_,y.key):f!==null&&(f.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Sn&&gu(S)===f.type)?(_=s(f,y.props),_.ref=ds(g,f,y),_.return=g,_):(_=Ii(y.type,y.key,y.props,null,g.mode,_),_.ref=ds(g,f,y),_.return=g,_)}function u(g,f,y,_){return f===null||f.tag!==4||f.stateNode.containerInfo!==y.containerInfo||f.stateNode.implementation!==y.implementation?(f=ma(y,g.mode,_),f.return=g,f):(f=s(f,y.children||[]),f.return=g,f)}function d(g,f,y,_,S){return f===null||f.tag!==7?(f=nr(y,g.mode,_,S),f.return=g,f):(f=s(f,y),f.return=g,f)}function h(g,f,y){if(typeof f=="string"&&f!==""||typeof f=="number")return f=pa(""+f,g.mode,y),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case ai:return y=Ii(f.type,f.key,f.props,null,g.mode,y),y.ref=ds(g,null,f),y.return=g,y;case br:return f=ma(f,g.mode,y),f.return=g,f;case Sn:var _=f._init;return h(g,_(f._payload),y)}if(gs(f)||os(f))return f=nr(f,g.mode,y,null),f.return=g,f;vi(g,f)}return null}function m(g,f,y,_){var S=f!==null?f.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(g,f,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ai:return y.key===S?c(g,f,y,_):null;case br:return y.key===S?u(g,f,y,_):null;case Sn:return S=y._init,m(g,f,S(y._payload),_)}if(gs(y)||os(y))return S!==null?null:d(g,f,y,_,null);vi(g,y)}return null}function v(g,f,y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(y)||null,l(f,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ai:return g=g.get(_.key===null?y:_.key)||null,c(f,g,_,S);case br:return g=g.get(_.key===null?y:_.key)||null,u(f,g,_,S);case Sn:var N=_._init;return v(g,f,y,N(_._payload),S)}if(gs(_)||os(_))return g=g.get(y)||null,d(f,g,_,S,null);vi(f,_)}return null}function x(g,f,y,_){for(var S=null,N=null,P=f,A=f=0,$=null;P!==null&&A<y.length;A++){P.index>A?($=P,P=null):$=P.sibling;var O=m(g,P,y[A],_);if(O===null){P===null&&(P=$);break}e&&P&&O.alternate===null&&t(g,P),f=i(O,f,A),N===null?S=O:N.sibling=O,N=O,P=$}if(A===y.length)return n(g,P),Ae&&Kn(g,A),S;if(P===null){for(;A<y.length;A++)P=h(g,y[A],_),P!==null&&(f=i(P,f,A),N===null?S=P:N.sibling=P,N=P);return Ae&&Kn(g,A),S}for(P=r(g,P);A<y.length;A++)$=v(P,g,A,y[A],_),$!==null&&(e&&$.alternate!==null&&P.delete($.key===null?A:$.key),f=i($,f,A),N===null?S=$:N.sibling=$,N=$);return e&&P.forEach(function(j){return t(g,j)}),Ae&&Kn(g,A),S}function b(g,f,y,_){var S=os(y);if(typeof S!="function")throw Error(R(150));if(y=S.call(y),y==null)throw Error(R(151));for(var N=S=null,P=f,A=f=0,$=null,O=y.next();P!==null&&!O.done;A++,O=y.next()){P.index>A?($=P,P=null):$=P.sibling;var j=m(g,P,O.value,_);if(j===null){P===null&&(P=$);break}e&&P&&j.alternate===null&&t(g,P),f=i(j,f,A),N===null?S=j:N.sibling=j,N=j,P=$}if(O.done)return n(g,P),Ae&&Kn(g,A),S;if(P===null){for(;!O.done;A++,O=y.next())O=h(g,O.value,_),O!==null&&(f=i(O,f,A),N===null?S=O:N.sibling=O,N=O);return Ae&&Kn(g,A),S}for(P=r(g,P);!O.done;A++,O=y.next())O=v(P,g,A,O.value,_),O!==null&&(e&&O.alternate!==null&&P.delete(O.key===null?A:O.key),f=i(O,f,A),N===null?S=O:N.sibling=O,N=O);return e&&P.forEach(function(B){return t(g,B)}),Ae&&Kn(g,A),S}function k(g,f,y,_){if(typeof y=="object"&&y!==null&&y.type===kr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ai:e:{for(var S=y.key,N=f;N!==null;){if(N.key===S){if(S=y.type,S===kr){if(N.tag===7){n(g,N.sibling),f=s(N,y.props.children),f.return=g,g=f;break e}}else if(N.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Sn&&gu(S)===N.type){n(g,N.sibling),f=s(N,y.props),f.ref=ds(g,N,y),f.return=g,g=f;break e}n(g,N);break}else t(g,N);N=N.sibling}y.type===kr?(f=nr(y.props.children,g.mode,_,y.key),f.return=g,g=f):(_=Ii(y.type,y.key,y.props,null,g.mode,_),_.ref=ds(g,f,y),_.return=g,g=_)}return o(g);case br:e:{for(N=y.key;f!==null;){if(f.key===N)if(f.tag===4&&f.stateNode.containerInfo===y.containerInfo&&f.stateNode.implementation===y.implementation){n(g,f.sibling),f=s(f,y.children||[]),f.return=g,g=f;break e}else{n(g,f);break}else t(g,f);f=f.sibling}f=ma(y,g.mode,_),f.return=g,g=f}return o(g);case Sn:return N=y._init,k(g,f,N(y._payload),_)}if(gs(y))return x(g,f,y,_);if(os(y))return b(g,f,y,_);vi(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,f!==null&&f.tag===6?(n(g,f.sibling),f=s(f,y),f.return=g,g=f):(n(g,f),f=pa(y,g.mode,_),f.return=g,g=f),o(g)):n(g,f)}return k}var Gr=jf(!0),Nf=jf(!1),Zi=Vn(null),eo=null,Lr=null,Zl=null;function ec(){Zl=Lr=eo=null}function tc(e){var t=Zi.current;Ce(Zi),e._currentValue=t}function il(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ir(e,t){eo=e,Zl=Lr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gt=!0),e.firstContext=null)}function Dt(e){var t=e._currentValue;if(Zl!==e)if(e={context:e,memoizedValue:t,next:null},Lr===null){if(eo===null)throw Error(R(308));Lr=e,eo.dependencies={lanes:0,firstContext:e}}else Lr=Lr.next=e;return t}var Zn=null;function nc(e){Zn===null?Zn=[e]:Zn.push(e)}function Ef(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,nc(t)):(n.next=s.next,s.next=n),t.interleaved=n,gn(e,r)}function gn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var jn=!1;function rc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ge&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,gn(e,n)}return s=r.interleaved,s===null?(t.next=t,nc(r)):(t.next=s.next,s.next=t),r.interleaved=t,gn(e,n)}function Ai(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bl(e,n)}}function yu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function to(e,t,n,r){var s=e.updateQueue;jn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var m=l.lane,v=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(m=t,v=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){h=x.call(v,h,m);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,m=typeof x=="function"?x.call(v,h,m):x,m==null)break e;h=Me({},h,m);break e;case 2:jn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else v={eventTime:v,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=v,c=h):d=d.next=v,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);or|=o,e.lanes=o,e.memoizedState=h}}function vu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(R(191,s));s.call(r)}}}var ti={},sn=Vn(ti),Vs=Vn(ti),Hs=Vn(ti);function er(e){if(e===ti)throw Error(R(174));return e}function sc(e,t){switch(Se(Hs,t),Se(Vs,e),Se(sn,ti),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ia(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ia(t,e)}Ce(sn),Se(sn,t)}function qr(){Ce(sn),Ce(Vs),Ce(Hs)}function Pf(e){er(Hs.current);var t=er(sn.current),n=Ia(t,e.type);t!==n&&(Se(Vs,e),Se(sn,n))}function ic(e){Vs.current===e&&(Ce(sn),Ce(Vs))}var Oe=Vn(0);function no(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var la=[];function oc(){for(var e=0;e<la.length;e++)la[e]._workInProgressVersionPrimary=null;la.length=0}var $i=xn.ReactCurrentDispatcher,ca=xn.ReactCurrentBatchConfig,ir=0,ze=null,We=null,Je=null,ro=!1,js=!1,Gs=0,tg=0;function rt(){throw Error(R(321))}function ac(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Jt(e[n],t[n]))return!1;return!0}function lc(e,t,n,r,s,i){if(ir=i,ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$i.current=e===null||e.memoizedState===null?ig:og,e=n(r,s),js){i=0;do{if(js=!1,Gs=0,25<=i)throw Error(R(301));i+=1,Je=We=null,t.updateQueue=null,$i.current=ag,e=n(r,s)}while(js)}if($i.current=so,t=We!==null&&We.next!==null,ir=0,Je=We=ze=null,ro=!1,t)throw Error(R(300));return e}function cc(){var e=Gs!==0;return Gs=0,e}function tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?ze.memoizedState=Je=e:Je=Je.next=e,Je}function It(){if(We===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=We.next;var t=Je===null?ze.memoizedState:Je.next;if(t!==null)Je=t,We=e;else{if(e===null)throw Error(R(310));We=e,e={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Je===null?ze.memoizedState=Je=e:Je=Je.next=e}return Je}function qs(e,t){return typeof t=="function"?t(e):t}function ua(e){var t=It(),n=t.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=e;var r=We,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((ir&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,ze.lanes|=d,or|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,Jt(r,t.memoizedState)||(gt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,ze.lanes|=i,or|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function da(e){var t=It(),n=t.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Jt(i,t.memoizedState)||(gt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Tf(){}function Lf(e,t){var n=ze,r=It(),s=t(),i=!Jt(r.memoizedState,s);if(i&&(r.memoizedState=s,gt=!0),r=r.queue,uc($f.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Je!==null&&Je.memoizedState.tag&1){if(n.flags|=2048,Ws(9,Af.bind(null,n,r,s,t),void 0,null),Ye===null)throw Error(R(349));ir&30||Rf(n,t,s)}return s}function Rf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Af(e,t,n,r){t.value=n,t.getSnapshot=r,Of(t)&&zf(e)}function $f(e,t,n){return n(function(){Of(t)&&zf(e)})}function Of(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Jt(e,n)}catch{return!0}}function zf(e){var t=gn(e,1);t!==null&&Qt(t,e,1,-1)}function xu(e){var t=tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:e},t.queue=e,e=e.dispatch=sg.bind(null,ze,e),[t.memoizedState,e]}function Ws(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Mf(){return It().memoizedState}function Oi(e,t,n,r){var s=tn();ze.flags|=e,s.memoizedState=Ws(1|t,n,void 0,r===void 0?null:r)}function wo(e,t,n,r){var s=It();r=r===void 0?null:r;var i=void 0;if(We!==null){var o=We.memoizedState;if(i=o.destroy,r!==null&&ac(r,o.deps)){s.memoizedState=Ws(t,n,i,r);return}}ze.flags|=e,s.memoizedState=Ws(1|t,n,i,r)}function wu(e,t){return Oi(8390656,8,e,t)}function uc(e,t){return wo(2048,8,e,t)}function Df(e,t){return wo(4,2,e,t)}function If(e,t){return wo(4,4,e,t)}function Ff(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Uf(e,t,n){return n=n!=null?n.concat([e]):null,wo(4,4,Ff.bind(null,t,e),n)}function dc(){}function Bf(e,t){var n=It();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ac(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vf(e,t){var n=It();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ac(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hf(e,t,n){return ir&21?(Jt(n,t)||(n=Kd(),ze.lanes|=n,or|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gt=!0),e.memoizedState=n)}function ng(e,t){var n=_e;_e=n!==0&&4>n?n:4,e(!0);var r=ca.transition;ca.transition={};try{e(!1),t()}finally{_e=n,ca.transition=r}}function Gf(){return It().memoizedState}function rg(e,t,n){var r=Dn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qf(e))Wf(t,n);else if(n=Ef(e,t,n,r),n!==null){var s=ct();Qt(n,e,r,s),Kf(n,t,r)}}function sg(e,t,n){var r=Dn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qf(e))Wf(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Jt(l,o)){var c=t.interleaved;c===null?(s.next=s,nc(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Ef(e,t,s,r),n!==null&&(s=ct(),Qt(n,e,r,s),Kf(n,t,r))}}function qf(e){var t=e.alternate;return e===ze||t!==null&&t===ze}function Wf(e,t){js=ro=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Kf(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Bl(e,n)}}var so={readContext:Dt,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useInsertionEffect:rt,useLayoutEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useMutableSource:rt,useSyncExternalStore:rt,useId:rt,unstable_isNewReconciler:!1},ig={readContext:Dt,useCallback:function(e,t){return tn().memoizedState=[e,t===void 0?null:t],e},useContext:Dt,useEffect:wu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Oi(4194308,4,Ff.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oi(4,2,e,t)},useMemo:function(e,t){var n=tn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=tn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=rg.bind(null,ze,e),[r.memoizedState,e]},useRef:function(e){var t=tn();return e={current:e},t.memoizedState=e},useState:xu,useDebugValue:dc,useDeferredValue:function(e){return tn().memoizedState=e},useTransition:function(){var e=xu(!1),t=e[0];return e=ng.bind(null,e[1]),tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ze,s=tn();if(Ae){if(n===void 0)throw Error(R(407));n=n()}else{if(n=t(),Ye===null)throw Error(R(349));ir&30||Rf(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,wu($f.bind(null,r,i,e),[e]),r.flags|=2048,Ws(9,Af.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=tn(),t=Ye.identifierPrefix;if(Ae){var n=fn,r=dn;n=(r&~(1<<32-Kt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Gs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=tg++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},og={readContext:Dt,useCallback:Bf,useContext:Dt,useEffect:uc,useImperativeHandle:Uf,useInsertionEffect:Df,useLayoutEffect:If,useMemo:Vf,useReducer:ua,useRef:Mf,useState:function(){return ua(qs)},useDebugValue:dc,useDeferredValue:function(e){var t=It();return Hf(t,We.memoizedState,e)},useTransition:function(){var e=ua(qs)[0],t=It().memoizedState;return[e,t]},useMutableSource:Tf,useSyncExternalStore:Lf,useId:Gf,unstable_isNewReconciler:!1},ag={readContext:Dt,useCallback:Bf,useContext:Dt,useEffect:uc,useImperativeHandle:Uf,useInsertionEffect:Df,useLayoutEffect:If,useMemo:Vf,useReducer:da,useRef:Mf,useState:function(){return da(qs)},useDebugValue:dc,useDeferredValue:function(e){var t=It();return We===null?t.memoizedState=e:Hf(t,We.memoizedState,e)},useTransition:function(){var e=da(qs)[0],t=It().memoizedState;return[e,t]},useMutableSource:Tf,useSyncExternalStore:Lf,useId:Gf,unstable_isNewReconciler:!1};function Ht(e,t){if(e&&e.defaultProps){t=Me({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ol(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Me({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var _o={isMounted:function(e){return(e=e._reactInternals)?ur(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ct(),s=Dn(e),i=hn(r,s);i.payload=t,n!=null&&(i.callback=n),t=zn(e,i,s),t!==null&&(Qt(t,e,s,r),Ai(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ct(),s=Dn(e),i=hn(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=zn(e,i,s),t!==null&&(Qt(t,e,s,r),Ai(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ct(),r=Dn(e),s=hn(n,r);s.tag=2,t!=null&&(s.callback=t),t=zn(e,s,r),t!==null&&(Qt(t,e,r,n),Ai(t,e,r))}};function _u(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Is(n,r)||!Is(s,i):!0}function Qf(e,t,n){var r=!1,s=Un,i=t.contextType;return typeof i=="object"&&i!==null?i=Dt(i):(s=vt(t)?rr:ot.current,r=t.contextTypes,i=(r=r!=null)?Vr(e,s):Un),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_o,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function bu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&_o.enqueueReplaceState(t,t.state,null)}function al(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},rc(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Dt(i):(i=vt(t)?rr:ot.current,s.context=Vr(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ol(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&_o.enqueueReplaceState(s,s.state,null),to(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Wr(e,t){try{var n="",r=t;do n+=Op(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function fa(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ll(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var lg=typeof WeakMap=="function"?WeakMap:Map;function Jf(e,t,n){n=hn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){oo||(oo=!0,vl=r),ll(e,t)},n}function Yf(e,t,n){n=hn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){ll(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ll(e,t),typeof r!="function"&&(Mn===null?Mn=new Set([this]):Mn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function ku(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new lg;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=bg.bind(null,e,t,n),t.then(e,e))}function Su(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ju(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=hn(-1,1),t.tag=2,zn(n,t,1))),n.lanes|=1),e)}var cg=xn.ReactCurrentOwner,gt=!1;function lt(e,t,n,r){t.child=e===null?Nf(t,null,n,r):Gr(t,e.child,n,r)}function Nu(e,t,n,r,s){n=n.render;var i=t.ref;return Ir(t,s),r=lc(e,t,n,r,i,s),n=cc(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yn(e,t,s)):(Ae&&n&&Jl(t),t.flags|=1,lt(e,t,r,s),t.child)}function Eu(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!xc(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Xf(e,t,i,r,s)):(e=Ii(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Is,n(o,r)&&e.ref===t.ref)return yn(e,t,s)}return t.flags|=1,e=In(i,r),e.ref=t.ref,e.return=t,t.child=e}function Xf(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Is(i,r)&&e.ref===t.ref)if(gt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(gt=!0);else return t.lanes=e.lanes,yn(e,t,s)}return cl(e,t,n,r,s)}function Zf(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Ar,St),St|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Se(Ar,St),St|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Se(Ar,St),St|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Se(Ar,St),St|=r;return lt(e,t,s,n),t.child}function eh(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function cl(e,t,n,r,s){var i=vt(n)?rr:ot.current;return i=Vr(t,i),Ir(t,s),n=lc(e,t,n,r,i,s),r=cc(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yn(e,t,s)):(Ae&&r&&Jl(t),t.flags|=1,lt(e,t,n,s),t.child)}function Cu(e,t,n,r,s){if(vt(n)){var i=!0;Ji(t)}else i=!1;if(Ir(t,s),t.stateNode===null)zi(e,t),Qf(t,n,r),al(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Dt(u):(u=vt(n)?rr:ot.current,u=Vr(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&bu(t,o,r,u),jn=!1;var m=t.memoizedState;o.state=m,to(t,r,o,s),c=t.memoizedState,l!==r||m!==c||yt.current||jn?(typeof d=="function"&&(ol(t,n,d,r),c=t.memoizedState),(l=jn||_u(t,n,l,r,m,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Cf(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Ht(t.type,l),o.props=u,h=t.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Dt(c):(c=vt(n)?rr:ot.current,c=Vr(t,c));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||m!==c)&&bu(t,o,r,c),jn=!1,m=t.memoizedState,o.state=m,to(t,r,o,s);var x=t.memoizedState;l!==h||m!==x||yt.current||jn?(typeof v=="function"&&(ol(t,n,v,r),x=t.memoizedState),(u=jn||_u(t,n,u,r,m,x,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return ul(e,t,n,r,i,s)}function ul(e,t,n,r,s,i){eh(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&hu(t,n,!1),yn(e,t,i);r=t.stateNode,cg.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Gr(t,e.child,null,i),t.child=Gr(t,null,l,i)):lt(e,t,l,i),t.memoizedState=r.state,s&&hu(t,n,!0),t.child}function th(e){var t=e.stateNode;t.pendingContext?fu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&fu(e,t.context,!1),sc(e,t.containerInfo)}function Pu(e,t,n,r,s){return Hr(),Xl(s),t.flags|=256,lt(e,t,n,r),t.child}var dl={dehydrated:null,treeContext:null,retryLane:0};function fl(e){return{baseLanes:e,cachePool:null,transitions:null}}function nh(e,t,n){var r=t.pendingProps,s=Oe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Se(Oe,s&1),e===null)return sl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=So(o,r,0,null),e=nr(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=fl(n),t.memoizedState=dl,e):fc(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ug(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=In(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=In(l,i):(i=nr(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?fl(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=dl,r}return i=e.child,e=i.sibling,r=In(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function fc(e,t){return t=So({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xi(e,t,n,r){return r!==null&&Xl(r),Gr(t,e.child,null,n),e=fc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ug(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=fa(Error(R(422))),xi(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=So({mode:"visible",children:r.children},s,0,null),i=nr(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Gr(t,e.child,null,o),t.child.memoizedState=fl(o),t.memoizedState=dl,i);if(!(t.mode&1))return xi(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(R(419)),r=fa(i,r,void 0),xi(e,t,o,r)}if(l=(o&e.childLanes)!==0,gt||l){if(r=Ye,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,gn(e,s),Qt(r,e,s,-1))}return vc(),r=fa(Error(R(421))),xi(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kg.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,jt=On(s.nextSibling),Nt=t,Ae=!0,Wt=null,e!==null&&(At[$t++]=dn,At[$t++]=fn,At[$t++]=sr,dn=e.id,fn=e.overflow,sr=t),t=fc(t,r.children),t.flags|=4096,t)}function Tu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),il(e.return,t,n)}function ha(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function rh(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(lt(e,t,r.children,n),r=Oe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tu(e,n,t);else if(e.tag===19)Tu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Se(Oe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&no(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ha(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&no(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ha(t,!0,n,null,i);break;case"together":ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function yn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),or|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(R(153));if(t.child!==null){for(e=t.child,n=In(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=In(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function dg(e,t,n){switch(t.tag){case 3:th(t),Hr();break;case 5:Pf(t);break;case 1:vt(t.type)&&Ji(t);break;case 4:sc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Se(Zi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Se(Oe,Oe.current&1),t.flags|=128,null):n&t.child.childLanes?nh(e,t,n):(Se(Oe,Oe.current&1),e=yn(e,t,n),e!==null?e.sibling:null);Se(Oe,Oe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return rh(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(Oe,Oe.current),r)break;return null;case 22:case 23:return t.lanes=0,Zf(e,t,n)}return yn(e,t,n)}var sh,hl,ih,oh;sh=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hl=function(){};ih=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,er(sn.current);var i=null;switch(n){case"input":s=Oa(e,s),r=Oa(e,r),i=[];break;case"select":s=Me({},s,{value:void 0}),r=Me({},r,{value:void 0}),i=[];break;case"textarea":s=Da(e,s),r=Da(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ki)}Fa(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Rs.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Rs.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};oh=function(e,t,n,r){n!==r&&(t.flags|=4)};function fs(e,t){if(!Ae)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function st(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fg(e,t,n){var r=t.pendingProps;switch(Yl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(t),null;case 1:return vt(t.type)&&Qi(),st(t),null;case 3:return r=t.stateNode,qr(),Ce(yt),Ce(ot),oc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(yi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wt!==null&&(_l(Wt),Wt=null))),hl(e,t),st(t),null;case 5:ic(t);var s=er(Hs.current);if(n=t.type,e!==null&&t.stateNode!=null)ih(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(R(166));return st(t),null}if(e=er(sn.current),yi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[nn]=t,r[Bs]=i,e=(t.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(s=0;s<vs.length;s++)Ee(vs[s],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":Ic(r,i),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",r);break;case"textarea":Uc(r,i),Ee("invalid",r)}Fa(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&gi(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&gi(r.textContent,l,e),s=["children",""+l]):Rs.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":li(r),Fc(r,i,!0);break;case"textarea":li(r),Bc(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ki)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ad(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[nn]=t,e[Bs]=r,sh(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ua(n,r),n){case"dialog":Ee("cancel",e),Ee("close",e),s=r;break;case"iframe":case"object":case"embed":Ee("load",e),s=r;break;case"video":case"audio":for(s=0;s<vs.length;s++)Ee(vs[s],e);s=r;break;case"source":Ee("error",e),s=r;break;case"img":case"image":case"link":Ee("error",e),Ee("load",e),s=r;break;case"details":Ee("toggle",e),s=r;break;case"input":Ic(e,r),s=Oa(e,r),Ee("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Me({},r,{value:void 0}),Ee("invalid",e);break;case"textarea":Uc(e,r),s=Da(e,r),Ee("invalid",e);break;default:s=r}Fa(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?zd(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$d(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&As(e,c):typeof c=="number"&&As(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Rs.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",e):c!=null&&zl(e,i,c,o))}switch(n){case"input":li(e),Fc(e,r,!1);break;case"textarea":li(e),Bc(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Fn(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Or(e,!!r.multiple,i,!1):r.defaultValue!=null&&Or(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ki)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return st(t),null;case 6:if(e&&t.stateNode!=null)oh(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(R(166));if(n=er(Hs.current),er(sn.current),yi(t)){if(r=t.stateNode,n=t.memoizedProps,r[nn]=t,(i=r.nodeValue!==n)&&(e=Nt,e!==null))switch(e.tag){case 3:gi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&gi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nn]=t,t.stateNode=r}return st(t),null;case 13:if(Ce(Oe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ae&&jt!==null&&t.mode&1&&!(t.flags&128))Sf(),Hr(),t.flags|=98560,i=!1;else if(i=yi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(R(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));i[nn]=t}else Hr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;st(t),i=!1}else Wt!==null&&(_l(Wt),Wt=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Oe.current&1?Ke===0&&(Ke=3):vc())),t.updateQueue!==null&&(t.flags|=4),st(t),null);case 4:return qr(),hl(e,t),e===null&&Fs(t.stateNode.containerInfo),st(t),null;case 10:return tc(t.type._context),st(t),null;case 17:return vt(t.type)&&Qi(),st(t),null;case 19:if(Ce(Oe),i=t.memoizedState,i===null)return st(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)fs(i,!1);else{if(Ke!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=no(e),o!==null){for(t.flags|=128,fs(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Se(Oe,Oe.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ue()>Kr&&(t.flags|=128,r=!0,fs(i,!1),t.lanes=4194304)}else{if(!r)if(e=no(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),fs(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ae)return st(t),null}else 2*Ue()-i.renderingStartTime>Kr&&n!==1073741824&&(t.flags|=128,r=!0,fs(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ue(),t.sibling=null,n=Oe.current,Se(Oe,r?n&1|2:n&1),t):(st(t),null);case 22:case 23:return yc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?St&1073741824&&(st(t),t.subtreeFlags&6&&(t.flags|=8192)):st(t),null;case 24:return null;case 25:return null}throw Error(R(156,t.tag))}function hg(e,t){switch(Yl(t),t.tag){case 1:return vt(t.type)&&Qi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return qr(),Ce(yt),Ce(ot),oc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ic(t),null;case 13:if(Ce(Oe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(R(340));Hr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ce(Oe),null;case 4:return qr(),null;case 10:return tc(t.type._context),null;case 22:case 23:return yc(),null;case 24:return null;default:return null}}var wi=!1,it=!1,pg=typeof WeakSet=="function"?WeakSet:Set,G=null;function Rr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Fe(e,t,r)}else n.current=null}function pl(e,t,n){try{n()}catch(r){Fe(e,t,r)}}var Lu=!1;function mg(e,t){if(Ya=Gi,e=df(),Ql(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,m=null;t:for(;;){for(var v;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)m=h,h=v;for(;;){if(h===e)break t;if(m===n&&++u===s&&(l=o),m===i&&++d===r&&(c=o),(v=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=v}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xa={focusedElem:e,selectionRange:n},Gi=!1,G=t;G!==null;)if(t=G,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,G=e;else for(;G!==null;){t=G;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,k=x.memoizedState,g=t.stateNode,f=g.getSnapshotBeforeUpdate(t.elementType===t.type?b:Ht(t.type,b),k);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(_){Fe(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,G=e;break}G=t.return}return x=Lu,Lu=!1,x}function Ns(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&pl(t,n,i)}s=s.next}while(s!==r)}}function bo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ml(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function ah(e){var t=e.alternate;t!==null&&(e.alternate=null,ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[nn],delete t[Bs],delete t[tl],delete t[Ym],delete t[Xm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lh(e){return e.tag===5||e.tag===3||e.tag===4}function Ru(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ki));else if(r!==4&&(e=e.child,e!==null))for(gl(e,t,n),e=e.sibling;e!==null;)gl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(yl(e,t,n),e=e.sibling;e!==null;)yl(e,t,n),e=e.sibling}var Ze=null,Gt=!1;function _n(e,t,n){for(n=n.child;n!==null;)ch(e,t,n),n=n.sibling}function ch(e,t,n){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(po,n)}catch{}switch(n.tag){case 5:it||Rr(n,t);case 6:var r=Ze,s=Gt;Ze=null,_n(e,t,n),Ze=r,Gt=s,Ze!==null&&(Gt?(e=Ze,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(Gt?(e=Ze,n=n.stateNode,e.nodeType===8?oa(e.parentNode,n):e.nodeType===1&&oa(e,n),Ms(e)):oa(Ze,n.stateNode));break;case 4:r=Ze,s=Gt,Ze=n.stateNode.containerInfo,Gt=!0,_n(e,t,n),Ze=r,Gt=s;break;case 0:case 11:case 14:case 15:if(!it&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&pl(n,t,o),s=s.next}while(s!==r)}_n(e,t,n);break;case 1:if(!it&&(Rr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Fe(n,t,l)}_n(e,t,n);break;case 21:_n(e,t,n);break;case 22:n.mode&1?(it=(r=it)||n.memoizedState!==null,_n(e,t,n),it=r):_n(e,t,n);break;default:_n(e,t,n)}}function Au(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new pg),t.forEach(function(r){var s=Sg.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ze=l.stateNode,Gt=!1;break e;case 3:Ze=l.stateNode.containerInfo,Gt=!0;break e;case 4:Ze=l.stateNode.containerInfo,Gt=!0;break e}l=l.return}if(Ze===null)throw Error(R(160));ch(i,o,s),Ze=null,Gt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Fe(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)uh(t,e),t=t.sibling}function uh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vt(t,e),Zt(e),r&4){try{Ns(3,e,e.return),bo(3,e)}catch(b){Fe(e,e.return,b)}try{Ns(5,e,e.return)}catch(b){Fe(e,e.return,b)}}break;case 1:Vt(t,e),Zt(e),r&512&&n!==null&&Rr(n,n.return);break;case 5:if(Vt(t,e),Zt(e),r&512&&n!==null&&Rr(n,n.return),e.flags&32){var s=e.stateNode;try{As(s,"")}catch(b){Fe(e,e.return,b)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ld(s,i),Ua(l,o);var u=Ua(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?zd(s,h):d==="dangerouslySetInnerHTML"?$d(s,h):d==="children"?As(s,h):zl(s,d,h,u)}switch(l){case"input":za(s,i);break;case"textarea":Rd(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Or(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?Or(s,!!i.multiple,i.defaultValue,!0):Or(s,!!i.multiple,i.multiple?[]:"",!1))}s[Bs]=i}catch(b){Fe(e,e.return,b)}}break;case 6:if(Vt(t,e),Zt(e),r&4){if(e.stateNode===null)throw Error(R(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){Fe(e,e.return,b)}}break;case 3:if(Vt(t,e),Zt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ms(t.containerInfo)}catch(b){Fe(e,e.return,b)}break;case 4:Vt(t,e),Zt(e);break;case 13:Vt(t,e),Zt(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(mc=Ue())),r&4&&Au(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(it=(u=it)||d,Vt(t,e),it=u):Vt(t,e),Zt(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(G=e,d=e.child;d!==null;){for(h=G=d;G!==null;){switch(m=G,v=m.child,m.tag){case 0:case 11:case 14:case 15:Ns(4,m,m.return);break;case 1:Rr(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){Fe(r,n,b)}}break;case 5:Rr(m,m.return);break;case 22:if(m.memoizedState!==null){Ou(h);continue}}v!==null?(v.return=m,G=v):Ou(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Od("display",o))}catch(b){Fe(e,e.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(b){Fe(e,e.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vt(t,e),Zt(e),r&4&&Au(e);break;case 21:break;default:Vt(t,e),Zt(e)}}function Zt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(lh(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(As(s,""),r.flags&=-33);var i=Ru(e);yl(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Ru(e);gl(e,l,o);break;default:throw Error(R(161))}}catch(c){Fe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gg(e,t,n){G=e,dh(e)}function dh(e,t,n){for(var r=(e.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||wi;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||it;l=wi;var u=it;if(wi=o,(it=c)&&!u)for(G=s;G!==null;)o=G,c=o.child,o.tag===22&&o.memoizedState!==null?zu(s):c!==null?(c.return=o,G=c):zu(s);for(;i!==null;)G=i,dh(i),i=i.sibling;G=s,wi=l,it=u}$u(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):$u(e)}}function $u(e){for(;G!==null;){var t=G;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:it||bo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!it)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ht(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&vu(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}vu(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ms(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}it||t.flags&512&&ml(t)}catch(m){Fe(t,t.return,m)}}if(t===e){G=null;break}if(n=t.sibling,n!==null){n.return=t.return,G=n;break}G=t.return}}function Ou(e){for(;G!==null;){var t=G;if(t===e){G=null;break}var n=t.sibling;if(n!==null){n.return=t.return,G=n;break}G=t.return}}function zu(e){for(;G!==null;){var t=G;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{bo(4,t)}catch(c){Fe(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Fe(t,s,c)}}var i=t.return;try{ml(t)}catch(c){Fe(t,i,c)}break;case 5:var o=t.return;try{ml(t)}catch(c){Fe(t,o,c)}}}catch(c){Fe(t,t.return,c)}if(t===e){G=null;break}var l=t.sibling;if(l!==null){l.return=t.return,G=l;break}G=t.return}}var yg=Math.ceil,io=xn.ReactCurrentDispatcher,hc=xn.ReactCurrentOwner,zt=xn.ReactCurrentBatchConfig,ge=0,Ye=null,qe=null,et=0,St=0,Ar=Vn(0),Ke=0,Ks=null,or=0,ko=0,pc=0,Es=null,pt=null,mc=0,Kr=1/0,ln=null,oo=!1,vl=null,Mn=null,_i=!1,Ln=null,ao=0,Cs=0,xl=null,Mi=-1,Di=0;function ct(){return ge&6?Ue():Mi!==-1?Mi:Mi=Ue()}function Dn(e){return e.mode&1?ge&2&&et!==0?et&-et:eg.transition!==null?(Di===0&&(Di=Kd()),Di):(e=_e,e!==0||(e=window.event,e=e===void 0?16:tf(e.type)),e):1}function Qt(e,t,n,r){if(50<Cs)throw Cs=0,xl=null,Error(R(185));Xs(e,n,r),(!(ge&2)||e!==Ye)&&(e===Ye&&(!(ge&2)&&(ko|=n),Ke===4&&Cn(e,et)),xt(e,r),n===1&&ge===0&&!(t.mode&1)&&(Kr=Ue()+500,xo&&Hn()))}function xt(e,t){var n=e.callbackNode;em(e,t);var r=Hi(e,e===Ye?et:0);if(r===0)n!==null&&Gc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gc(n),t===1)e.tag===0?Zm(Mu.bind(null,e)):_f(Mu.bind(null,e)),Qm(function(){!(ge&6)&&Hn()}),n=null;else{switch(Qd(r)){case 1:n=Ul;break;case 4:n=qd;break;case 16:n=Vi;break;case 536870912:n=Wd;break;default:n=Vi}n=xh(n,fh.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fh(e,t){if(Mi=-1,Di=0,ge&6)throw Error(R(327));var n=e.callbackNode;if(Fr()&&e.callbackNode!==n)return null;var r=Hi(e,e===Ye?et:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=lo(e,r);else{t=r;var s=ge;ge|=2;var i=ph();(Ye!==e||et!==t)&&(ln=null,Kr=Ue()+500,tr(e,t));do try{wg();break}catch(l){hh(e,l)}while(!0);ec(),io.current=i,ge=s,qe!==null?t=0:(Ye=null,et=0,t=Ke)}if(t!==0){if(t===2&&(s=qa(e),s!==0&&(r=s,t=wl(e,s))),t===1)throw n=Ks,tr(e,0),Cn(e,r),xt(e,Ue()),n;if(t===6)Cn(e,r);else{if(s=e.current.alternate,!(r&30)&&!vg(s)&&(t=lo(e,r),t===2&&(i=qa(e),i!==0&&(r=i,t=wl(e,i))),t===1))throw n=Ks,tr(e,0),Cn(e,r),xt(e,Ue()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(R(345));case 2:Qn(e,pt,ln);break;case 3:if(Cn(e,r),(r&130023424)===r&&(t=mc+500-Ue(),10<t)){if(Hi(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){ct(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=el(Qn.bind(null,e,pt,ln),t);break}Qn(e,pt,ln);break;case 4:if(Cn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-Kt(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yg(r/1960))-r,10<r){e.timeoutHandle=el(Qn.bind(null,e,pt,ln),r);break}Qn(e,pt,ln);break;case 5:Qn(e,pt,ln);break;default:throw Error(R(329))}}}return xt(e,Ue()),e.callbackNode===n?fh.bind(null,e):null}function wl(e,t){var n=Es;return e.current.memoizedState.isDehydrated&&(tr(e,t).flags|=256),e=lo(e,t),e!==2&&(t=pt,pt=n,t!==null&&_l(t)),e}function _l(e){pt===null?pt=e:pt.push.apply(pt,e)}function vg(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Jt(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Cn(e,t){for(t&=~pc,t&=~ko,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Kt(t),r=1<<n;e[n]=-1,t&=~r}}function Mu(e){if(ge&6)throw Error(R(327));Fr();var t=Hi(e,0);if(!(t&1))return xt(e,Ue()),null;var n=lo(e,t);if(e.tag!==0&&n===2){var r=qa(e);r!==0&&(t=r,n=wl(e,r))}if(n===1)throw n=Ks,tr(e,0),Cn(e,t),xt(e,Ue()),n;if(n===6)throw Error(R(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qn(e,pt,ln),xt(e,Ue()),null}function gc(e,t){var n=ge;ge|=1;try{return e(t)}finally{ge=n,ge===0&&(Kr=Ue()+500,xo&&Hn())}}function ar(e){Ln!==null&&Ln.tag===0&&!(ge&6)&&Fr();var t=ge;ge|=1;var n=zt.transition,r=_e;try{if(zt.transition=null,_e=1,e)return e()}finally{_e=r,zt.transition=n,ge=t,!(ge&6)&&Hn()}}function yc(){St=Ar.current,Ce(Ar)}function tr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Km(n)),qe!==null)for(n=qe.return;n!==null;){var r=n;switch(Yl(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qi();break;case 3:qr(),Ce(yt),Ce(ot),oc();break;case 5:ic(r);break;case 4:qr();break;case 13:Ce(Oe);break;case 19:Ce(Oe);break;case 10:tc(r.type._context);break;case 22:case 23:yc()}n=n.return}if(Ye=e,qe=e=In(e.current,null),et=St=t,Ke=0,Ks=null,pc=ko=or=0,pt=Es=null,Zn!==null){for(t=0;t<Zn.length;t++)if(n=Zn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Zn=null}return e}function hh(e,t){do{var n=qe;try{if(ec(),$i.current=so,ro){for(var r=ze.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ro=!1}if(ir=0,Je=We=ze=null,js=!1,Gs=0,hc.current=null,n===null||n.return===null){Ke=1,Ks=t,qe=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=et,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=Su(o);if(v!==null){v.flags&=-257,ju(v,o,l,i,t),v.mode&1&&ku(i,u,t),t=v,c=u;var x=t.updateQueue;if(x===null){var b=new Set;b.add(c),t.updateQueue=b}else x.add(c);break e}else{if(!(t&1)){ku(i,u,t),vc();break e}c=Error(R(426))}}else if(Ae&&l.mode&1){var k=Su(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ju(k,o,l,i,t),Xl(Wr(c,l));break e}}i=c=Wr(c,l),Ke!==4&&(Ke=2),Es===null?Es=[i]:Es.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=Jf(i,c,t);yu(i,g);break e;case 1:l=c;var f=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Mn===null||!Mn.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Yf(i,l,t);yu(i,_);break e}}i=i.return}while(i!==null)}gh(n)}catch(S){t=S,qe===n&&n!==null&&(qe=n=n.return);continue}break}while(!0)}function ph(){var e=io.current;return io.current=so,e===null?so:e}function vc(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ye===null||!(or&268435455)&&!(ko&268435455)||Cn(Ye,et)}function lo(e,t){var n=ge;ge|=2;var r=ph();(Ye!==e||et!==t)&&(ln=null,tr(e,t));do try{xg();break}catch(s){hh(e,s)}while(!0);if(ec(),ge=n,io.current=r,qe!==null)throw Error(R(261));return Ye=null,et=0,Ke}function xg(){for(;qe!==null;)mh(qe)}function wg(){for(;qe!==null&&!Gp();)mh(qe)}function mh(e){var t=vh(e.alternate,e,St);e.memoizedProps=e.pendingProps,t===null?gh(e):qe=t,hc.current=null}function gh(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=hg(n,t),n!==null){n.flags&=32767,qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ke=6,qe=null;return}}else if(n=fg(n,t,St),n!==null){qe=n;return}if(t=t.sibling,t!==null){qe=t;return}qe=t=e}while(t!==null);Ke===0&&(Ke=5)}function Qn(e,t,n){var r=_e,s=zt.transition;try{zt.transition=null,_e=1,_g(e,t,n,r)}finally{zt.transition=s,_e=r}return null}function _g(e,t,n,r){do Fr();while(Ln!==null);if(ge&6)throw Error(R(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(R(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(tm(e,i),e===Ye&&(qe=Ye=null,et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_i||(_i=!0,xh(Vi,function(){return Fr(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=zt.transition,zt.transition=null;var o=_e;_e=1;var l=ge;ge|=4,hc.current=null,mg(e,n),uh(n,e),Um(Xa),Gi=!!Ya,Xa=Ya=null,e.current=n,gg(n),qp(),ge=l,_e=o,zt.transition=i}else e.current=n;if(_i&&(_i=!1,Ln=e,ao=s),i=e.pendingLanes,i===0&&(Mn=null),Qp(n.stateNode),xt(e,Ue()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(oo)throw oo=!1,e=vl,vl=null,e;return ao&1&&e.tag!==0&&Fr(),i=e.pendingLanes,i&1?e===xl?Cs++:(Cs=0,xl=e):Cs=0,Hn(),null}function Fr(){if(Ln!==null){var e=Qd(ao),t=zt.transition,n=_e;try{if(zt.transition=null,_e=16>e?16:e,Ln===null)var r=!1;else{if(e=Ln,Ln=null,ao=0,ge&6)throw Error(R(331));var s=ge;for(ge|=4,G=e.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(G=u;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:Ns(8,d,i)}var h=d.child;if(h!==null)h.return=d,G=h;else for(;G!==null;){d=G;var m=d.sibling,v=d.return;if(ah(d),d===u){G=null;break}if(m!==null){m.return=v,G=m;break}G=v}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var k=b.sibling;b.sibling=null,b=k}while(b!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ns(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,G=g;break e}G=i.return}}var f=e.current;for(G=f;G!==null;){o=G;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,G=y;else e:for(o=f;G!==null;){if(l=G,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:bo(9,l)}}catch(S){Fe(l,l.return,S)}if(l===o){G=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,G=_;break e}G=l.return}}if(ge=s,Hn(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(po,e)}catch{}r=!0}return r}finally{_e=n,zt.transition=t}}return!1}function Du(e,t,n){t=Wr(n,t),t=Jf(e,t,1),e=zn(e,t,1),t=ct(),e!==null&&(Xs(e,1,t),xt(e,t))}function Fe(e,t,n){if(e.tag===3)Du(e,e,n);else for(;t!==null;){if(t.tag===3){Du(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mn===null||!Mn.has(r))){e=Wr(n,e),e=Yf(t,e,1),t=zn(t,e,1),e=ct(),t!==null&&(Xs(t,1,e),xt(t,e));break}}t=t.return}}function bg(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ct(),e.pingedLanes|=e.suspendedLanes&n,Ye===e&&(et&n)===n&&(Ke===4||Ke===3&&(et&130023424)===et&&500>Ue()-mc?tr(e,0):pc|=n),xt(e,t)}function yh(e,t){t===0&&(e.mode&1?(t=di,di<<=1,!(di&130023424)&&(di=4194304)):t=1);var n=ct();e=gn(e,t),e!==null&&(Xs(e,t,n),xt(e,n))}function kg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),yh(e,n)}function Sg(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(t),yh(e,n)}var vh;vh=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||yt.current)gt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return gt=!1,dg(e,t,n);gt=!!(e.flags&131072)}else gt=!1,Ae&&t.flags&1048576&&bf(t,Xi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zi(e,t),e=t.pendingProps;var s=Vr(t,ot.current);Ir(t,n),s=lc(null,t,r,e,s,n);var i=cc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vt(r)?(i=!0,Ji(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,rc(t),s.updater=_o,t.stateNode=s,s._reactInternals=t,al(t,r,e,n),t=ul(null,t,r,!0,i,n)):(t.tag=0,Ae&&i&&Jl(t),lt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zi(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Ng(r),e=Ht(r,e),s){case 0:t=cl(null,t,r,e,n);break e;case 1:t=Cu(null,t,r,e,n);break e;case 11:t=Nu(null,t,r,e,n);break e;case 14:t=Eu(null,t,r,Ht(r.type,e),n);break e}throw Error(R(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ht(r,s),cl(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ht(r,s),Cu(e,t,r,s,n);case 3:e:{if(th(t),e===null)throw Error(R(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Cf(e,t),to(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Wr(Error(R(423)),t),t=Pu(e,t,r,n,s);break e}else if(r!==s){s=Wr(Error(R(424)),t),t=Pu(e,t,r,n,s);break e}else for(jt=On(t.stateNode.containerInfo.firstChild),Nt=t,Ae=!0,Wt=null,n=Nf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hr(),r===s){t=yn(e,t,n);break e}lt(e,t,r,n)}t=t.child}return t;case 5:return Pf(t),e===null&&sl(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Za(r,s)?o=null:i!==null&&Za(r,i)&&(t.flags|=32),eh(e,t),lt(e,t,o,n),t.child;case 6:return e===null&&sl(t),null;case 13:return nh(e,t,n);case 4:return sc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gr(t,null,r,n):lt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ht(r,s),Nu(e,t,r,s,n);case 7:return lt(e,t,t.pendingProps,n),t.child;case 8:return lt(e,t,t.pendingProps.children,n),t.child;case 12:return lt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Se(Zi,r._currentValue),r._currentValue=o,i!==null)if(Jt(i.value,o)){if(i.children===s.children&&!yt.current){t=yn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=hn(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),il(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(R(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),il(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}lt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ir(t,n),s=Dt(s),r=r(s),t.flags|=1,lt(e,t,r,n),t.child;case 14:return r=t.type,s=Ht(r,t.pendingProps),s=Ht(r.type,s),Eu(e,t,r,s,n);case 15:return Xf(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ht(r,s),zi(e,t),t.tag=1,vt(r)?(e=!0,Ji(t)):e=!1,Ir(t,n),Qf(t,r,s),al(t,r,s,n),ul(null,t,r,!0,e,n);case 19:return rh(e,t,n);case 22:return Zf(e,t,n)}throw Error(R(156,t.tag))};function xh(e,t){return Gd(e,t)}function jg(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(e,t,n,r){return new jg(e,t,n,r)}function xc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ng(e){if(typeof e=="function")return xc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Dl)return 11;if(e===Il)return 14}return 2}function In(e,t){var n=e.alternate;return n===null?(n=Ot(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ii(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")xc(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case kr:return nr(n.children,s,i,t);case Ml:o=8,s|=8;break;case La:return e=Ot(12,n,t,s|2),e.elementType=La,e.lanes=i,e;case Ra:return e=Ot(13,n,t,s),e.elementType=Ra,e.lanes=i,e;case Aa:return e=Ot(19,n,t,s),e.elementType=Aa,e.lanes=i,e;case Cd:return So(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Nd:o=10;break e;case Ed:o=9;break e;case Dl:o=11;break e;case Il:o=14;break e;case Sn:o=16,r=null;break e}throw Error(R(130,e==null?e:typeof e,""))}return t=Ot(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function nr(e,t,n,r){return e=Ot(7,e,r,t),e.lanes=n,e}function So(e,t,n,r){return e=Ot(22,e,r,t),e.elementType=Cd,e.lanes=n,e.stateNode={isHidden:!1},e}function pa(e,t,n){return e=Ot(6,e,null,t),e.lanes=n,e}function ma(e,t,n){return t=Ot(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Eg(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qo(0),this.expirationTimes=Qo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qo(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function wc(e,t,n,r,s,i,o,l,c){return e=new Eg(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ot(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rc(i),e}function Cg(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:br,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function wh(e){if(!e)return Un;e=e._reactInternals;e:{if(ur(e)!==e||e.tag!==1)throw Error(R(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(R(171))}if(e.tag===1){var n=e.type;if(vt(n))return wf(e,n,t)}return t}function _h(e,t,n,r,s,i,o,l,c){return e=wc(n,r,!0,e,s,i,o,l,c),e.context=wh(null),n=e.current,r=ct(),s=Dn(n),i=hn(r,s),i.callback=t??null,zn(n,i,s),e.current.lanes=s,Xs(e,s,r),xt(e,r),e}function jo(e,t,n,r){var s=t.current,i=ct(),o=Dn(s);return n=wh(n),t.context===null?t.context=n:t.pendingContext=n,t=hn(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=zn(s,t,o),e!==null&&(Qt(e,s,o,i),Ai(e,s,o)),o}function co(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Iu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function _c(e,t){Iu(e,t),(e=e.alternate)&&Iu(e,t)}function Pg(){return null}var bh=typeof reportError=="function"?reportError:function(e){console.error(e)};function bc(e){this._internalRoot=e}No.prototype.render=bc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(R(409));jo(e,t,null,null)};No.prototype.unmount=bc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ar(function(){jo(null,e,null,null)}),t[mn]=null}};function No(e){this._internalRoot=e}No.prototype.unstable_scheduleHydration=function(e){if(e){var t=Xd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<En.length&&t!==0&&t<En[n].priority;n++);En.splice(n,0,e),n===0&&ef(e)}};function kc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Eo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fu(){}function Tg(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=co(o);i.call(u)}}var o=_h(t,r,e,0,null,!1,!1,"",Fu);return e._reactRootContainer=o,e[mn]=o.current,Fs(e.nodeType===8?e.parentNode:e),ar(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=co(c);l.call(u)}}var c=wc(e,0,!1,null,null,!1,!1,"",Fu);return e._reactRootContainer=c,e[mn]=c.current,Fs(e.nodeType===8?e.parentNode:e),ar(function(){jo(t,c,n,r)}),c}function Co(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=co(o);l.call(c)}}jo(t,o,e,s)}else o=Tg(n,t,e,s,r);return co(o)}Jd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ys(t.pendingLanes);n!==0&&(Bl(t,n|1),xt(t,Ue()),!(ge&6)&&(Kr=Ue()+500,Hn()))}break;case 13:ar(function(){var r=gn(e,1);if(r!==null){var s=ct();Qt(r,e,1,s)}}),_c(e,1)}};Vl=function(e){if(e.tag===13){var t=gn(e,134217728);if(t!==null){var n=ct();Qt(t,e,134217728,n)}_c(e,134217728)}};Yd=function(e){if(e.tag===13){var t=Dn(e),n=gn(e,t);if(n!==null){var r=ct();Qt(n,e,t,r)}_c(e,t)}};Xd=function(){return _e};Zd=function(e,t){var n=_e;try{return _e=e,t()}finally{_e=n}};Va=function(e,t,n){switch(t){case"input":if(za(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=vo(r);if(!s)throw Error(R(90));Td(r),za(r,s)}}}break;case"textarea":Rd(e,n);break;case"select":t=n.value,t!=null&&Or(e,!!n.multiple,t,!1)}};Id=gc;Fd=ar;var Lg={usingClientEntryPoint:!1,Events:[ei,Er,vo,Md,Dd,gc]},hs={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rg={bundleType:hs.bundleType,version:hs.version,rendererPackageName:hs.rendererPackageName,rendererConfig:hs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Vd(e),e===null?null:e.stateNode},findFiberByHostInstance:hs.findFiberByHostInstance||Pg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bi.isDisabled&&bi.supportsFiber)try{po=bi.inject(Rg),rn=bi}catch{}}Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lg;Ct.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kc(t))throw Error(R(200));return Cg(e,t,null,n)};Ct.createRoot=function(e,t){if(!kc(e))throw Error(R(299));var n=!1,r="",s=bh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=wc(e,1,!1,null,null,n,!1,r,s),e[mn]=t.current,Fs(e.nodeType===8?e.parentNode:e),new bc(t)};Ct.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(R(188)):(e=Object.keys(e).join(","),Error(R(268,e)));return e=Vd(t),e=e===null?null:e.stateNode,e};Ct.flushSync=function(e){return ar(e)};Ct.hydrate=function(e,t,n){if(!Eo(t))throw Error(R(200));return Co(null,e,t,!0,n)};Ct.hydrateRoot=function(e,t,n){if(!kc(e))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=bh;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=_h(t,null,e,1,n??null,s,!1,i,o),e[mn]=t.current,Fs(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new No(t)};Ct.render=function(e,t,n){if(!Eo(t))throw Error(R(200));return Co(null,e,t,!1,n)};Ct.unmountComponentAtNode=function(e){if(!Eo(e))throw Error(R(40));return e._reactRootContainer?(ar(function(){Co(null,null,e,!1,function(){e._reactRootContainer=null,e[mn]=null})}),!0):!1};Ct.unstable_batchedUpdates=gc;Ct.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Eo(n))throw Error(R(200));if(e==null||e._reactInternals===void 0)throw Error(R(38));return Co(e,t,n,!1,r)};Ct.version="18.3.1-next-f1338f8080-20240426";function kh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kh)}catch(e){console.error(e)}}kh(),bd.exports=Ct;var Ag=bd.exports,Sh,Uu=Ag;Sh=Uu.createRoot,Uu.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $g={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),se=(e,t)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>p.createElement("svg",{ref:d,...$g,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Og(e)}`,l].join(" "),...u},[...t.map(([h,m])=>p.createElement(h,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=se("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=se("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=se("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=se("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=se("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=se("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=se("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=se("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=se("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=se("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=se("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=se("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=se("MessageSquareText",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=se("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=se("PencilLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=se("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=se("PlusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=se("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=se("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=se("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=se("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=se("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=se("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=se("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),iy=({onNext:e})=>a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-green to-brand-gray flex flex-col items-center justify-center p-8 text-white",children:[a.jsxs("div",{className:"text-center max-w-md",children:[a.jsxs("div",{className:"flex justify-center items-center mb-8",children:[a.jsx(Th,{size:48,className:"text-accent-yellow mr-2"}),a.jsx("span",{className:"text-4xl font-bold ml-2",children:"The Circuit"})]}),a.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Connect, Climb, Conquer."}),a.jsx("p",{className:"text-lg mb-8 opacity-90",children:"Your Gym's Beta, In Your Pocket."}),a.jsxs("div",{className:"space-y-4 mb-12 text-left px-4",children:[a.jsx("p",{children:"✓ Discover and share routes (beta) in your gym."}),a.jsx("p",{children:"✓ Track your climbs and progress."}),a.jsx("p",{children:"✓ Connect with fellow climbers."})]}),a.jsx("button",{onClick:e,className:"w-full bg-accent-yellow hover:bg-opacity-90 text-brand-gray font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg",children:"Get Started"})]}),a.jsxs("div",{className:"absolute bottom-4 text-xs opacity-70",children:["Photo by ",a.jsx("a",{href:"https://unsplash.com/@scottagoodwill?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Scott Goodwill"})," on ",a.jsx("a",{href:"https://unsplash.com/photos/white-and-black-mountain-illustration-y8Ngwq34_Ak?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Unsplash"})]}),a.jsx("div",{className:"absolute inset-0 -z-10 bg-cover bg-center opacity-20",style:{backgroundImage:"url('https://images.unsplash.com/photo-1587404840900-836445ab150f?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')"}})]}),oy="modulepreload",ay=function(e){return"/"+e},Vu={},Jr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=ay(c),c in Vu)return;Vu[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":oy,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,v)=>{h.addEventListener("load",m),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},ly=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Jr(async()=>{const{default:r}=await Promise.resolve().then(()=>ns);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class Ec extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class cy extends Ec{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class uy extends Ec{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class dy extends Ec{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bl;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(bl||(bl={}));var fy=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class hy{constructor(t,{headers:n={},customFetch:r,region:s=bl.Any}={}){this.url=t,this.headers=n,this.region=s,this.fetch=ly(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return fy(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=n;let l={},{region:c}=n;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(x=>{throw new cy(x)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new uy(d);if(!d.ok)throw new dy(d);let m=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),v;return m==="application/json"?v=yield d.json():m==="application/octet-stream"?v=yield d.blob():m==="text/event-stream"?v=d:m==="multipart/form-data"?v=yield d.formData():v=yield d.text(),{data:v,error:null}}catch(s){return{data:null,error:s}}})}}var mt={},Cc={},Ao={},si={},$o={},Oo={},py=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yr=py();const my=Yr.fetch,Ah=Yr.fetch.bind(Yr),$h=Yr.Headers,gy=Yr.Request,yy=Yr.Response,ns=Object.freeze(Object.defineProperty({__proto__:null,Headers:$h,Request:gy,Response:yy,default:Ah,fetch:my},Symbol.toStringTag,{value:"Module"})),vy=ap(ns);var zo={};Object.defineProperty(zo,"__esModule",{value:!0});let xy=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};zo.default=xy;var Oh=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Oo,"__esModule",{value:!0});const wy=Oh(vy),_y=Oh(zo);let by=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=wy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let u=null,d=null,h=null,m=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const g=await i.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=g:d=JSON.parse(g))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),k=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&k&&k.length>1&&(h=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,m=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{u=JSON.parse(b),Array.isArray(u)&&i.status===404&&(d=[],u=null,m=200,v="OK")}catch{i.status===404&&b===""?(m=204,v="No Content"):u={message:b}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,m=200,v="OK"),u&&this.shouldThrowOnError)throw new _y.default(u)}return{error:u,data:d,count:h,status:m,statusText:v}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,n)}returns(){return this}overrideTypes(){return this}};Oo.default=by;var ky=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($o,"__esModule",{value:!0});const Sy=ky(Oo);let jy=class extends Sy.default{select(t){let n=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};$o.default=jy;var Ny=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(si,"__esModule",{value:!0});const Ey=Ny($o);let Cy=class extends Ey.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};si.default=Cy;var Py=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ao,"__esModule",{value:!0});const ps=Py(si);let Ty=class{constructor(t,{headers:n={},schema:r,fetch:s}){this.url=t,this.headers=n,this.schema=r,this.fetch=s}select(t,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new ps.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ps.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ps.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new ps.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ps.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ao.default=Ty;var Mo={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.version=void 0;Do.version="0.0.0-automated";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.DEFAULT_HEADERS=void 0;const Ly=Do;Mo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ly.version}`};var zh=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cc,"__esModule",{value:!0});const Ry=zh(Ao),Ay=zh(si),$y=Mo;let Oy=class Mh{constructor(t,{headers:n={},schema:r,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},$y.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=s}from(t){const n=new URL(`${this.url}/${t}`);return new Ry.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Mh(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||s?(o=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new Ay.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Cc.default=Oy;var rs=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mt,"__esModule",{value:!0});mt.PostgrestError=mt.PostgrestBuilder=mt.PostgrestTransformBuilder=mt.PostgrestFilterBuilder=mt.PostgrestQueryBuilder=mt.PostgrestClient=void 0;const Dh=rs(Cc);mt.PostgrestClient=Dh.default;const Ih=rs(Ao);mt.PostgrestQueryBuilder=Ih.default;const Fh=rs(si);mt.PostgrestFilterBuilder=Fh.default;const Uh=rs($o);mt.PostgrestTransformBuilder=Uh.default;const Bh=rs(Oo);mt.PostgrestBuilder=Bh.default;const Vh=rs(zo);mt.PostgrestError=Vh.default;var zy=mt.default={PostgrestClient:Dh.default,PostgrestQueryBuilder:Ih.default,PostgrestFilterBuilder:Fh.default,PostgrestTransformBuilder:Uh.default,PostgrestBuilder:Bh.default,PostgrestError:Vh.default};const{PostgrestClient:My,PostgrestQueryBuilder:ox,PostgrestFilterBuilder:ax,PostgrestTransformBuilder:lx,PostgrestBuilder:cx,PostgrestError:ux}=zy,Dy="2.11.2",Iy={"X-Client-Info":`realtime-js/${Dy}`},Fy="1.0.0",Hh=1e4,Uy=1e3;var Ur;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ur||(Ur={}));var kt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(kt||(kt={}));var qt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(qt||(qt={}));var kl;(function(e){e.websocket="websocket"})(kl||(kl={}));var Yn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Yn||(Yn={}));class By{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const s=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+s));o=o+s;const c=r.decode(t.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Gh{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ke;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ke||(ke={}));const Hu=(e,t,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=Vy(o,e,t,s),i),{})},Vy=(e,t,n,r)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=n[e];return i&&!r.includes(i)?qh(i,o):Sl(o)},qh=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Wy(t,n)}switch(e){case ke.bool:return Hy(t);case ke.float4:case ke.float8:case ke.int2:case ke.int4:case ke.int8:case ke.numeric:case ke.oid:return Gy(t);case ke.json:case ke.jsonb:return qy(t);case ke.timestamp:return Ky(t);case ke.abstime:case ke.date:case ke.daterange:case ke.int4range:case ke.int8range:case ke.money:case ke.reltime:case ke.text:case ke.time:case ke.timestamptz:case ke.timetz:case ke.tsrange:case ke.tstzrange:return Sl(t);default:return Sl(t)}},Sl=e=>e,Hy=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Gy=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},qy=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Wy=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let i;const o=e.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>qh(t,l))}return e},Ky=e=>typeof e=="string"?e.replace(" ","T"):e,Wh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class ga{constructor(t,n,r={},s=Hh){this.channel=t,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gu;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gu||(Gu={}));class Ps{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ps.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Ps.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ps.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,s){const i=this.cloneDeep(t),o=this.transformState(n),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const m=d.map(k=>k.presence_ref),v=h.map(k=>k.presence_ref),x=d.filter(k=>v.indexOf(k.presence_ref)<0),b=h.filter(k=>m.indexOf(k.presence_ref)<0);x.length>0&&(l[u]=x),b.length>0&&(c[u]=b)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,s)}static syncDiff(t,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(v=>v.presence_ref),m=d.filter(v=>h.indexOf(v.presence_ref)<0);t[l].unshift(...m)}r(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const s=t[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qu;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(qu||(qu={}));var Wu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Wu||(Wu={}));var cn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(cn||(cn={}));class Pc{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new ga(this,qt.join,this.params,this.timeout),this.rejoinTimer=new Gh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(qt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ps(this),this.broadcastEndpointURL=Wh(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(d=>t==null?void 0:t(cn.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(cn.CLOSED));const c={},u={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(cn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,v=(h=m==null?void 0:m.length)!==null&&h!==void 0?h:0,x=[];for(let b=0;b<v;b++){const k=m[b],{filter:{event:g,schema:f,table:y,filter:_}}=k,S=d&&d[b];if(S&&S.event===g&&S.schema===f&&S.table===y&&S.filter===_)x.push(Object.assign(Object.assign({},k),{id:S.id}));else{this.unsubscribe(),t==null||t(cn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(cn.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(cn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(cn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this._on(t,n,r)}async send(t,n={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=kt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new ga(this,qt.leave,{},t);s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ga(this,t,n,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=qt;if(r&&[l,c,u,d].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,n,r);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var x,b,k;return((x=v.filter)===null||x===void 0?void 0:x.event)==="*"||((k=(b=v.filter)===null||b===void 0?void 0:b.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(v=>v.callback(m,r)):(i=this.bindings[o])===null||i===void 0||i.filter(v=>{var x,b,k,g,f,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const _=v.id,S=(x=v.filter)===null||x===void 0?void 0:x.event;return _&&((b=n.ids)===null||b===void 0?void 0:b.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const _=(f=(g=v==null?void 0:v.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return _==="*"||_===((y=n==null?void 0:n.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof m=="object"&&"ids"in m){const x=m.data,{schema:b,table:k,commit_timestamp:g,type:f,errors:y}=x;m=Object.assign(Object.assign({},{schema:b,table:k,commit_timestamp:g,eventType:f,new:{},old:{},errors:y}),this._getPayloadRecords(x))}v.callback(m,r)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const s=t.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Pc.isEqual(s.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(qt.close,{},t)}_onError(t){this._on(qt.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Hu(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Hu(t.columns,t.old_record)),n}}const Qy=()=>{},Jy=typeof WebSocket<"u",Yy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xy{constructor(t,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Iy,this.params={},this.timeout=Hh,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Qy,this.conn=null,this.sendBuffer=[],this.serializer=new By,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Jr(async()=>{const{default:c}=await Promise.resolve().then(()=>ns);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${kl.websocket}`,this.httpEndpoint=Wh(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Jy){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Zy(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Jr(async()=>{const{default:t}=await import("./browser-L9u7akoj.js").then(n=>n.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Fy}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ur.connecting:return Yn.Connecting;case Ur.open:return Yn.Open;case Ur.closing:return Yn.Closing;default:return Yn.Closed}}isConnected(){return this.connectionState()===Yn.Open}channel(t,n={config:{}}){const r=new Pc(`realtime:${t}`,n,this);return this.channels.push(r),r}push(t){const{topic:n,event:r,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(s=>{n&&s.updateJoinPayload({access_token:n}),s.joinedOnce&&s._isJoined()&&s._push(qt.access_token,{access_token:n})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Uy,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:r,event:s,payload:i,ref:o}=n;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(r)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(qt.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${t}${r}${s}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Yy],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Zy{constructor(t,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ur.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class Tc extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Qe(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class e0 extends Tc{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class jl extends Tc{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var t0=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Kh=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Jr(async()=>{const{default:r}=await Promise.resolve().then(()=>ns);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},n0=()=>t0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Jr(()=>Promise.resolve().then(()=>ns),void 0)).Response:Response}),Nl=e=>{if(Array.isArray(e))return e.map(n=>Nl(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Nl(r)}),t};var dr=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const ya=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),r0=(e,t,n)=>dr(void 0,void 0,void 0,function*(){const r=yield n0();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(s=>{t(new e0(ya(s),e.status||500))}).catch(s=>{t(new jl(ya(s),s))}):t(new jl(ya(e),e))}),s0=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))};function ii(e,t,n,r,s,i){return dr(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(n,s0(t,r,s,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>r0(c,l,r))})})}function fo(e,t,n,r){return dr(this,void 0,void 0,function*(){return ii(e,"GET",t,n,r)})}function Nn(e,t,n,r,s){return dr(this,void 0,void 0,function*(){return ii(e,"POST",t,r,s,n)})}function i0(e,t,n,r,s){return dr(this,void 0,void 0,function*(){return ii(e,"PUT",t,r,s,n)})}function o0(e,t,n,r){return dr(this,void 0,void 0,function*(){return ii(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Qh(e,t,n,r,s){return dr(this,void 0,void 0,function*(){return ii(e,"DELETE",t,r,s,n)})}var ht=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const a0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ku={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class l0{constructor(t,n={},r,s){this.url=t,this.headers=n,this.bucketId=r,this.fetch=Kh(s)}uploadOrUpdate(t,n,r,s){return ht(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ku),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(n),d=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),m=yield h.json();return h.ok?{data:{path:u,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(i){if(Qe(i))return{data:null,error:i};throw i}})}upload(t,n,r){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,s){return ht(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:Ku.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),m=yield h.json();return h.ok?{data:{path:i,fullPath:m.Key},error:null}:{data:null,error:m}}catch(c){if(Qe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,n){return ht(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield Nn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Tc("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}update(t,n,r){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return ht(this,void 0,void 0,function*(){try{return{data:yield Nn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}copy(t,n,r){return ht(this,void 0,void 0,function*(){try{return{data:{path:(yield Nn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}createSignedUrl(t,n,r){return ht(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Nn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}createSignedUrls(t,n,r){return ht(this,void 0,void 0,function*(){try{const s=yield Nn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}download(t,n){return ht(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield fo(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Qe(l))return{data:null,error:l};throw l}})}info(t){return ht(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield fo(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Nl(r),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}exists(t){return ht(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield o0(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Qe(r)&&r instanceof jl){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(t){return ht(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}list(t,n,r){return ht(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},a0),n),{prefix:t||""});return{data:yield Nn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const c0="2.7.1",u0={"X-Client-Info":`storage-js/${c0}`};var yr=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class d0{constructor(t,n={},r){this.url=t,this.headers=Object.assign(Object.assign({},u0),n),this.fetch=Kh(r)}listBuckets(){return yr(this,void 0,void 0,function*(){try{return{data:yield fo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Qe(t))return{data:null,error:t};throw t}})}getBucket(t){return yr(this,void 0,void 0,function*(){try{return{data:yield fo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return yr(this,void 0,void 0,function*(){try{return{data:yield Nn(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return yr(this,void 0,void 0,function*(){try{return{data:yield i0(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}emptyBucket(t){return yr(this,void 0,void 0,function*(){try{return{data:yield Nn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}deleteBucket(t){return yr(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}}class f0 extends d0{constructor(t,n={},r){super(t,n,r)}from(t){return new l0(this.url,this.headers,t,this.fetch)}}const h0="2.49.4";let xs="";typeof Deno<"u"?xs="deno":typeof document<"u"?xs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xs="react-native":xs="node";const p0={"X-Client-Info":`supabase-js-${xs}/${h0}`},m0={headers:p0},g0={schema:"public"},y0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},v0={};var x0=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const w0=e=>{let t;return e?t=e:typeof fetch>"u"?t=Ah:t=fetch,(...n)=>t(...n)},_0=()=>typeof Headers>"u"?$h:Headers,b0=(e,t,n)=>{const r=w0(n),s=_0();return(i,o)=>x0(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var k0=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};function S0(e){return e.replace(/\/$/,"")}function j0(e,t){const{db:n,auth:r,realtime:s,global:i}=e,{db:o,auth:l,realtime:c,global:u}=t,d={db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),r),realtime:Object.assign(Object.assign({},c),s),global:Object.assign(Object.assign({},u),i),accessToken:()=>k0(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const Jh="2.69.1",_r=30*1e3,El=3,va=El*_r,N0="http://localhost:9999",E0="supabase.auth.token",C0={"X-Client-Info":`gotrue-js/${Jh}`},Cl="X-Supabase-Api-Version",Yh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,T0=6e5;class Lc extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function fe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class L0 extends Lc{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function R0(e){return fe(e)&&e.name==="AuthApiError"}class Xh extends Lc{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Gn extends Lc{constructor(t,n,r,s){super(t,r,s),this.name=n,this.status=r}}class bn extends Gn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function A0(e){return fe(e)&&e.name==="AuthSessionMissingError"}class xa extends Gn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ki extends Gn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Si extends Gn{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $0(e){return fe(e)&&e.name==="AuthImplicitGrantRedirectError"}class Qu extends Gn{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pl extends Gn{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function wa(e){return fe(e)&&e.name==="AuthRetryableFetchError"}class Ju extends Gn{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Ts extends Gn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xu=` 	
\r=`.split(""),O0=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Xu.length;t+=1)e[Xu[t].charCodeAt(0)]=-2;for(let t=0;t<Yu.length;t+=1)e[Yu[t].charCodeAt(0)]=t;return e})();function Zh(e,t,n){const r=O0[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Zu(e){const t=[],n=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{D0(o,r,n)};for(let o=0;o<e.length;o+=1)Zh(e.charCodeAt(o),s,i);return t.join("")}function z0(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function M0(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}z0(r,t)}}function D0(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function I0(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Zh(e.charCodeAt(s),n,r);return new Uint8Array(t)}function F0(e){const t=[];return M0(e,n=>t.push(n)),new Uint8Array(t)}function U0(e){return Math.round(Date.now()/1e3)+e}function B0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const en=()=>typeof window<"u"&&typeof document<"u",Wn={tested:!1,writable:!1},Ls=()=>{if(!en())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Wn.tested)return Wn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Wn.tested=!0,Wn.writable=!0}catch{Wn.tested=!0,Wn.writable=!1}return Wn.writable};function V0(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{t[s]=r}),t}const ep=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>Jr(async()=>{const{default:r}=await Promise.resolve().then(()=>ns);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},H0=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",tp=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},ji=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ni=async(e,t)=>{await e.removeItem(t)};class Io{constructor(){this.promise=new Io.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Io.promiseConstructor=Promise;function _a(e){const t=e.split(".");if(t.length!==3)throw new Ts("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!P0.test(t[r]))throw new Ts("JWT not in base64url format");return{header:JSON.parse(Zu(t[0])),payload:JSON.parse(Zu(t[1])),signature:I0(t[2]),raw:{header:t[0],payload:t[1]}}}async function G0(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function q0(e,t){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function W0(e){return("0"+e.toString(16)).substr(-2)}function K0(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,W0).join("")}async function Q0(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function J0(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await Q0(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vr(e,t,n=!1){const r=K0();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await tp(e,`${t}-code-verifier`,s);const i=await J0(r);return[i,r===i?"plain":"s256"]}const Y0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function X0(e){const t=e.headers.get(Cl);if(!t||!t.match(Y0))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Z0(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function ev(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var tv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};const Jn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),nv=[502,503,504];async function ed(e){var t;if(!H0(e))throw new Pl(Jn(e),0);if(nv.includes(e.status))throw new Pl(Jn(e),e.status);let n;try{n=await e.json()}catch(i){throw new Xh(Jn(i),i)}let r;const s=X0(e);if(s&&s.getTime()>=Yh["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Ju(Jn(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new bn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Ju(Jn(n),e.status,n.weak_password.reasons);throw new L0(Jn(n),e.status||500,r)}const rv=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function pe(e,t,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Cl]||(i[Cl]=Yh["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await sv(e,t,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function sv(e,t,n,r,s,i){const o=rv(t,r,s,i);let l;try{l=await e(n,Object.assign({},o))}catch(c){throw console.error(c),new Pl(Jn(c),0)}if(l.ok||await ed(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await ed(c)}}function kn(e){var t;let n=null;lv(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=U0(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function td(e){const t=kn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Pn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function iv(e){return{data:e,error:null}}function ov(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=e,o=tv(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function av(e){return e}function lv(e){return e.access_token&&e.refresh_token&&e.expires_in}var cv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};class uv{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=ep(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n="global"){try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Pn})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=cv(t,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ov,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(fe(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Pn})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:av});if(d.error)throw d.error;const h=await d.json(),m=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return v.length>0&&(v.forEach(x=>{const b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(x.split(";")[1].split("=")[1]);u[`${k}Page`]=b}),u.total=parseInt(m)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(fe(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Pn})}catch(n){if(fe(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Pn})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Pn})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){try{const{data:n,error:r}=await pe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _deleteFactor(t){try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}}}const dv={getItem:e=>Ls()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ls()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ls()&&globalThis.localStorage.removeItem(e)}};function nd(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function fv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xr={debug:!!(globalThis&&Ls()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class np extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class hv extends np{}async function pv(e,t,n){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),xr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new hv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(xr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}fv();const mv={url:N0,storageKey:E0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:C0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rd(e,t,n){return await n()}class Js{constructor(t){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Js.nextInstanceID,Js.nextInstanceID+=1,this.instanceID>0&&en()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},mv),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new uv({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=ep(s.fetch),this.lock=s.lock||rd,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:en()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=pv:this.lock=rd,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Ls()?this.storage=dv:(this.memoryStorage={},this.storage=nd(this.memoryStorage)):(this.memoryStorage={},this.storage=nd(this.memoryStorage)),en()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jh}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=V0(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),en()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),$0(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return fe(n)?{error:n}:{error:new Xh("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,s;try{const i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:kn}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(fe(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var n,r,s;try{let i;if("email"in t){const{email:d,password:h,options:m}=t;let v=null,x=null;this.flowType==="pkce"&&([v,x]=await vr(this.storage,this.storageKey)),i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:d,password:h,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:v,code_challenge_method:x},xform:kn})}else if("phone"in t){const{phone:d,password:h,options:m}=t;i=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(s=m==null?void 0:m.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:kn})}else throw new ki("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(fe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let n;if("email"in t){const{email:i,password:o,options:l}=t;n=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:td})}else if("phone"in t){const{phone:i,password:o,options:l}=t;n=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:td})}else throw new ki("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new xa}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const n=await ji(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:o}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:kn});if(await Ni(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new xa}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(fe(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=t,l=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:kn}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new xa}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await vr(this.storage,this.storageKey));const{error:h}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new ki("You must provide either an email or phone number.")}catch(l){if(fe(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var n,r;try{let s,i;"options"in t&&(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:kn});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(fe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var n,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await vr(this.storage,this.storageKey)),await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:iv})}catch(i){if(fe(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new bn;const{error:s}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(fe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:i}=t,{error:o}=await pe(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:s,options:i}=t,{data:o,error:l}=await pe(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ki("You must provide either an email or phone number and a type")}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await ji(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<va:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Pn}):await this._useSession(async n=>{var r,s,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new bn}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Pn})})}catch(n){if(fe(n))return A0(n)&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new bn;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await vr(this.storage,this.storageKey));const{data:u,error:d}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Pn});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(fe(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new bn;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=_a(t.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(fe(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:o,error:l}=n;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new bn;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(fe(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!en())throw new Si("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Si(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Qu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Si("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Qu("No code detected.");const{data:f,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Si("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let m=d+h;c&&(m=parseInt(c));const v=m-d;v*1e3<=_r&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const x=m-h;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,m,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,m,d);const{data:b,error:k}=await this._getUser(i);if(k)throw k;const g={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(r){if(fe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await ji(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(R0(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=B0(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await vr(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(fe(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:m}=i;if(m)throw m;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",v,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return en()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(fe(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await q0(async s=>(s>0&&await G0(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:kn})),(s,i)=>{const o=200*Math.pow(2,s);return i&&wa(i)&&Date.now()+o-r<_r})}catch(r){if(this._debug(n,"error",r),fe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),en()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await ji(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const s=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<va;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${va}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),wa(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new bn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Io;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new bn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),fe(i)){const o={session:null,error:i};return wa(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,n,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tp(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Ni(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&en()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),_r);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/_r);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${_r}ms, refresh threshold is ${El} ticks`),s<=El&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof np)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!en()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await vr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await pe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(fe(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(fe(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await pe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(fe(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=_a(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(o=>o.kid===t);if(r||(r=this.jwks.keys.find(o=>o.kid===t),r&&this.jwks_cached_at+T0>Date.now()))return r;const{data:s,error:i}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Ts("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),r=s.keys.find(o=>o.kid===t),!r)throw new Ts("No matching signing key found in JWKS");return r}async getClaims(t,n={keys:[]}){try{let r=t;if(!r){const{data:v,error:x}=await this.getSession();if(x||!v.session)return{data:null,error:x};r=v.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=_a(r);if(Z0(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:i,header:s,signature:o},error:null}}const u=ev(s.alg),d=await this.fetchJwk(s.kid,n),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,F0(`${l}.${c}`)))throw new Ts("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}}}Js.nextInstanceID=0;const gv=Js;class yv extends gv{constructor(t){super(t)}}var vv=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class xv{constructor(t,n,r){var s,i,o;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=S0(t);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const c=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:g0,realtime:v0,auth:Object.assign(Object.assign({},y0),{storageKey:c}),global:m0},d=j0(r??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=b0(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new My(`${l}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new hy(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new f0(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return vv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yv({url:this.authUrl,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Xy(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wv=(e,t,n)=>new xv(e,t,n),_v="https://eumvfwrylsomqgtwosnu.supabase.co",bv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV1bXZmd3J5bHNvbXFndHdvc251Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM0NTUyNTUsImV4cCI6MjA1OTAzMTI1NX0.M9_EIQju-RvV0cZ0Z1CAkvzpLU1KD64UVULdFkrVwPE",H=wv(_v,bv),Fo=async(e,t)=>{if(e===t)throw new Error("Cannot follow yourself.");const{error:n}=await H.from("user_follows").insert({follower_id:e,following_id:t});if(n)throw console.error("Error following user:",n),n;console.log(`User ${e} followed ${t}`)},Uo=async(e,t)=>{const{error:n}=await H.from("user_follows").delete().eq("follower_id",e).eq("following_id",t);if(n)throw console.error("Error unfollowing user:",n),n;console.log(`User ${e} unfollowed ${t}`)},Bo=async(e,t)=>{const{data:n,error:r}=await H.from("user_follows").select("follower_id").eq("follower_id",e).eq("following_id",t).maybeSingle();return r?(console.error("Error checking follow status:",r),!1):!!n},rp=async e=>{const{count:t,error:n}=await H.from("user_follows").select("*",{count:"exact",head:!0}).eq("following_id",e);n&&console.error("Error fetching follower count:",n);const{count:r,error:s}=await H.from("user_follows").select("*",{count:"exact",head:!0}).eq("follower_id",e);return s&&console.error("Error fetching following count:",s),{followers:t??0,following:r??0}},sp=async(e,t)=>{if(!t.trim())throw new Error("Feedback message cannot be empty.");const{error:n}=await H.from("feedback").insert({feedback_type:e,message:t.trim()});if(n)throw console.error("Error submitting feedback:",n),n.message.includes("check constraint violation")||n.message.includes("row level security policy")?new Error("You must be logged in to submit feedback."):n.message.includes("feedback_feedback_type_check")?new Error("Invalid feedback type provided."):new Error(`Failed to submit feedback: ${n.message}`);console.log(`${e} feedback submitted successfully.`)},kv=({onAuthSuccess:e})=>{const[t,n]=p.useState(!0),[r,s]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(""),[u,d]=p.useState(""),[h,m]=p.useState(null),[v,x]=p.useState(!1),b=async()=>{x(!0),m(null);const{error:f}=await H.auth.signInWithPassword({email:r,password:i});f?m(f.message):(console.log("Login successful!"),e()),x(!1)},k=async()=>{var _;if(x(!0),m(null),i!==l){m("Passwords do not match."),x(!1);return}if(i.length<6){m("Password must be at least 6 characters long."),x(!1);return}if(!u.trim()){m("Please enter a display name."),x(!1);return}const{data:f,error:y}=await H.auth.signUp({email:r,password:i,options:{emailRedirectTo:void 0,data:{display_name:u.trim()}}});y?m(y.message):(console.log("Sign up successful! Display name added."),(_=f==null?void 0:f.user)!=null&&_.id&&await H.from("profiles").update({display_name:u.trim()}).eq("user_id",f.user.id),e()),x(!1)},g=f=>{f.preventDefault(),!v&&(t?b():k())};return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4",children:[a.jsxs("div",{className:"flex justify-center items-center mb-8 text-brand-green",children:[a.jsx(Th,{size:36,className:"text-accent-yellow mr-2"}),a.jsx("span",{className:"text-3xl font-bold",children:"The Circuit"})]}),a.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-2xl font-bold text-center text-brand-gray mb-6",children:t?"Welcome Back!":"Create Account"}),h&&a.jsx("p",{className:"text-red-500 text-sm mb-4 text-center",children:h}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[!t&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-brand-gray mb-1",children:"Display Name"}),a.jsx("input",{type:"text",id:"displayName",value:u,onChange:f=>d(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"Your Climber Name"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-brand-gray mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:r,onChange:f=>s(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-gray mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:i,onChange:f=>o(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"•••••••• (min. 6 characters)"})]}),!t&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-brand-gray mb-1",children:"Confirm Password"}),a.jsx("input",{type:"password",id:"confirmPassword",value:l,onChange:f=>c(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",disabled:v,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:v?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):a.jsxs(a.Fragment,{children:[t?a.jsx(Gg,{size:18}):a.jsx(ri,{size:18}),a.jsx("span",{children:t?"Log In":"Sign Up"})]})})]}),a.jsxs("p",{className:"text-center text-sm text-brand-gray mt-6",children:[t?"Don't have an account?":"Already have an account?",a.jsx("button",{onClick:()=>{v||(n(!t),m(null),d(""),o(""),c(""))},disabled:v,className:"text-accent-blue hover:underline font-medium ml-1 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Sign Up":"Log In"})]})]})]})},Sv=({title:e,feedbackType:t,onClose:n,currentUser:r})=>{const[s,i]=p.useState(""),[o,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(!1),m=async v=>{if(v.preventDefault(),!s.trim()||!r){u(r?"Message cannot be empty.":"You must be logged in to send feedback.");return}l(!0),u(null),h(!1);try{await sp(t,s),h(!0),i(""),setTimeout(n,2e3)}catch(x){u(x.message||"An unexpected error occurred.")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-brand-gray",children:e}),a.jsx("button",{onClick:n,disabled:o,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:a.jsx(Nc,{size:24})})]}),a.jsx("form",{onSubmit:m,className:"p-4 space-y-4",children:d?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ts,{className:"mx-auto text-green-500 mb-2",size:40}),a.jsx("p",{className:"text-brand-gray font-medium",children:"Suggestion Sent!"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for your input."})]}):a.jsxs(a.Fragment,{children:[a.jsx("textarea",{rows:5,value:s,onChange:v=>i(v.target.value),placeholder:"Enter gym name, location, and any other details...",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",required:!0,disabled:o||!r}),c&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:c}),!r&&a.jsx("p",{className:"text-yellow-600 text-sm text-center bg-yellow-50 p-2 rounded border border-yellow-200",children:"You must be logged in to suggest a gym."}),a.jsx("button",{type:"submit",disabled:o||!s.trim()||!r,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx(ae,{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(jc,{size:18}),a.jsx("span",{children:"Send Suggestion"})]})})]})})]})})},ba=5,jv=({preSelectedGymsIds:e,onGymsSelected:t,onNext:n,currentUser:r})=>{const[s,i]=p.useState(""),[o,l]=p.useState(new Set(e)),[c,u]=p.useState([]),[d,h]=p.useState(!1),[m,v]=p.useState(!1),[x,b]=p.useState(null),[k,g]=p.useState(0),[f,y]=p.useState(!0),[_,S]=p.useState(!1),N=p.useRef(null),P=p.useCallback(async(j=0,B=!1,Y=s)=>{B?v(!0):(u([]),g(0),y(!0)),b(null);const X=j*ba,K=X+ba-1;try{let J=H.from("gyms").select("id, name, city, state, country",{count:"exact"}).order("name",{ascending:!0}).range(X,K);if(Y.trim()){const M=`%${Y.trim()}%`;J=J.or(`name.ilike.${M},city.ilike.${M},state.ilike.${M}`)}const{data:ne,error:w,count:E}=await J;if(w)throw new Error(`Failed to load gyms: ${w.message}`);ne?(u(M=>B?[...M,...ne]:ne),g(j),y((j+1)*ba<(E??0))):(B||u([]),y(!1))}catch(J){console.error("Error fetching gyms:",J),b(J.message||"An unexpected error occurred."),B||u([]),y(!1)}finally{v(!1)}},[s]);p.useEffect(()=>{P(0)},[]),p.useEffect(()=>(N.current&&clearTimeout(N.current),s.trim()?N.current=setTimeout(()=>{P(0,!1,s)},300):P(0,!1,""),()=>{N.current&&clearTimeout(N.current)}),[s,P]);const A=j=>{const B=new Set(o);B.has(j)?B.delete(j):B.add(j),l(B),t(Array.from(B))},$=()=>{!m&&f&&P(k+1,!0,s)},O=()=>{n(Array.from(o))};return a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center p-4 pt-12",children:[a.jsxs("div",{className:"w-full max-w-lg",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-brand-green mb-2",children:"Select Your Gym(s)"}),a.jsx("p",{className:"text-center text-brand-gray mb-6",children:"Choose your primary climbing locations."}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx("input",{type:"text",placeholder:"Search by gym name, city, or state...",value:s,onChange:j=>i(j.target.value),className:"w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue",disabled:d&&!m}),a.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden max-h-[50vh] overflow-y-auto mb-6 border border-gray-200",children:d&&c.length===0?a.jsxs("div",{className:"flex justify-center items-center p-10",children:[a.jsx(ae,{className:"animate-spin text-accent-blue",size:32}),a.jsx("p",{className:"ml-3 text-brand-gray",children:"Loading gyms..."})]}):x?a.jsx("p",{className:"text-center text-red-500 p-6",children:x}):c.length>0?a.jsxs(a.Fragment,{children:[c.map(j=>a.jsxs("div",{onClick:()=>A(j.id),className:`flex items-center justify-between p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${o.has(j.id)?"bg-accent-blue/10":""}`,children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Qr,{size:18,className:"text-brand-gray mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-brand-gray",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.city,", ",j.state]})]})]}),o.has(j.id)?a.jsx(Ig,{className:"text-accent-blue",size:24}):a.jsx(Zg,{className:"text-gray-300",size:24})]},j.id)),f&&a.jsx("div",{className:"p-4 text-center border-t border-gray-100",children:a.jsx("button",{onClick:$,disabled:m,className:"text-accent-blue hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center w-full",children:m?a.jsxs(a.Fragment,{children:[a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading..."]}):"Load More Gyms"})})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No gyms found matching your search."})}),a.jsx("button",{onClick:O,disabled:o.size===0||d||!!x,className:`w-full font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg ${o.size>0&&!d&&!x?"bg-accent-blue text-white hover:bg-opacity-90":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:o.size>0?`Continue with ${o.size} Gym(s)`:"Select at least one gym"}),a.jsxs("p",{className:"text-center text-xs text-gray-400 mt-4",children:["Can't find your gym?"," ",a.jsx("button",{onClick:()=>S(!0),className:"underline hover:text-accent-blue disabled:opacity-50",disabled:!r,children:"Suggest it"})]})]}),_&&a.jsx(Sv,{title:"Suggest a Gym",feedbackType:"gym_suggestion",onClose:()=>S(!1),currentUser:r})]})},Nv=e=>{if(!e)return"text-brand-gray";const t={"accent-red":"text-accent-red","accent-blue":"text-accent-blue","accent-yellow":"text-accent-yellow","brand-green":"text-brand-green","accent-purple":"text-accent-purple","brand-gray":"text-brand-gray","brand-brown":"text-brand-brown"};return t[e]||t[e.replace("_","-")]||"text-brand-gray"},Ev=e=>{const t=new Date,n=new Date(e),r=Math.floor((t.getTime()-n.getTime())/1e3),s=Math.floor(r/60),i=Math.floor(s/60),o=Math.floor(i/24);return r<60?`${r}s ago`:s<60?`${s}m ago`:i<24?`${i}h ago`:o===1?"Yesterday":o<7?`${o}d ago`:n.toLocaleDateString()},Cv=e=>{const t=e.user_display_name||`User ${e.user_id.substring(0,6)}`,n=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return e.user_avatar_url||n},ka=10,sd=({currentUser:e,selectedGyms:t,activeGymId:n,onSwitchGym:r,getGymNameById:s,onNavigateToGymSelection:i,onNavigate:o})=>{const[l,c]=p.useState(!1),[u,d]=p.useState(""),[h,m]=p.useState([]),[v,x]=p.useState(!1),[b,k]=p.useState(!1),[g,f]=p.useState(null),[y,_]=p.useState(0),[S,N]=p.useState(!0),[P,A]=p.useState(null),[$,O]=p.useState(!1),[j,B]=p.useState(null),Y=T=>{r(T),c(!1)},X=()=>{c(!1),i()},K=T=>{d(T.target.value)},J=()=>{o("routes",{searchTerm:u.trim()})},ne=p.useCallback(async(T=0,I=!1)=>{if(!n){m([]),x(!1),k(!1),f(null),N(!1);return}I?k(!0):(x(!0),m([]),_(0),N(!0)),f(null);const ee=T*ka,ue=ee+ka-1;try{const{data:me,error:Be,count:ie}=await H.from("activity_log").select(`
                        *,
                        profile:profiles!user_id(display_name, avatar_url),
                        route:routes(
                          name,
                          grade,
                          grade_color,
                          location_info:locations ( name )
                        )
                    `,{count:"exact"}).eq("gym_id",n).order("created_at",{ascending:!1}).range(ee,ue);if(Be)console.error("Error fetching activity log:",Be),f(`Failed to load activity: ${Be.message}`),I||m([]),N(!1);else if(me){const Z=me.map(le=>{var ce,Pe,we,Te,ye,F,U;const re=le.route,oe=re==null?void 0:re.location_info;return{...le,user_display_name:(ce=le.profile)==null?void 0:ce.display_name,user_avatar_url:(Pe=le.profile)==null?void 0:Pe.avatar_url,route_name:(re==null?void 0:re.name)||((we=le.details)==null?void 0:we.route_name),route_grade:(re==null?void 0:re.grade)||((Te=le.details)==null?void 0:Te.route_grade),route_grade_color:(re==null?void 0:re.grade_color)||((ye=le.details)==null?void 0:ye.route_grade_color),location_name:(oe==null?void 0:oe.name)||((F=le.details)==null?void 0:F.location_name),followed_user_display_name:(U=le.details)==null?void 0:U.followed_user_name,followed_user_avatar_url:null,details:le.details}});m(le=>I?[...le,...Z]:Z),_(T),N(me.length===ka)}else I||m([]),N(!1)}catch(me){console.error("Unexpected error fetching activity log:",me),f(me.message||"An unexpected error occurred."),I||m([]),N(!1)}finally{x(!1),k(!1)}},[n]),w=p.useCallback(async T=>{if(!e||!T){A(null),O(!1),B(null);return}O(!0),B(null);try{const{data:I,error:ee}=await H.rpc("get_user_gym_quick_stats",{user_id_in:e.id,gym_id_in:T});if(ee)throw new Error(`Failed to load quick stats: ${ee.message}`);A(I?{sendsThisMonth:I.sendsThisMonth,highestGradeSent:I.highestGradeSent,betaAddedThisMonth:I.betaAddedThisMonth}:{sendsThisMonth:0,highestGradeSent:null,betaAddedThisMonth:0})}catch(I){console.error("Unexpected error fetching quick stats via RPC:",I),B(I.message||"An unexpected error occurred fetching stats."),A(null)}finally{O(!1)}},[e]);p.useEffect(()=>{ne(0),w(n)},[ne,w,n]);const E=()=>{!b&&S&&ne(y+1,!0)},M=T=>{var F,U,W,V,Q,je,q,xe,Le,ft,nt;let I=a.jsx(Bu,{size:18,className:"text-gray-500"}),ee="performed an action.";const ue=T.user_display_name||`User ${T.user_id.substring(0,6)}`,Be=(e==null?void 0:e.id)===T.user_id?a.jsx("span",{className:"font-medium",children:ue}):a.jsxs("button",{onClick:()=>o("publicProfile",{profileUserId:T.user_id}),className:"font-medium hover:underline text-brand-green",children:[" ",ue," "]}),ie=T.route_name||((F=T.details)==null?void 0:F.route_name)||"a route",Z=T.route_grade||((U=T.details)==null?void 0:U.route_grade)||"N/A",le=T.route_grade_color||((W=T.details)==null?void 0:W.route_grade_color),re=T.location_name||((V=T.details)==null?void 0:V.location_name),oe=Nv(le),ce=a.jsxs(a.Fragment,{children:[T.route_id&&T.route_name?a.jsxs("button",{onClick:()=>o("routeDetail",{routeId:T.route_id}),className:`font-medium hover:underline ${oe}`,children:[" ",ie," (",Z,") "]}):a.jsxs("span",{className:`font-medium ${oe}`,children:[" ",ie," (",Z,") "]}),re&&a.jsxs("span",{className:"text-gray-500 text-xs",children:[" at ",re]})]}),Pe=((Q=T.details)==null?void 0:Q.followed_user_name)||"another user",we=(je=T.details)==null?void 0:je.followed_user_id,Te=we===(e==null?void 0:e.id),ye=we?a.jsxs("button",{onClick:()=>o("publicProfile",{profileUserId:we}),className:"font-medium hover:underline text-brand-green",children:[" ",Te?"you":Pe," "]}):a.jsx("span",{className:"font-medium",children:Pe});switch(T.activity_type){case"log_send":I=a.jsx(ts,{size:18,className:"text-green-500"}),ee=a.jsxs(a.Fragment,{children:["sent ",ce,". ",(q=T.details)!=null&&q.attempts?`(${T.details.attempts} attempts)`:""]});break;case"log_attempt":I=a.jsx(Po,{size:18,className:"text-orange-400"}),ee=a.jsxs(a.Fragment,{children:["attempted ",ce,"."]});break;case"add_beta":I=((xe=T.details)==null?void 0:xe.beta_type)==="video"?a.jsx(Qs,{size:18,className:"text-blue-500"}):((Le=T.details)==null?void 0:Le.beta_type)==="drawing"?a.jsx(Kg,{size:18,className:"text-purple-500"}):a.jsx(Bu,{size:18,className:"text-blue-500"}),ee=a.jsxs(a.Fragment,{children:["added ",((ft=T.details)==null?void 0:ft.beta_type)||""," beta for ",ce,"."]});break;case"add_comment":I=a.jsx(Ph,{size:18,className:"text-indigo-500"}),ee=a.jsxs(a.Fragment,{children:["commented on ",ce,': "',((nt=T.details)==null?void 0:nt.comment_snippet)||"...",'"']});break;case"add_route":I=a.jsx(Rh,{size:18,className:"text-brand-green"}),ee=a.jsxs(a.Fragment,{children:["added a new route: ",ce,"."]});break;case"follow_user":I=a.jsx(Ro,{size:18,className:"text-accent-purple"}),ee=a.jsxs(a.Fragment,{children:["started following ",ye,"."]});break}return a.jsxs("div",{className:"bg-white p-3 rounded-lg shadow flex items-start space-x-3",children:[a.jsx("img",{src:Cv(T),alt:ue||"User Avatar",className:"w-10 h-10 rounded-full object-cover flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[" ",a.jsxs("div",{className:"text-sm",children:[Be," ",ee]})," ",a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:Ev(T.created_at)})," "]}),a.jsx("div",{className:"flex-shrink-0 ml-auto mt-1",children:I})]},T.id)},D=()=>$?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):j?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(vn,{size:20,className:"inline mr-1 mb-0.5"})," ",j," "]}):P?a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[" ",a.jsxs("div",{className:"p-3 bg-accent-blue/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-blue",children:P.sendsThisMonth})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Sends This Month"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-purple/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-purple",children:P.highestGradeSent||"N/A"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Highest Grade"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-yellow/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-yellow",children:P.betaAddedThisMonth})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Beta Added (Month)"})," "]})," "]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[" ",a.jsxs("div",{className:"p-3 bg-accent-blue/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-blue",children:"0"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Sends This Month"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-purple/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-purple",children:"N/A"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Highest Grade"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-yellow/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-yellow",children:"0"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Beta Added (Month)"})," "]})," "]}),C=s(n);return a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:[a.jsxs("div",{className:"flex justify-between items-center relative",children:[a.jsxs("button",{onClick:()=>c(!l),className:"flex items-center text-brand-green hover:text-opacity-80",children:[" ",a.jsx("h1",{className:"text-xl font-bold mr-1 truncate max-w-[200px] sm:max-w-xs",children:C})," ",a.jsx($r,{size:20,className:`transition-transform ${l?"rotate-180":""}`})," "]}),l&&a.jsxs("div",{className:"absolute top-full left-0 mt-2 w-60 bg-white rounded-md shadow-lg border z-20 max-h-60 overflow-y-auto",children:[" ",t.length>1&&t.map(T=>a.jsxs("button",{onClick:()=>Y(T),className:`block w-full text-left px-4 py-2 text-sm truncate ${n===T?"bg-accent-blue/10 text-accent-blue font-semibold":"text-brand-gray hover:bg-gray-100"}`,children:[" ",s(T)," "]},T))," ",t.length>1&&a.jsx("hr",{className:"my-1 border-gray-200"})," ",a.jsxs("button",{onClick:X,className:"flex items-center w-full text-left px-4 py-2 text-sm text-accent-blue hover:bg-accent-blue/10",children:[" ",a.jsx(Lh,{size:16,className:"mr-2"})," Choose more gyms... "]})," "]})]}),a.jsxs("div",{className:"relative mt-4",children:[a.jsx("input",{type:"text",value:u,onChange:K,className:"absolute inset-0 opacity-0 pointer-events-none","aria-hidden":"true"}),a.jsxs("button",{onClick:J,className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-gray-100 text-left flex items-center text-gray-500 hover:border-gray-400",children:[" ",a.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})," ",u||`Search routes at ${C}...`," "]})]})]}),a.jsxs("main",{className:"flex-grow p-4 space-y-6 overflow-y-auto pb-20",children:[a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:["Quick Stats (",C,")"]}),D()]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Recent Activity"}),v?a.jsxs("div",{className:"flex justify-center items-center p-6 bg-white rounded-lg shadow",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," ",a.jsx("p",{className:"text-brand-gray",children:"Loading activity..."})," "]}):g?a.jsx("p",{className:"text-center text-red-500 p-6 bg-white rounded-lg shadow",children:g}):h.length>0?a.jsxs("div",{className:"space-y-3",children:[h.map(M),S&&a.jsx("button",{onClick:E,disabled:b,className:"w-full mt-3 text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:b?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6 bg-white rounded-lg shadow",children:"No recent activity in this gym yet."})]})]})]})},Pv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Tv=({route:e,onClick:t})=>{const{name:n,grade:r,grade_color:s,location_name:i,setter:o,date_set:l,status:c,textBetaCount:u,videoBetaCount:d,hasComments:h,hasNotes:m,isOnWishlist:v,averageRating:x,ratingCount:b}=e,k=16,g="gap-1.5",f=i||"Unknown Location";return a.jsxs("div",{onClick:t,className:"bg-white p-4 rounded-lg shadow border border-gray-200 flex items-center gap-4 hover:shadow-md transition-shadow duration-200 cursor-pointer",children:[a.jsx("div",{className:`w-12 h-12 ${Pv(s)} rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0 shadow`,children:r}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsxs("div",{className:"flex flex-row gap-x-2 items-center",children:[" ",a.jsx("h3",{className:"text-lg font-semibold text-brand-gray truncate",children:n}),a.jsx("div",{className:`flex flex-row items-center ${g}`,children:v&&a.jsx(uo,{size:k-2,className:"text-accent-yellow",fill:"currentColor",title:"On Wishlist"})})]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-600 mt-1 gap-x-3 gap-y-1 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Qr,{size:14})," ",f]}),o&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ro,{size:14})," ",o]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nh,{size:14})," ",new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]}),a.jsxs("div",{className:`flex flex-col items-end ${g} flex-shrink-0 ml-auto pl-2`,children:[u||d||b?a.jsxs("div",{className:"flex flex-row h-5 mb-1 gap-x-2",children:[" ",u&&u>0?a.jsxs("span",{className:"flex items-center text-blue-500",title:`${u} Text Beta`,children:[a.jsx(Sc,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:u})]}):null,d&&d>0?a.jsxs("span",{className:"flex items-center text-purple-500",title:`${d} Video Beta`,children:[a.jsx(Qs,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:d})]}):null,b&&b>0?a.jsxs("span",{className:"flex items-center text-yellow-500",title:`Average Rating Available (${b} ratings)`,children:[a.jsx(To,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:x==null?void 0:x.toFixed(1)})]}):null]}):null,a.jsxs("div",{className:`flex flex-row ${g} h-5`,children:[" ",c==="sent"&&a.jsx(ts,{size:k,className:"text-green-500",title:"Sent"}),c==="attempted"&&a.jsx(Po,{size:k,className:"text-orange-400",title:"Attempted"})]})]})]})},id=e=>{if(e&&e.toUpperCase().startsWith("V")){const n=e.substring(1).split("-"),r=parseInt(n[n.length-1],10);return isNaN(r)?-1:r}return-1},Ei=10,Lv=({activeGymId:e,activeGymName:t,onNavigate:n,initialSearchTerm:r,currentUser:s})=>{const[i,o]=p.useState(r||""),[l,c]=p.useState(!1),[u,d]=p.useState([]),[h,m]=p.useState(new Map),[v,x]=p.useState(new Map),[b,k]=p.useState(new Map),[g,f]=p.useState([]),[y,_]=p.useState(!1),[S,N]=p.useState(!1),[P,A]=p.useState(null),[$,O]=p.useState(0),[j,B]=p.useState(!0),[Y,X]=p.useState(""),[K,J]=p.useState(""),[ne,w]=p.useState("all"),[E,M]=p.useState("date_newest"),D=p.useRef(null),[C,T]=p.useState(!1),I=p.useRef(null),ee=p.useRef(!0);p.useEffect(()=>{o(r||""),r||T(!1)},[r]),p.useEffect(()=>{r&&!C&&setTimeout(()=>{D.current&&(D.current.focus(),T(!0))},250)},[r,C]);const ue=p.useCallback(async(Z=0,le=!1,re=i)=>{if(console.log(`[fetchAllRouteData] Called. Page: ${Z}, LoadMore: ${le}, Search: "${re}"`),!e){console.log("[fetchAllRouteData] No active gym ID, resetting state."),d([]),m(new Map),x(new Map),k(new Map),f([]),A(null),_(!1),N(!1),B(!1);return}le?N(!0):(_(!0),d([]),O(0),B(!0),m(new Map),x(new Map),k(new Map)),A(null);const oe=Z*Ei;try{if(Z===0){console.log("[fetchAllRouteData] Fetching locations.");const{data:ye,error:F}=await H.from("locations").select("*").eq("gym_id",e).order("name",{ascending:!0});F?console.error("[RoutesScreen] Error fetching locations:",F.message):f(ye||[])}console.log(`[fetchAllRouteData] Calling RPC 'get_filtered_routes' with: gym=${e}, search=${re||null}, loc=${Y||null}, grade=${K||null}, sort=${E!=="rating_highest"?E:"date_newest"}, page=${Z}, size=${Ei}`);const{data:ce,error:Pe}=await H.rpc("get_filtered_routes",{gym_id_in:e,search_term_in:re||null,location_id_in:Y||null,grade_in:K||null,sort_option_in:E!=="rating_highest"?E:"date_newest",page_size_in:Ei,page_offset_in:oe});if(Pe)throw new Error(`Failed to load routes via RPC: ${Pe.message}`);if(!ce||ce.length===0){console.log("[fetchAllRouteData] No routes found from RPC."),le||d([]),B(!1),_(!1),N(!1);return}const we=ce;console.log(`[fetchAllRouteData] Received ${we.length} routes.`),d(ye=>le?[...ye,...we]:we),O(Z),B(we.length===Ei);const Te=we.map(ye=>ye.id);if(s&&Te.length>0){console.log("[fetchAllRouteData] Fetching user progress for route IDs:",Te);const{data:ye,error:F}=await H.from("user_route_progress").select("*").eq("user_id",s.id).in("route_id",Te);F?console.error("[RoutesScreen] Error fetching user progress:",F.message):ye&&(console.log(`[fetchAllRouteData] Received ${ye.length} progress items.`),m(U=>{const W=new Map(U);return ye.forEach(V=>W.set(V.route_id,V)),W}))}if(Te.length>0){console.log("[fetchAllRouteData] Fetching route card stats for route IDs:",Te);const{data:ye,error:F}=await H.rpc("get_route_card_stats",{route_ids:Te});F?console.error("[RoutesScreen] Error fetching route card stats via RPC:",F.message):ye&&(console.log(`[fetchAllRouteData] Received ${ye.length} stats items.`),x(U=>{const W=new Map(U);return ye.forEach(V=>{W.set(V.route_id,{textBetaCount:Number(V.text_beta_count),videoBetaCount:Number(V.video_beta_count),averageRating:V.average_rating,ratingCount:Number(V.rating_count)})}),W}))}if(Te.length>0){console.log("[fetchAllRouteData] Fetching comment counts for route IDs:",Te);const{data:ye,error:F}=await H.rpc("get_route_comment_counts",{route_ids:Te});F?console.error("[RoutesScreen] Error fetching comment counts via RPC:",F.message):ye&&(console.log(`[fetchAllRouteData] Received ${ye.length} comment count items.`),k(U=>{const W=new Map(U);return ye.forEach(V=>W.set(V.route_id,V.count)),W}))}}catch(ce){console.error("[RoutesScreen] Unexpected error fetching route data:",ce),A(ce.message||"An unexpected error occurred."),le||(d([]),m(new Map),x(new Map),k(new Map),f([])),B(!1)}finally{_(!1),N(!1),console.log("[fetchAllRouteData] Fetch finished.")}},[e,s,Y,K,E]);p.useEffect(()=>{console.log("[Effect 1: Initial Load] Running on mount."),ue(0,!1,r||"");const Z=setTimeout(()=>{ee.current=!1,console.log("[Effect 1: Initial Load] isInitialMount set to false.")},0);return()=>clearTimeout(Z)},[r]),p.useEffect(()=>{if(ee.current){console.log("[Effect 2: Filter/Sort Update] Skipping initial mount run.");return}console.log("[Effect 2: Filter/Sort Update] Filters/Sort/Gym/User changed, fetching page 0."),ue(0,!1,i)},[e,s,Y,K,E]),p.useEffect(()=>{if(ee.current&&r){console.log("[Effect 3: Debounce] Skipping initial mount run (initialSearchTerm present).");return}if(ee.current){console.log("[Effect 3: Debounce] Skipping initial mount run.");return}return console.log(`[Effect 3: Debounce] Search term changed to: "${i}"`),I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{console.log(`[Effect 3: Debounce] Debounce triggered for search: "${i}"`),ue(0,!1,i)},300),()=>{I.current&&clearTimeout(I.current)}},[i,r]);const me=()=>{!S&&j&&(console.log("[handleShowMore] Fetching next page:",$+1),ue($+1,!0,i))},Be=p.useMemo(()=>{const Z=new Set(u.map(le=>le.grade).filter(Boolean));return Array.from(Z).sort((le,re)=>{const oe=id(le),ce=id(re);return oe!==-1&&ce!==-1?oe-ce:le.localeCompare(re)})},[u]),ie=p.useMemo(()=>{let le=u.map(re=>{const oe=h.get(re.id),ce=v.get(re.id)||{textBetaCount:0,videoBetaCount:0,averageRating:null,ratingCount:0},Pe=b.get(re.id)||0;let we="unseen";return oe!=null&&oe.sent_at?we="sent":oe!=null&&oe.attempts&&oe.attempts>0&&(we="attempted"),{...re,status:we,textBetaCount:ce.textBetaCount,videoBetaCount:ce.videoBetaCount,averageRating:ce.averageRating,ratingCount:ce.ratingCount,hasComments:Pe>0,hasNotes:!!(oe!=null&&oe.notes)&&oe.notes.trim().length>0,isOnWishlist:!!(oe!=null&&oe.wishlist)}});return ne!=="all"&&(le=le.filter(re=>ne==="wishlist"?re.isOnWishlist:re.status===ne)),E==="rating_highest"?[...le].sort((re,oe)=>{const ce=re.averageRating??-1;return(oe.averageRating??-1)-ce}):le},[u,h,v,b,ne,E]);return!e&&!y&&u.length===0?a.jsx("div",{className:"p-4 pt-16 text-center text-brand-gray",children:"Please select a gym first."}):a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:[a.jsxs("h1",{className:"text-xl font-bold text-center text-brand-green mb-4",children:[t," - Routes"]}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx("input",{ref:D,type:"text",placeholder:"Search routes by name, grade, location...",value:i,onChange:Z=>o(Z.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-gray-100"}),a.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsxs("button",{onClick:()=>c(!l),className:"p-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-100 text-brand-gray","aria-label":"Filters",children:[" ",a.jsx(Xg,{size:20})," "]})]})]}),l&&a.jsxs("div",{className:"bg-white p-4 border-b border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-sm font-semibold mb-2 text-brand-gray",children:"Filter & Sort"}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:Y,onChange:Z=>X(Z.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"",children:"All Locations"}),g.map(Z=>a.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),a.jsx($r,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:K,onChange:Z=>J(Z.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"",children:"All Grades"}),Be.map(Z=>a.jsx("option",{value:Z,children:Z},Z))]}),a.jsx($r,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:ne,onChange:Z=>w(Z.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"sent",children:"Sent"}),a.jsx("option",{value:"attempted",children:"Attempted"}),a.jsx("option",{value:"unseen",children:"Unseen"}),a.jsx("option",{value:"wishlist",children:"Wishlist"})]}),a.jsx($r,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:E,onChange:Z=>M(Z.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"date_newest",children:"Sort: Newest"}),a.jsx("option",{value:"grade_hardest",children:"Sort: Grade (Hardest)"}),a.jsx("option",{value:"grade_easiest",children:"Sort: Grade (Easiest)"}),a.jsx("option",{value:"rating_highest",children:"Sort: Avg Rating"})]}),a.jsx($r,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]})]}),a.jsx("main",{className:"flex-grow p-4 space-y-3 overflow-y-auto pb-20",children:y&&u.length===0?a.jsxs("div",{className:"flex justify-center items-center pt-10",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," ",a.jsx("p",{className:"text-brand-gray",children:"Loading routes..."})," "]}):P?a.jsx("p",{className:"text-center text-red-500 mt-8",children:P}):ie.length>0?a.jsxs(a.Fragment,{children:[ie.map(Z=>a.jsx(Tv,{route:Z,onClick:()=>n("routeDetail",{routeId:Z.id})},Z.id)),j&&a.jsx("button",{onClick:me,disabled:S,className:"w-full mt-3 text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:S?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Routes"})]}):a.jsx("p",{className:"text-center text-gray-500 mt-8",children:i||Y||K||ne!=="all"?"No routes found matching your criteria.":"No active routes found for this gym yet."})})]})},wr={attempts:0,sentDate:null,rating:null,notes:"",wishlist:!1},Sa=5,ja=2,Rv="route-beta",Av=300,$v=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},od=(e,t,n)=>{var r;return n!=null&&n.display_name?n.display_name:t&&e===t.id?((r=t.user_metadata)==null?void 0:r.display_name)||"You":`User ${e.substring(0,6)}...`},ad=(e,t)=>{const n=t?`User ${t.substring(0,6)}`:"User",r=`https://ui-avatars.com/api/?name=${encodeURIComponent((e==null?void 0:e.display_name)||n)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||r},Ov=e=>{if(!e)return null;switch(e){case"start":return"Start Moves";case"crux":return"Crux Sequence";case"middle":return"Middle Section";case"topout":return"Top Out / Finish";default:return null}},zv=({currentUser:e,route:t,isLoading:n,error:r,onBack:s,onNavigate:i})=>{const[o,l]=p.useState(wr),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[m,v]=p.useState(null),[x,b]=p.useState([]),[k,g]=p.useState(!1),[f,y]=p.useState(!1),[_,S]=p.useState(null),[N,P]=p.useState("text"),[A,$]=p.useState(0),[O,j]=p.useState(!0),[B,Y]=p.useState([]),[X,K]=p.useState(!1),[J,ne]=p.useState(!1),[w,E]=p.useState(!1),[M,D]=p.useState(null),[C,T]=p.useState(""),[I,ee]=p.useState(0),[ue,me]=p.useState(!0),[Be,ie]=p.useState({}),[Z,le]=p.useState({}),re=p.useCallback(async()=>{if(!e||!t){l(wr);return}u(!0),v(null);try{const{data:L,error:te}=await H.from("user_route_progress").select("attempts, sent_at, rating, notes, wishlist").eq("user_id",e.id).eq("route_id",t.id).maybeSingle();te?(v("Failed to load your progress."),l(wr)):l(L?{attempts:L.attempts??0,sentDate:L.sent_at,rating:L.rating,notes:L.notes??"",wishlist:L.wishlist??!1}:wr)}catch{v("An unexpected error occurred."),l(wr)}finally{u(!1)}},[e,t]);p.useEffect(()=>{t&&e&&!n?re():(l(wr),u(!1),v(null))},[t,e,n,re]);const oe=p.useCallback(async L=>{if(!e||!t){v("Cannot save progress: User or Route missing.");return}if(t.removed_at){v("Cannot save progress: This route has been removed.");return}h(!0),v(null);const te={user_id:e.id,route_id:t.id,attempts:L.attempts??o.attempts,sent_at:L.sent_at!==void 0?L.sent_at:o.sentDate,rating:L.rating!==void 0?L.rating:o.rating,notes:L.notes??o.notes,wishlist:L.wishlist??o.wishlist};try{const{error:ve}=await H.from("user_route_progress").upsert(te,{onConflict:"user_id, route_id"});ve&&(v(`Failed to save progress: ${ve.message}`),await re())}catch{v("An unexpected error occurred."),await re()}finally{h(!1)}},[e,t,o,re]),ce=p.useCallback(async(L=0,te=!1)=>{if(!t){Y([]),K(!1),ne(!1),D(null),me(!1);return}te?ne(!0):(K(!0),Y([]),ee(0),me(!0)),D(null);const ve=L*Sa,De=ve+Sa-1;try{const{data:Ne,error:Ie,count:bt}=await H.from("route_comments").select("*, profile:profiles!user_id ( display_name, avatar_url )",{count:"exact"}).eq("route_id",t.id).order("created_at",{ascending:!0}).range(ve,De);if(Ie)D("Failed to load comments."),te||Y([]),me(!1);else if(Ne){const Tt=Ne.map(on=>{var hr,pr;return{...on,display_name:((hr=on.profile)==null?void 0:hr.display_name)||void 0,avatar_url:((pr=on.profile)==null?void 0:pr.avatar_url)||void 0}});Y(on=>te?[...on,...Tt]:Tt),ee(L),me(Ne.length===Sa)}else te||Y([]),me(!1)}catch{D("An unexpected error occurred."),te||Y([]),me(!1)}finally{K(!1),ne(!1)}},[t]);p.useEffect(()=>{t&&!n?ce(0):(Y([]),K(!1),D(null),me(!1))},[t,n,ce]);const Pe=p.useCallback(async(L=0,te=!1,ve)=>{if(!t){b([]),g(!1),y(!1),S(null),j(!1);return}te?y(!0):(g(!0),b([]),$(0),j(!0)),S(null);const De=L*ja,Ne=De+ja-1;try{const{data:Ie,error:bt}=await H.from("route_beta").select("*, profile:profiles ( display_name, avatar_url )").eq("route_id",t.id).eq("beta_type",ve).order("created_at",{ascending:!1}).range(De,Ne);if(bt)S(`Failed to load ${ve} beta.`),te||b([]),j(!1);else if(Ie){const Tt=Ie.map(Re=>{var qn,wn;return{...Re,display_name:((qn=Re.profile)==null?void 0:qn.display_name)||void 0,avatar_url:((wn=Re.profile)==null?void 0:wn.avatar_url)||void 0,signedUrl:void 0}}),on=Tt.filter(Re=>Re.beta_type==="video"&&Re.content_url).map(async Re=>{var qn;try{console.log("beta content url",Re.content_url);const wn=(qn=Re.content_url)==null?void 0:qn.split("/route-beta/")[1],{data:Vo,error:mr}=await H.storage.from(Rv).createSignedUrl(wn,Av);return mr?(console.error(`Error generating signed URL for ${Re.content_url}:`,mr),{id:Re.id,signedUrl:null}):{id:Re.id,signedUrl:Vo.signedUrl}}catch(wn){return console.error(`Unexpected error generating signed URL for ${Re.content_url}:`,wn),{id:Re.id,signedUrl:null}}}),hr=await Promise.all(on),pr=new Map(hr.map(Re=>[Re.id,Re.signedUrl])),an=Tt.map(Re=>({...Re,signedUrl:pr.get(Re.id)||void 0}));b(Re=>te?[...Re,...an]:an),$(L),j(Ie.length===ja),(te&&e&&an.length>0||!te&&e&&an.length>0)&&we(an)}else te||b([]),j(!1)}catch{S(`An unexpected error occurred while loading ${ve} beta.`),te||b([]),j(!1)}finally{g(!1),y(!1)}},[t,e]),we=p.useCallback(async L=>{if(!e||L.length===0)return;const te=L.map(ve=>ve.id);try{const{data:ve,error:De}=await H.from("route_beta_votes").select("beta_id, vote_value").eq("user_id",e.id).in("beta_id",te);De?console.error("[fetchUserVotes] Error fetching user votes:",De):ve&&ie(Ne=>{const Ie={...Ne};return ve.forEach(bt=>{Ie[bt.beta_id]=bt.vote_value}),Ie})}catch(ve){console.error("[fetchUserVotes] Unexpected error fetching user votes:",ve)}},[e]);p.useEffect(()=>{t&&!n?Pe(0,!1,N):(b([]),g(!1),y(!1),S(null),j(!1),ie({}))},[t,n,N,Pe]);const Te=async(L,te)=>{if(!e||t!=null&&t.removed_at)return;let De=Be[L]===te?0:te;le(Ne=>({...Ne,[L]:!0}));try{const{data:Ne,error:Ie}=await H.rpc("handle_beta_vote",{beta_id_in:L,vote_value_in:De});Ie?(console.error("[handleVote] Error calling handle_beta_vote RPC:",Ie),alert(`Error submitting vote: ${Ie.message}`)):(ie(bt=>({...bt,[L]:De})),b(bt=>bt.map(Tt=>Tt.id===L?{...Tt,upvotes:Ne??Tt.upvotes}:Tt)))}catch(Ne){console.error("[handleVote] Unexpected error handling vote:",Ne),alert("An unexpected error occurred while voting.")}finally{le(Ne=>({...Ne,[L]:!1}))}},ye=()=>{if(t!=null&&t.removed_at)return;const L=o.attempts+1;l(te=>({...te,attempts:L})),oe({attempts:L})},F=async(L,te)=>{if(o.sentDate||!te||!L||te.removed_at)return;const ve=new Date().toISOString(),De=o.attempts<1?1:o.attempts;l(bt=>({...bt,sentDate:ve,attempts:De})),oe({sent_at:ve,attempts:De});const Ne={route_name:te.name,route_grade:te.grade,attempts:De,location_name:te.location_name},{error:Ie}=await H.from("activity_log").insert({user_id:L.id,gym_id:te.gym_id,route_id:te.id,activity_type:"log_send",details:Ne});Ie&&console.error("Error logging add_send activity:",Ie)},U=L=>{if(t!=null&&t.removed_at)return;const te=o.rating===L?null:L;l(ve=>({...ve,rating:te})),oe({rating:te})},W=()=>{if(t!=null&&t.removed_at)return;const L=!o.wishlist;l(te=>({...te,wishlist:L})),oe({wishlist:L})},V=L=>{t!=null&&t.removed_at||l(te=>({...te,notes:L.target.value}))},Q=()=>{t!=null&&t.removed_at||oe({notes:o.notes})},je=async L=>{if(L.preventDefault(),!e||!t||!C.trim()||t.removed_at)return;E(!0),D(null);const te=C.trim();try{const{data:ve,error:De}=await H.from("route_comments").insert({route_id:t.id,user_id:e.id,comment_text:te}).select().single();if(De)D(`Failed to post comment: ${De.message}`);else if(ve){const Ne={route_name:t.name,route_grade:t.grade,comment_snippet:te.substring(0,50)+(te.length>50?"...":""),location_name:t.location_name},{error:Ie}=await H.from("activity_log").insert({user_id:e.id,gym_id:t.gym_id,route_id:t.id,activity_type:"add_comment",details:Ne});Ie&&console.error("Error logging add_comment activity:",Ie),T(""),await ce(0)}}catch{D("An unexpected error occurred.")}finally{E(!1)}},q=L=>{L===(e==null?void 0:e.id)?i("profile"):i("publicProfile",{profileUserId:L})},xe=()=>{!J&&ue&&ce(I+1,!0)},Le=()=>{!f&&O&&Pe(A+1,!0,N)},ft=L=>{P(L)};if(n)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue",size:48})," "]});if(r||!t)return a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4 text-center",children:[" ",a.jsx(vn,{size:48,className:"text-red-500 mb-4"})," ",a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Route"})," ",a.jsx("p",{className:"text-red-600 mb-6",children:r||"The requested route could not be found."})," ",a.jsxs("button",{onClick:s,className:"bg-accent-blue text-white px-4 py-2 rounded-md hover:bg-opacity-90 flex items-center gap-2",children:[" ",a.jsx(lr,{size:18})," Go Back "]})," "]});const{id:nt,name:wt,grade:Yt,grade_color:Xe,location_name:Ft,setter:Ut,date_set:be,description:Ve,image_url:ss,removed_at:fr}=t,is=Ft||"Unknown Location",_t=!!fr;return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsxs("button",{onClick:s,className:"mr-4 text-brand-gray hover:text-brand-green",children:[" ",a.jsx(lr,{size:24})," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("h1",{className:"text-xl font-bold text-brand-green truncate",children:wt}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 gap-x-3 flex-wrap",children:[a.jsx("span",{className:`font-semibold px-1.5 py-0.5 rounded text-white text-xs ${$v(Xe)}`,children:Yt}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Qr,{size:14})," ",is]})]})]}),a.jsx("button",{onClick:W,disabled:d||c||_t,className:`ml-4 p-1 rounded disabled:opacity-50 ${o.wishlist?"text-accent-yellow":"text-gray-400 hover:text-accent-yellow/80"}`,children:d&&o.wishlist!==void 0?a.jsx(ae,{size:24,className:"animate-spin"}):a.jsx(uo,{size:24,fill:o.wishlist?"currentColor":"none"})})]}),a.jsxs("main",{className:"p-4 space-y-6",children:[_t&&a.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow flex items-center gap-3",role:"alert",children:[a.jsx(zg,{size:20,className:"flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"Route Removed"}),a.jsxs("p",{className:"text-sm",children:["This route was removed on ",new Date(fr).toLocaleDateString()," and is no longer on the wall. Progress logging and commenting are disabled."]})]})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[ss?a.jsx("img",{src:ss,alt:`Photo of ${wt}`,className:"w-full h-48 object-cover"}):a.jsxs("div",{className:"w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center text-brand-gray",children:[" ",a.jsx(Qr,{size:48})," "]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2 gap-x-4 gap-y-1 flex-wrap",children:[Ut&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ro,{size:14})," Set by ",Ut]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nh,{size:14})," Set on ",new Date(be).toLocaleDateString()]})]}),Ve&&a.jsx("p",{className:"text-sm text-brand-gray",children:Ve})]})]}),a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow relative",children:[(c||d)&&a.jsxs("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-10 rounded-lg",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue",size:24})," ",a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:c?"Loading Progress...":"Saving..."})," "]}),a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Your Progress"}),m&&a.jsx("p",{className:"text-red-500 text-sm mb-3 text-center",children:m}),a.jsxs("fieldset",{disabled:c||d||_t,className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[" ",a.jsxs("button",{onClick:ye,className:"flex-1 bg-orange-100 text-orange-600 hover:bg-orange-200 font-medium py-2 px-3 rounded text-sm text-center disabled:opacity-50 disabled:cursor-not-allowed",children:["Log Attempt (",o.attempts,")"]})," ",a.jsxs("button",{onClick:()=>F(e,t),disabled:!!o.sentDate||_t,className:`flex-1 font-medium py-2 px-3 rounded text-sm text-center ${o.sentDate?"bg-green-200 text-green-700 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"} disabled:opacity-50 disabled:cursor-not-allowed`,children:[" ",o.sentDate?`Sent ${new Date(o.sentDate).toLocaleDateString()}`:"Log Send"," "]})," "]}),a.jsxs("div",{children:[" ",a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-1",children:"Your Rating"})," ",a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(L=>a.jsx("button",{onClick:()=>U(L),children:a.jsx(To,{size:24,className:L<=(o.rating||0)?"text-accent-yellow":"text-gray-300",fill:L<=(o.rating||0)?"currentColor":"none"})},L))})," "]}),a.jsxs("div",{children:[" ",a.jsx("label",{htmlFor:"personalNotes",className:"block text-sm font-medium text-brand-gray mb-1",children:"Private Notes"})," ",a.jsx("textarea",{id:"personalNotes",rows:3,value:o.notes,onChange:V,onBlur:Q,placeholder:"Add your personal beta, reminders, etc.",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})," "]})]})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[" ",a.jsx("h2",{className:"text-lg font-semibold text-brand-gray",children:"Community Beta"})," ",a.jsxs("button",{onClick:()=>i("addBeta",{routeId:nt}),disabled:_t,className:"bg-accent-blue text-white text-xs font-semibold px-3 py-1 rounded-full hover:bg-opacity-90 flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[" ",a.jsx(Lh,{size:14})," Add Beta "]})," "]}),a.jsxs("div",{className:"flex border-b",children:[a.jsxs("button",{onClick:()=>ft("text"),className:`flex-1 py-2 text-center text-sm font-medium ${N==="text"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Sc,{size:16,className:"inline mr-1 mb-0.5"})," Tips"]}),a.jsxs("button",{onClick:()=>ft("video"),className:`flex-1 py-2 text-center text-sm font-medium ${N==="video"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Qs,{size:16,className:"inline mr-1 mb-0.5"})," Videos"]})]}),a.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[" ",k&&x.length===0?a.jsx("div",{className:"flex justify-center items-center py-4",children:a.jsx(ae,{className:"animate-spin text-accent-blue",size:24})}):_?a.jsx("p",{className:"text-red-500 text-sm text-center py-4",children:_}):a.jsxs(a.Fragment,{children:[x.length>0?x.map(L=>{const te=Be[L.id],ve=Z[L.id],De=L.user_id===(e==null?void 0:e.id),Ne=Ov(L.key_move);return a.jsxs("div",{className:"flex gap-3 border-b pb-3 last:border-b-0",children:[a.jsx("img",{src:ad(L,L.user_id),alt:"User avatar",className:"w-8 h-8 rounded-full flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("button",{onClick:()=>q(L.user_id),disabled:De,className:`text-sm font-medium text-brand-gray ${De?"cursor-default":"hover:underline hover:text-accent-blue cursor-pointer"}`,children:[" ",od(L.user_id,e,L)," "]}),L.beta_type==="text"&&a.jsx("p",{className:"text-sm text-gray-700 mt-1",children:L.text_content}),L.beta_type==="video"&&L.signedUrl&&a.jsxs("a",{href:L.signedUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline mt-1 block",children:["Watch Video ",a.jsx(Qs,{size:14,className:"inline ml-1"})]}),L.beta_type==="video"&&!L.signedUrl&&L.content_url&&a.jsx("span",{className:"text-sm text-red-500 mt-1 block",children:"Could not load video link."}),a.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mt-2 flex-wrap",children:[" ",a.jsx("span",{children:new Date(L.created_at).toLocaleDateString()}),Ne&&a.jsxs("span",{className:"flex items-center gap-1 bg-gray-200 text-brand-gray px-1.5 py-0.5 rounded",children:[a.jsx(Hg,{size:12})," ",Ne]}),a.jsxs("button",{onClick:()=>Te(L.id,1),disabled:!e||ve||_t,className:`flex items-center gap-1 hover:text-green-600 disabled:opacity-50 ${te===1?"text-green-600 font-semibold":"text-gray-500"}`,children:[" ",ve&&te!==-1?a.jsx(ae,{size:14,className:"animate-spin"}):a.jsx(ey,{size:14})," ",L.upvotes," "]})]})]})]},L.id)}):a.jsxs("p",{className:"text-sm text-center text-gray-500 py-4",children:["No ",N," beta available yet."]}),O&&a.jsx("button",{onClick:Le,disabled:f,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Beta"})]})]})]}),a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Discussion"}),X&&B.length===0?a.jsx("div",{className:"flex justify-center items-center py-4",children:a.jsx(ae,{className:"animate-spin text-accent-blue",size:24})}):M?a.jsx("p",{className:"text-red-500 text-sm text-center py-4",children:M}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:[" ",B.length>0?B.map(L=>{const te=L.user_id===(e==null?void 0:e.id);return a.jsxs("div",{className:"flex gap-3 border-b pb-3 last:border-b-0",children:[a.jsx("img",{src:ad(L,L.user_id),alt:"User avatar",className:"w-8 h-8 rounded-full flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"text-sm",children:[a.jsxs("button",{onClick:()=>q(L.user_id),disabled:te,className:`font-medium text-brand-gray ${te?"cursor-default":"hover:underline hover:text-accent-blue cursor-pointer"}`,children:[" ",od(L.user_id,e,L)," "]}),a.jsx("span",{className:"text-xs text-gray-400 ml-1",children:new Date(L.created_at).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})})]}),a.jsx("p",{className:"text-sm text-gray-700 mt-1",children:L.comment_text})]})]},L.id)}):a.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No comments yet. Start the discussion!"})]}),ue&&a.jsx("button",{onClick:xe,disabled:J,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:J?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Comments"})]}),a.jsxs("form",{onSubmit:je,className:"flex gap-2 items-center pt-4 border-t mt-4",children:[a.jsx("input",{type:"text",value:C,onChange:L=>T(L.target.value),placeholder:e?_t?"Commenting disabled for removed routes":"Add a comment...":"Log in to comment",className:"flex-grow p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",disabled:!e||w||_t}),a.jsxs("button",{type:"submit",className:"bg-accent-blue text-white p-2 rounded-md hover:bg-opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e||!C.trim()||w||_t,children:[" ",w?a.jsx(ae,{size:20,className:"animate-spin"}):a.jsx(jc,{size:20})," "]})]})]})]})]})},Mv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},ld="route-beta",Dv=({currentUser:e,route:t,onBack:n,onSubmitSuccess:r})=>{const{name:s,grade:i,grade_color:o,id:l,gym_id:c}=t,[u,d]=p.useState("text"),[h,m]=p.useState(""),[v,x]=p.useState(null),[b,k]=p.useState(""),[g,f]=p.useState(!1),[y,_]=p.useState(null),S=$=>{if($.target.files&&$.target.files[0]){const O=$.target.files[0];if(u==="video"&&!["video/mp4","video/quicktime","video/webm"].includes(O.type)){_("Invalid file type. Please select a video file."),x(null),$.target.value="";return}if(O.size>50*1024*1024){_("File size exceeds 50MB limit."),x(null),$.target.value="";return}_(null),x(O)}else x(null)},N=async $=>{if(!e)return;const{error:O}=await H.from("activity_log").insert({user_id:e.id,gym_id:c,route_id:l,activity_type:"add_beta",details:$});O?console.error("Error logging add_beta activity:",O):console.log("add_beta activity logged successfully.")},P=async $=>{if($.preventDefault(),!e){_("You must be logged in to submit beta.");return}if(f(!0),_(null),u==="text"&&!h.trim()){_("Please enter some text for the tip."),f(!1);return}if(u==="video"&&!v){_("Please select a video file to upload."),f(!1);return}try{let O={route_id:l,user_id:e.id,beta_type:u,key_move:b||null},j=null;if(u==="video"&&v){const X=v.name.split(".").pop(),K=`${e.id}/${l}/${Date.now()}_${v.name.replace(/[^a-zA-Z0-9.]/g,"_")}.${X}`,{error:J}=await H.storage.from(ld).upload(K,v);if(J)throw new Error(`Failed to upload video: ${J.message}`);const{data:ne}=H.storage.from(ld).getPublicUrl(K);if(!(ne!=null&&ne.publicUrl))throw new Error("Failed to get public URL for the uploaded video.");j=ne.publicUrl,O.content_url=j,O.text_content=null}else u==="text"&&(O.text_content=h.trim(),O.content_url=null);const{error:B}=await H.from("route_beta").insert(O);if(B)throw new Error(`Failed to save beta information: ${B.message}`);await N({route_name:s,route_grade:i,beta_type:u}),console.log("Beta submitted successfully!"),r()}catch(O){console.error("Error during beta submission:",O),_(O.message||"An unexpected error occurred during submission.")}finally{f(!1)}},A=()=>{switch(u){case"text":return a.jsx("textarea",{rows:6,value:h,onChange:$=>m($.target.value),placeholder:"Share your beta, sequence tips, or insights...",className:"w-full p-3 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue",required:!0});case"video":return a.jsxs("div",{className:`w-full p-4 border-2 border-dashed rounded-lg text-center cursor-pointer ${y&&!v?"border-red-500 bg-red-50":"border-gray-300 bg-gray-50 hover:border-accent-blue"}`,children:[a.jsx("input",{type:"file",id:"fileUpload",accept:"video/*",onChange:S,className:"hidden",required:!v}),a.jsxs("label",{htmlFor:"fileUpload",className:"cursor-pointer",children:[a.jsx(ny,{size:40,className:"mx-auto text-gray-400 mb-2"}),v?a.jsxs("div",{children:[" ",a.jsx("p",{className:"text-sm font-medium text-brand-gray",children:v.name})," ",a.jsxs("p",{className:"text-xs text-gray-500",children:[(v.size/1024/1024).toFixed(2)," MB"]})," ",a.jsx("span",{className:"text-accent-blue text-sm underline mt-1 block",children:"Change file"})," "]}):a.jsxs("p",{className:"text-sm text-brand-gray",children:[" Click to upload a video ",a.jsx("span",{className:"text-accent-blue font-medium",children:"(Max 50MB)"})," "]})]})]});default:return null}};return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsxs("button",{onClick:n,className:"mr-4 text-brand-gray hover:text-brand-green",children:[" ",a.jsx(lr,{size:24})," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("h1",{className:"text-xl font-bold text-brand-green truncate",children:"Add Beta For:"}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 gap-x-2",children:[" ",a.jsx("span",{className:`font-semibold px-1.5 py-0.5 rounded text-white text-xs ${Mv(o)}`,children:i})," ",a.jsx("span",{className:"truncate",children:s})," "]})]})]}),a.jsxs("form",{onSubmit:P,className:"p-4 space-y-5",children:[a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:"Beta Type"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:["text","video"].map($=>{const O=$==="text"?Sc:Qs,j=$.charAt(0).toUpperCase()+$.slice(1);return a.jsxs("button",{type:"button",onClick:()=>{d($),x(null),m(""),_(null)},className:`flex flex-col items-center justify-center p-3 border rounded-lg transition-colors ${u===$?"bg-accent-blue/10 border-accent-blue text-accent-blue ring-1 ring-accent-blue":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(O,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs font-medium",children:j})]},$)})})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:u==="text"?"Your Tip":"Upload Video"}),A()]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"keyMove",className:"block text-sm font-medium text-brand-gray mb-1",children:"Applies To (Optional)"}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{id:"keyMove",value:b,onChange:$=>k($.target.value),className:"w-full appearance-none bg-white border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue pr-8",children:[a.jsx("option",{value:"",children:"General / Whole Route"}),a.jsx("option",{value:"start",children:"Start Moves"}),a.jsx("option",{value:"crux",children:"Crux Sequence"}),a.jsx("option",{value:"middle",children:"Middle Section"}),a.jsx("option",{value:"topout",children:"Top Out / Finish"})]}),a.jsx("svg",{className:"w-4 h-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),y&&a.jsx("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded border border-red-300",children:y}),a.jsx("button",{type:"submit",disabled:g||!e,className:"w-full bg-brand-green hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"})," Submitting... "]}):"Submit Beta"}),!e&&a.jsx("p",{className:"text-xs text-center text-red-600 mt-2",children:"You must be logged in to submit beta."})]})]})},Iv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Fv=({currentUser:e,activeGymId:t,availableRoutes:n,onBack:r,onSubmitSuccess:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState("send"),[u,d]=p.useState(1),[h,m]=p.useState(new Date().toISOString().split("T")[0]),[v,x]=p.useState(null),[b,k]=p.useState(""),[g,f]=p.useState(!1),[y,_]=p.useState(null),[S,N]=p.useState(""),[P,A]=p.useState(!1),[$,O]=p.useState(null),[j,B]=p.useState(!1),[Y,X]=p.useState(null),K=p.useMemo(()=>n.filter(C=>!C.removed_at),[n]),J=p.useMemo(()=>K.find(C=>C.id===i),[i,K]),ne=p.useMemo(()=>S?K.filter(C=>{var T,I,ee;return(((T=C.name)==null?void 0:T.toLowerCase())||"").includes(S.toLowerCase())||(((I=C.grade)==null?void 0:I.toLowerCase())||"").includes(S.toLowerCase())||(((ee=C.location_name)==null?void 0:ee.toLowerCase())||"").includes(S.toLowerCase())}):K,[S,K]),w=p.useCallback(async C=>{if(!e||!C){O(null),B(!1),X(null);return}B(!0),X(null);try{const{data:T,error:I}=await H.from("user_route_progress").select("attempts, sent_at, rating, notes, wishlist").eq("user_id",e.id).eq("route_id",C).maybeSingle();if(I)throw new Error(`Failed to fetch existing progress: ${I.message}`);O(T)}catch(T){console.error("Error fetching existing progress:",T),X(T.message||"Could not load existing progress."),O(null)}finally{B(!1)}},[e]);p.useEffect(()=>{$?(d($.attempts??1),x($.rating??null),k($.notes??""),$.sent_at?(c("send"),m(new Date($.sent_at).toISOString().split("T")[0])):(c("send"),m(new Date().toISOString().split("T")[0]))):(c("send"),d(1),m(new Date().toISOString().split("T")[0]),x(null),k(""))},[$]);const E=C=>{o(C);const T=K.find(I=>I.id===C);N(T?`${T.name} (${T.grade})`:""),A(!1),w(C)},M=p.useCallback(async(C,T,I)=>{if(!e)return;const{error:ee}=await H.from("activity_log").insert({user_id:e.id,gym_id:T.gym_id,route_id:T.id,activity_type:C,details:I});ee?console.error(`Error logging ${C} activity:`,ee):console.log(`${C} activity logged successfully.`)},[e]),D=async C=>{if(C.preventDefault(),_(null),!e){_("You must be logged in to log climbs.");return}if(!i||!J){_("Please select a route.");return}if(J.removed_at){_("This route has been removed and cannot be logged.");return}f(!0);try{let T=!1,I=1;const ee=$??(await H.from("user_route_progress").select("attempts, sent_at, wishlist").eq("user_id",e.id).eq("route_id",i).maybeSingle()).data,ue=(ee==null?void 0:ee.attempts)??0,me=!!(ee!=null&&ee.sent_at),Be=(ee==null?void 0:ee.wishlist)??!1;let ie={user_id:e.id,route_id:i,rating:v,notes:b.trim()||null,wishlist:Be};l==="send"?(I=Math.max(1,u),ie={...ie,attempts:I,sent_at:new Date(h).toISOString()}):(I=ue+1,ie={...ie,attempts:I,...me&&{sent_at:ee.sent_at}});const{error:Z}=await H.from("user_route_progress").upsert(ie,{onConflict:"user_id, route_id"});if(Z)throw new Error(`Failed to save log: ${Z.message}`);if(T=!0,T){const le={route_name:J.name,route_grade:J.grade,route_grade_color:J.grade_color,location_name:J.location_name,...l==="send"&&{attempts:I}};await M(l==="send"?"log_send":"log_attempt",J,le),console.log("Log submitted successfully!"),s()}}catch(T){console.error("Error during log submission:",T),_(T.message||"An unexpected error occurred.")}finally{f(!1)}};return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-10",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsx("button",{onClick:r,className:"mr-4 text-brand-gray hover:text-brand-green",children:a.jsx(lr,{size:24})}),a.jsx("h1",{className:"text-xl font-bold text-brand-green",children:"Log Climb"})]}),a.jsxs("form",{onSubmit:D,className:"p-4 space-y-5",children:[a.jsxs("section",{children:[a.jsx("label",{htmlFor:"routeSearch",className:"block text-sm font-medium text-brand-gray mb-1",children:"Route"}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md bg-white",children:[a.jsx(ni,{size:18,className:"text-gray-400 mx-2 flex-shrink-0"}),a.jsx("input",{type:"text",id:"routeSearch",placeholder:"Search or select active route...",value:S,onChange:C=>{N(C.target.value),A(!0),i&&(o(""),O(null),c("send"),d(1),m(new Date().toISOString().split("T")[0]),x(null),k(""))},onFocus:()=>A(!0),onBlur:()=>setTimeout(()=>A(!1),150),className:"w-full py-2 pr-8 border-none focus:ring-0 text-sm",autoComplete:"off"}),a.jsx($r,{size:16,className:`absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 transition-transform ${P?"rotate-180":""}`})]}),P&&a.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 max-h-48 overflow-y-auto bg-white border border-gray-300 rounded-md shadow-lg z-20",children:ne.length>0?ne.map(C=>a.jsxs("button",{type:"button",onClick:()=>E(C.id),className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-100 truncate",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${Iv(C.grade_color)}`}),C.name," (",C.grade,") - ",C.location_name||"Unknown Location"]},C.id)):a.jsx("p",{className:"px-3 py-2 text-sm text-gray-500",children:"No active routes found."})})]}),J&&!P&&a.jsxs("div",{className:"mt-1 text-xs text-gray-500 pl-2",children:["Selected: ",J.name," (",J.grade,") - ",J.location_name||"Unknown Location",j&&a.jsx("span",{className:"ml-2 italic",children:"(Loading progress...)"}),Y&&a.jsxs("span",{className:"ml-2 text-red-500 italic",children:["(",Y,")"]})]})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:"Log Type"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("button",{type:"button",onClick:()=>c("send"),disabled:j,className:`flex items-center justify-center p-3 border rounded-lg transition-colors disabled:opacity-50 ${l==="send"?"bg-green-100 border-green-400 text-green-700 ring-1 ring-green-400":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Fg,{size:20,className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Send"})]}),a.jsxs("button",{type:"button",onClick:()=>c("attempt"),disabled:j,className:`flex items-center justify-center p-3 border rounded-lg transition-colors disabled:opacity-50 ${l==="attempt"?"bg-orange-100 border-orange-400 text-orange-700 ring-1 ring-orange-400":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Po,{size:20,className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Attempt"})]})]})]}),l==="send"&&a.jsxs("section",{children:[a.jsx("label",{htmlFor:"attempts",className:"block text-sm font-medium text-brand-gray mb-1",children:"Attempts for Send"}),a.jsx("input",{type:"number",id:"attempts",value:u,onChange:C=>d(Math.max(1,parseInt(C.target.value)||1)),min:"1",disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-brand-gray mb-1",children:"Date"}),a.jsx("input",{type:"date",id:"date",value:h,onChange:C=>m(C.target.value),max:new Date().toISOString().split("T")[0],disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-1",children:"Rating / Feel (Optional)"}),a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(C=>a.jsx("button",{type:"button",onClick:()=>x(v===C?null:C),disabled:j,children:a.jsx(To,{size:28,className:C<=(v||0)?"text-accent-yellow":"text-gray-300",fill:C<=(v||0)?"currentColor":"none"})},C))}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How did it feel for the grade?"})]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-brand-gray mb-1",children:"Notes (Private)"}),a.jsx("textarea",{id:"notes",rows:4,value:b,onChange:C=>k(C.target.value),placeholder:"Any thoughts on the climb, conditions, etc.?",disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),y&&a.jsx("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded border border-red-300",children:y}),a.jsx("button",{type:"submit",disabled:g||j||!i||!e,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[a.jsx(ae,{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"}),"Saving..."]}):"Save Log"}),!e&&a.jsx("p",{className:"text-xs text-center text-red-600 mt-2",children:"You must be logged in to log climbs."})]})]})},Uv=e=>{const t=(e==null?void 0:e.display_name)||"User",n=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||n},Na=15,ip=({userId:e,dialogType:t,currentUser:n,onClose:r,onNavigate:s})=>{const[i,o]=p.useState([]),[l,c]=p.useState(!0),[u,d]=p.useState(!1),[h,m]=p.useState(null),[v,x]=p.useState(0),[b,k]=p.useState(!0),[g,f]=p.useState(new Map),[y,_]=p.useState(new Map),S=p.useCallback(async(j=0,B=!1)=>{B?d(!0):(c(!0),o([]),x(0),k(!0)),m(null);const Y=j*Na,X=Y+Na-1;try{let K;t==="followers"?K=H.from("user_follows").select("follower:profiles!follower_id(*)").eq("following_id",e):K=H.from("user_follows").select("following:profiles!following_id(*)").eq("follower_id",e);const{data:J,error:ne}=await K.order("created_at",{ascending:!1}).range(Y,X);if(ne)throw new Error(`Failed to load ${t}: ${ne.message}`);if(J){const w=J.map(E=>t==="followers"?E.follower:E.following).filter(Boolean);o(E=>B?[...E,...w]:w),x(j),k(w.length===Na),n&&w.length>0&&N(w.map(E=>E.user_id))}else B||o([]),k(!1)}catch(K){console.error(`Error fetching ${t}:`,K),m(K.message||"An unexpected error occurred."),B||o([]),k(!1)}finally{c(!1),d(!1)}},[e,t,n]),N=p.useCallback(async j=>{if(!(!n||j.length===0))try{const{data:B,error:Y}=await H.from("user_follows").select("following_id").eq("follower_id",n.id).in("following_id",j);if(Y){console.error("Error fetching follow statuses for list:",Y);return}const X=new Map;j.forEach(K=>{const J=(B==null?void 0:B.some(ne=>ne.following_id===K))??!1;X.set(K,J)}),f(K=>{const J=new Map(K);return X.forEach((ne,w)=>J.set(w,ne)),J})}catch(B){console.error("Unexpected error fetching follow statuses for list:",B)}},[n]);p.useEffect(()=>{S(0)},[S]);const P=async(j,B)=>{if(!n||n.id===j||y.get(j))return;_(X=>new Map(X).set(j,!0));const Y=g.get(j)||!1;try{Y?(await Uo(n.id,j),f(X=>new Map(X).set(j,!1))):(await Fo(n.id,j),f(X=>new Map(X).set(j,!0)))}catch(X){console.error("Error updating follow status from dialog:",X);const K=await Bo(n.id,j);f(J=>new Map(J).set(j,K))}finally{_(X=>new Map(X).set(j,!1))}},A=()=>{!u&&b&&S(v+1,!0)},$=j=>{r(),s(j===(n==null?void 0:n.id)?"profile":"publicProfile",{profileUserId:j})},O=t==="followers"?"Followers":"Following";return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray",children:O}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Nc,{size:24})})]}),a.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:l&&i.length===0?a.jsx("div",{className:"flex justify-center items-center py-6",children:a.jsx(ae,{className:"animate-spin text-accent-blue",size:24})}):h?a.jsxs("p",{className:"text-center text-red-500 py-6 flex items-center justify-center gap-2",children:[a.jsx(vn,{size:18})," ",h]}):i.length>0?a.jsx("div",{className:"space-y-3",children:i.map(j=>{const B=j.user_id===(n==null?void 0:n.id),Y=g.get(j.user_id)||!1,X=y.get(j.user_id)||!1;return a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("button",{onClick:()=>$(j.user_id),className:"flex items-center gap-3 flex-grow hover:opacity-80",children:[a.jsx("img",{src:Uv(j),alt:j.display_name,className:"w-10 h-10 rounded-full object-cover bg-gray-300"}),a.jsx("div",{children:a.jsx("p",{className:"font-medium text-brand-gray text-sm",children:j.display_name})})]}),n&&!B&&a.jsx("button",{onClick:()=>P(j.user_id,j.display_name),disabled:X,className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors duration-200 flex items-center gap-1 disabled:opacity-60 ${Y?"bg-gray-200 text-brand-gray hover:bg-gray-300":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:X?a.jsx(ae,{size:14,className:"animate-spin"}):Y?a.jsxs(a.Fragment,{children:[a.jsx(Lo,{size:14})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ri,{size:14})," Follow"]})})]},j.user_id)})}):a.jsx("p",{className:"text-center text-gray-500 py-6",children:t==="followers"?"No followers yet.":"Not following anyone yet."})}),b&&a.jsx("div",{className:"p-4 border-t text-center",children:a.jsx("button",{onClick:A,disabled:u,className:"text-sm text-accent-blue hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center w-full",children:u?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Load More"})})]})})},cd=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Bv=e=>{if(e&&e.toUpperCase().startsWith("V")){const n=e.substring(1).split("-"),r=parseInt(n[n.length-1],10);return isNaN(r)?-1:r}return-1},Ea=10,Ca=10,ud="avatars",Vv=({currentUser:e,viewingProfileId:t,onNavigate:n,getGymNameById:r})=>{const[s,i]=p.useState(null),[o,l]=p.useState(!0),[c,u]=p.useState(null),[d,h]=p.useState("logbook"),[m,v]=p.useState(!1),[x,b]=p.useState(""),[k,g]=p.useState(null),[f,y]=p.useState(!1),[_,S]=p.useState(null),[N,P]=p.useState(!1),[A,$]=p.useState(null),O=p.useRef(null),[j,B]=p.useState([]),[Y,X]=p.useState(!0),[K,J]=p.useState(!1),[ne,w]=p.useState(null),[E,M]=p.useState(0),[D,C]=p.useState(!0),[T,I]=p.useState([]),[ee,ue]=p.useState(!0),[me,Be]=p.useState(!1),[ie,Z]=p.useState(null),[le,re]=p.useState(0),[oe,ce]=p.useState(!0),[Pe,we]=p.useState(null),[Te,ye]=p.useState(!0),[F,U]=p.useState(null),[W,V]=p.useState(!1),[Q,je]=p.useState(!0),[q,xe]=p.useState(!1),[Le,ft]=p.useState({followers:0,following:0}),[nt,wt]=p.useState(!0),[Yt,Xe]=p.useState(!1),[Ft,Ut]=p.useState("followers"),be=t||(e==null?void 0:e.id),Ve=!t||t===(e==null?void 0:e.id),ss=p.useCallback(async()=>{if(!be){i(null),l(!1),u("No user ID provided.");return}l(!0),u(null);try{const{data:z,error:de}=await H.from("profiles").select("*").eq("user_id",be).single();de?(console.error("Error fetching profile data:",de),u(de.code==="PGRST116"?"Profile not found.":"Failed to load profile."),i(null)):(i(z),b((z==null?void 0:z.display_name)||""))}catch(z){console.error("Unexpected error fetching profile:",z),u(z.message||"An unexpected error occurred."),i(null)}finally{l(!1)}},[be]),fr=p.useCallback(async()=>{if(Ve||!e||!be){V(!1),je(!1);return}je(!0);try{const z=await Bo(e.id,be);V(z)}catch(z){console.error("Error checking follow status:",z)}finally{je(!1)}},[e,be,Ve]),is=p.useCallback(async()=>{if(!be){ft({followers:0,following:0}),wt(!1);return}wt(!0);try{const z=await rp(be);ft({followers:z.followers,following:z.following})}catch(z){console.error("Error fetching follow counts:",z)}finally{wt(!1)}},[be]),_t=p.useCallback(async(z=0,de=!1)=>{if(!be){B([]),X(!1),J(!1),w(null),C(!1);return}de?J(!0):(X(!0),B([]),M(0),C(!0)),w(null);const $e=z*Ea,at=$e+Ea-1;try{const{data:He,error:Bt}=await H.from("user_route_progress").select(`
              attempts, sent_at, rating, notes, wishlist, updated_at,
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",be).or("sent_at.not.is.null,attempts.gt.0").order("updated_at",{ascending:!1}).range($e,at);if(Bt)console.error("Error fetching logbook:",Bt),w("Failed to load climb log."),de||B([]),C(!1);else if(He){const Lt=He.map(Ge=>{const Rt=Ge.route,Xt=Rt==null?void 0:Rt.location_name;return{...Rt,location_name:(Xt==null?void 0:Xt.name)||null,user_progress_attempts:Ge.attempts,user_progress_sent_at:Ge.sent_at,user_progress_rating:Ge.rating,user_progress_notes:Ge.notes,user_progress_wishlist:Ge.wishlist,user_progress_updated_at:Ge.updated_at}});B(Ge=>de?[...Ge,...Lt]:Lt),M(z),C(He.length===Ea)}else de||B([]),C(!1)}catch(He){console.error("Unexpected error fetching logbook:",He),w(He.message||"An unexpected error occurred."),de||B([]),C(!1)}finally{X(!1),J(!1)}},[be]),L=p.useCallback(async(z=0,de=!1)=>{if(!be){I([]),ue(!1),Be(!1),Z(null),ce(!1);return}de?Be(!0):(ue(!0),I([]),re(0),ce(!0)),Z(null);const $e=z*Ca,at=$e+Ca-1;try{const{data:He,error:Bt}=await H.from("user_route_progress").select(`
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",be).eq("wishlist",!0).is("route.removed_at",null).order("created_at",{referencedTable:"routes",ascending:!1}).range($e,at);if(Bt)console.error("Error fetching wishlist:",Bt),Z("Failed to load wishlist."),de||I([]),ce(!1);else if(He){const Lt=He.map(Ge=>{const Rt=Ge.route,Xt=Rt==null?void 0:Rt.location_name;return{...Rt,location_name:(Xt==null?void 0:Xt.name)||null}});I(Ge=>de?[...Ge,...Lt]:Lt),re(z),ce(He.length===Ca)}else de||I([]),ce(!1)}catch(He){console.error("Unexpected error fetching wishlist:",He),Z(He.message||"An unexpected error occurred."),de||I([]),ce(!1)}finally{ue(!1),Be(!1)}},[be]),te=p.useCallback(async()=>{if(!be){we(null),ye(!1),U(null);return}ye(!0),U(null);try{const{data:z,error:de}=await H.from("user_route_progress").select(" route_id, route:routes ( grade ) ").eq("user_id",be).not("sent_at","is",null);if(de)throw console.error("Error fetching stats data:",de),new Error("Failed to load data for stats calculation.");if(z){const $e=z.length,at=new Set(z.map(Lt=>Lt.route_id)).size;let He=null,Bt=-1;z.forEach(Lt=>{var Rt;const Ge=(Rt=Lt.route)==null?void 0:Rt.grade;if(Ge){const Xt=Bv(Ge);Xt>Bt&&(Bt=Xt,He=Ge)}}),we({totalSends:$e,uniqueRoutes:at,highestGrade:He})}else we({totalSends:0,uniqueRoutes:0,highestGrade:null})}catch(z){console.error("Unexpected error fetching stats:",z),U(z.message||"An unexpected error occurred while calculating stats."),we(null)}finally{ye(!1)}},[be]);p.useEffect(()=>{l(!0),X(!0),ue(!0),ye(!0),je(!0),wt(!0),u(null),w(null),Z(null),U(null),M(0),C(!0),re(0),ce(!0),S(null),P(!1),$(null),Xe(!1),ss(),fr(),is(),_t(0),L(0),te()},[be,ss,fr,is,_t,L,te]);const ve=()=>{g(null),b((s==null?void 0:s.display_name)||""),v(!0)},De=()=>{v(!1),g(null)},Ne=async()=>{if(!e||!Ve)return;const z=x.trim();if(!z){g("Display name cannot be empty.");return}if(z===(s==null?void 0:s.display_name)){v(!1);return}y(!0),g(null);try{const{error:de}=await H.from("profiles").update({display_name:z}).eq("user_id",e.id);if(de)throw de;const{error:$e}=await H.auth.updateUser({data:{display_name:z}});if($e)throw console.error("Auth metadata update failed after profile update:",$e),new Error(`Auth update failed: ${$e.message}. Profile might be updated.`);console.log("Profile and auth metadata updated successfully."),i(at=>at?{...at,display_name:z}:null),v(!1)}catch(de){console.error("Error saving display name:",de),g(`Failed to update name: ${de.message}`)}finally{y(!1)}},Ie=()=>{var z;Ve&&!N&&((z=O.current)==null||z.click())},bt=z=>{if(z.target.files&&z.target.files[0]){const de=z.target.files[0],$e=["image/jpeg","image/png","image/gif"],at=5*1024*1024;if(!$e.includes(de.type)){$("Invalid file type. Please select a JPG, PNG, or GIF."),S(null);return}if(de.size>at){$("File size exceeds 5MB limit."),S(null);return}$(null),S(de),Tt(de)}z.target&&(z.target.value="")},Tt=async z=>{if(!(!z||!e||!Ve)){P(!0),$(null);try{const de=`${e.id}`,{error:$e}=await H.storage.from(ud).upload(de,z,{cacheControl:"3600",upsert:!0});if($e)throw new Error(`Failed to upload avatar: ${$e.message}`);const{data:at}=H.storage.from(ud).getPublicUrl(de);if(!(at!=null&&at.publicUrl))throw new Error("Failed to get public URL for the uploaded avatar.");const He=`${at.publicUrl}?t=${new Date().getTime()}`,{error:Bt}=await H.from("profiles").update({avatar_url:He}).eq("user_id",e.id);if(Bt)throw new Error(`Failed to update profile with new avatar URL: ${Bt.message}`);const{error:Lt}=await H.auth.updateUser({data:{avatar_url:He}});Lt&&console.error("Failed to update auth user metadata with avatar URL:",Lt),i(Ge=>Ge?{...Ge,avatar_url:He}:null),S(null),console.log("Avatar uploaded and profile updated successfully!")}catch(de){console.error("Error uploading avatar:",de),$(de.message||"An unexpected error occurred during upload.")}finally{P(!1)}}},on=async()=>{if(!(!e||!be||Ve||q)){xe(!0);try{if(W)await Uo(e.id,be),V(!1),ft(z=>({...z,followers:Math.max(0,z.followers-1)}));else{await Fo(e.id,be),V(!0),ft($e=>({...$e,followers:$e.followers+1}));const z={followed_user_id:be,followed_user_name:(s==null?void 0:s.display_name)||"User"},{error:de}=await H.from("activity_log").insert({user_id:e.id,gym_id:s==null?void 0:s.current_gym_id,activity_type:"follow_user",details:z});de&&console.error("Error logging follow activity:",de)}}catch(z){console.error("Error updating follow status:",z),await fr(),await is()}finally{xe(!1)}}},hr=()=>{!K&&D&&_t(E+1,!0)},pr=()=>{!me&&oe&&L(le+1,!0)},an=z=>{be&&(Ut(z),Xe(!0))},Re=()=>{Xe(!1)},qn=z=>{const de=z.location_name||"Unknown Location",$e=!!z.removed_at;return a.jsxs("div",{onClick:()=>n("routeDetail",{routeId:z.id}),className:`flex items-center gap-3 p-3 border-b last:border-b-0 ${$e?"opacity-60 bg-gray-50":"hover:bg-gray-50 cursor-pointer"}`,children:[a.jsxs("div",{className:`w-8 h-8 ${cd(z.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",z.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:`font-medium text-brand-gray truncate ${$e?"line-through":""}`,children:z.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[" ",de," - Logged: ",new Date(z.user_progress_updated_at).toLocaleDateString()," ",$e&&"(Removed)"," "]})]}),z.user_progress_sent_at?a.jsx(ts,{size:18,className:"text-green-500 flex-shrink-0",title:`Sent (${z.user_progress_attempts} attempts)`}):z.user_progress_attempts>0?a.jsx(Po,{size:18,className:"text-orange-400 flex-shrink-0",title:`Attempted (${z.user_progress_attempts} attempts)`}):null]},z.id)},wn=z=>{const de=z.location_name||"Unknown Location";return z.removed_at?null:a.jsxs("div",{onClick:()=>n("routeDetail",{routeId:z.id}),className:"flex items-center gap-3 p-3 border-b last:border-b-0 hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:`w-8 h-8 ${cd(z.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",z.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:"font-medium text-brand-gray truncate",children:z.name}),a.jsx("p",{className:"text-xs text-gray-500",children:de})]}),a.jsx(uo,{size:18,className:"text-accent-yellow flex-shrink-0"})]},z.id)},Vo=()=>Te?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):F?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(vn,{size:20,className:"inline mr-1 mb-0.5"})," ",F," "]}):Pe?a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-blue/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Total Sends"})," ",a.jsx("span",{className:"font-bold text-accent-blue",children:Pe.totalSends})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-purple/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Unique Routes Climbed"})," ",a.jsx("span",{className:"font-bold text-accent-purple",children:Pe.uniqueRoutes})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-red/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Highest Grade Sent"})," ",a.jsx("span",{className:"font-bold text-accent-red",children:Pe.highestGrade||"N/A"})," "]})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No stats available yet."});if(c&&!o)return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 text-center",children:[a.jsx(vn,{size:48,className:"text-red-500 mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Profile"}),a.jsx("p",{className:"text-red-600 mb-6",children:c})]});const mr=o?"Loading...":(s==null?void 0:s.display_name)||"Climber",op=o?"":(s==null?void 0:s.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(mr)}&background=random&color=fff`,Rc=o?[]:(s==null?void 0:s.selected_gym_ids)||[];return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[a.jsxs("header",{className:"bg-gradient-to-r from-brand-green to-brand-gray p-4 pt-8 pb-20 text-white relative",children:[!Ve&&a.jsx("button",{onClick:()=>n("discover"),className:"absolute top-4 left-4 text-white/80 hover:text-white z-10",children:a.jsx(lr,{size:24})}),Ve&&a.jsx("div",{className:"absolute top-4 right-4 flex gap-2 z-10",children:a.jsxs("button",{onClick:()=>n("settings"),className:"text-white/80 hover:text-white",children:[" ",a.jsx(Yg,{size:20})," "]})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-0",children:[a.jsxs("div",{className:"relative group",children:[o?a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-white shadow-lg bg-gray-300 animate-pulse"}):a.jsx("img",{src:op,alt:mr,className:`w-20 h-20 rounded-full border-4 border-white shadow-lg object-cover bg-gray-300 ${Ve?"cursor-pointer":""}`,onClick:Ie}),Ve&&!N&&a.jsx("button",{onClick:Ie,className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200","aria-label":"Change avatar",children:a.jsx(Dg,{size:24,className:"text-white"})}),N&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/70 rounded-full",children:a.jsx(ae,{size:24,className:"text-white animate-spin"})}),Ve&&a.jsx("input",{type:"file",ref:O,onChange:bt,accept:"image/png, image/jpeg, image/gif",className:"hidden"})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[o?a.jsx("div",{className:"h-8 bg-white/30 rounded w-3/4 animate-pulse mb-1"}):m&&Ve?a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:x,onChange:z=>b(z.target.value),className:"text-2xl font-bold bg-transparent border-b-2 border-white/50 focus:border-white outline-none text-white w-full pr-16",autoFocus:!0,maxLength:50,disabled:f}),a.jsxs("div",{className:"absolute top-0 right-0 flex gap-1 items-center h-full",children:[a.jsxs("button",{onClick:Ne,disabled:f,className:"text-green-300 hover:text-white disabled:opacity-50 p-1",children:[" ",f?a.jsx(ae,{size:20,className:"animate-spin"}):a.jsx(Jg,{size:20})," "]}),a.jsxs("button",{onClick:De,disabled:f,className:"text-red-300 hover:text-white disabled:opacity-50 p-1",children:[" ",a.jsx(sy,{size:20})," "]})]}),k&&a.jsx("p",{className:"text-red-300 text-xs mt-1 absolute -bottom-5",children:k})]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-2xl font-bold truncate",children:mr}),Ve&&a.jsxs("button",{onClick:ve,className:"text-white/70 hover:text-white flex-shrink-0",children:[" ",a.jsx(Wg,{size:18})," "]})]}),A&&Ve&&a.jsx("p",{className:"text-red-300 text-xs mt-1",children:A}),o?a.jsx("div",{className:"h-4 bg-white/30 rounded w-1/2 animate-pulse mt-1"}):a.jsxs("div",{className:"text-sm opacity-90 mt-1 flex items-start gap-1",children:[a.jsx(Qr,{size:14,className:"mt-0.5 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:[" ",Rc.length>0?Rc.map(z=>r(z)).join(", "):"No gyms selected"," "]})]}),a.jsx("div",{className:"text-sm opacity-90 mt-2 flex items-center gap-4",children:nt?a.jsx(ae,{size:14,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>an("followers"),className:"hover:underline disabled:opacity-70",disabled:o||Le.followers===0,children:[a.jsx("strong",{className:"font-bold",children:Le.followers})," Followers"]}),a.jsxs("button",{onClick:()=>an("following"),className:"hover:underline disabled:opacity-70",disabled:o||Le.following===0,children:[a.jsx("strong",{className:"font-bold",children:Le.following})," Following"]})]})})]})]}),!Ve&&e&&a.jsx("div",{className:"absolute bottom-4 right-4 z-10",children:a.jsx("button",{onClick:on,disabled:Q||q||o,className:`px-4 py-1.5 rounded-full text-sm font-semibold transition-colors duration-200 flex items-center gap-1.5 disabled:opacity-60 ${W?"bg-white text-brand-green hover:bg-gray-200":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:Q||q?a.jsx(ae,{size:16,className:"animate-spin"}):W?a.jsxs(a.Fragment,{children:[a.jsx(Lo,{size:16})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ri,{size:16})," Follow"]})})})]}),a.jsxs("main",{className:"p-4 -mt-12 relative z-0",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow mb-4 flex",children:[a.jsxs("button",{onClick:()=>h("logbook"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="logbook"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(Ch,{size:16})," Logbook "]}),Ve&&a.jsxs("button",{onClick:()=>h("wishlist"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="wishlist"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(uo,{size:16})," Wishlist "]}),a.jsxs("button",{onClick:()=>h("stats"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="stats"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(jh,{size:16})," Stats "]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow min-h-[200px]",children:[d==="logbook"&&a.jsx("div",{children:Y&&j.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading logbook... "]}):ne?a.jsx("p",{className:"text-center text-red-500 p-6",children:ne}):j.length>0?a.jsxs(a.Fragment,{children:[j.map(qn),D&&a.jsx("button",{onClick:hr,disabled:K,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:K?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No climbs logged yet."})}),d==="wishlist"&&Ve&&a.jsx("div",{children:ee&&T.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading wishlist... "]}):ie?a.jsx("p",{className:"text-center text-red-500 p-6",children:ie}):T.length>0?a.jsxs(a.Fragment,{children:[T.map(wn),oe&&a.jsx("button",{onClick:pr,disabled:me,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:me?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"Your wishlist is empty."})}),d==="stats"&&Vo()]})]}),Yt&&be&&a.jsx(ip,{userId:be,dialogType:Ft,currentUser:e,onClose:Re,onNavigate:n})]})},Hv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Gv=e=>{if(e&&e.toUpperCase().startsWith("V")){const n=e.substring(1).split("-"),r=parseInt(n[n.length-1],10);return isNaN(r)?-1:r}return-1},Pa=10,qv=({currentUser:e,viewingProfileId:t,onNavigate:n,getGymNameById:r,onBack:s})=>{const[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null),[h,m]=p.useState("logbook"),[v,x]=p.useState([]),[b,k]=p.useState(!0),[g,f]=p.useState(!1),[y,_]=p.useState(null),[S,N]=p.useState(0),[P,A]=p.useState(!0),[$,O]=p.useState(null),[j,B]=p.useState(!0),[Y,X]=p.useState(null),[K,J]=p.useState(!1),[ne,w]=p.useState(!0),[E,M]=p.useState(!1),[D,C]=p.useState({followers:0,following:0}),[T,I]=p.useState(!0),[ee,ue]=p.useState(!1),[me,Be]=p.useState("followers"),ie=t,Z=p.useCallback(async()=>{if(!ie){o(null),c(!1),d("No user ID provided."),x([]),O(null),C({followers:0,following:0});return}c(!0),d(null);try{const{data:q,error:xe}=await H.from("profiles").select("*").eq("user_id",ie).single();xe?(console.error("Error fetching public profile data:",xe),d(xe.code==="PGRST116"?"Profile not found.":"Failed to load profile."),o(null)):o(q)}catch(q){console.error("Unexpected error fetching public profile:",q),d(q.message||"An unexpected error occurred."),o(null)}finally{c(!1)}},[ie]),le=p.useCallback(async()=>{if(!e||!ie||e.id===ie){J(!1),w(!1);return}w(!0);try{const q=await Bo(e.id,ie);J(q)}catch(q){console.error("Error checking follow status:",q)}finally{w(!1)}},[e,ie]),re=p.useCallback(async()=>{if(!ie){C({followers:0,following:0}),I(!1);return}I(!0);try{const q=await rp(ie);C({followers:q.followers,following:q.following})}catch(q){console.error("Error fetching follow counts:",q)}finally{I(!1)}},[ie]),oe=p.useCallback(async(q=0,xe=!1)=>{if(!ie){x([]),k(!1),f(!1),_(null),A(!1);return}xe?f(!0):(k(!0),x([]),N(0),A(!0)),_(null);const Le=q*Pa,ft=Le+Pa-1;try{const{data:nt,error:wt}=await H.from("user_route_progress").select(`
              attempts, sent_at, rating, updated_at,
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",ie).not("sent_at","is",null).order("sent_at",{ascending:!1}).range(Le,ft);if(wt)console.error("Error fetching public logbook:",wt),_("Failed to load climb log."),xe||x([]),A(!1);else if(nt){const Yt=nt.map(Xe=>{const Ft=Xe.route,Ut=Ft==null?void 0:Ft.location_name;return{...Ft,location_name:(Ut==null?void 0:Ut.name)||null,user_progress_attempts:Xe.attempts,user_progress_sent_at:Xe.sent_at,user_progress_rating:Xe.rating,user_progress_notes:null,user_progress_wishlist:!1,user_progress_updated_at:Xe.updated_at}});x(Xe=>xe?[...Xe,...Yt]:Yt),N(q),A(nt.length===Pa)}else xe||x([]),A(!1)}catch(nt){console.error("Unexpected error fetching public logbook:",nt),_(nt.message||"An unexpected error occurred."),xe||x([]),A(!1)}finally{k(!1),f(!1)}},[ie]),ce=p.useCallback(async()=>{if(!ie){O(null),B(!1),X(null);return}B(!0),X(null);try{const{data:q,error:xe}=await H.from("user_route_progress").select(" route_id, route:routes ( grade ) ").eq("user_id",ie).not("sent_at","is",null);if(xe)throw console.error("Error fetching public stats data:",xe),new Error("Failed to load data for stats calculation.");if(q){const Le=q.length,ft=new Set(q.map(Yt=>Yt.route_id)).size;let nt=null,wt=-1;q.forEach(Yt=>{var Ft;const Xe=(Ft=Yt.route)==null?void 0:Ft.grade;if(Xe){const Ut=Gv(Xe);Ut>wt&&(wt=Ut,nt=Xe)}}),O({totalSends:Le,uniqueRoutes:ft,highestGrade:nt})}else O({totalSends:0,uniqueRoutes:0,highestGrade:null})}catch(q){console.error("Unexpected error fetching public stats:",q),X(q.message||"An unexpected error occurred while calculating stats."),O(null)}finally{B(!1)}},[ie]);p.useEffect(()=>{c(!0),k(!0),B(!0),w(!0),I(!0),d(null),_(null),X(null),N(0),A(!0),ue(!1),Z(),le(),re(),oe(0),ce()},[ie,Z,le,re,oe,ce]);const Pe=async()=>{if(!(!e||!ie||e.id===ie||E)){M(!0);try{if(K)await Uo(e.id,ie),J(!1),C(q=>({...q,followers:Math.max(0,q.followers-1)}));else{await Fo(e.id,ie),J(!0),C(Le=>({...Le,followers:Le.followers+1}));const q={followed_user_id:ie,followed_user_name:(i==null?void 0:i.display_name)||"User"},{error:xe}=await H.from("activity_log").insert({user_id:e.id,gym_id:i==null?void 0:i.current_gym_id,activity_type:"follow_user",details:q});xe&&console.error("Error logging follow activity:",xe)}}catch(q){console.error("Error updating follow status:",q),await le(),await re()}finally{M(!1)}}},we=()=>{!g&&P&&oe(S+1,!0)},Te=q=>{ie&&(Be(q),ue(!0))},ye=()=>{ue(!1)},F=q=>{const xe=q.location_name||"Unknown Location",Le=!!q.removed_at;return a.jsxs("div",{onClick:()=>n("routeDetail",{routeId:q.id}),className:`flex items-center gap-3 p-3 border-b last:border-b-0 ${Le?"opacity-60 bg-gray-50":"hover:bg-gray-50 cursor-pointer"}`,children:[a.jsxs("div",{className:`w-8 h-8 ${Hv(q.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",q.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:`font-medium text-brand-gray truncate ${Le?"line-through":""}`,children:q.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[" ",xe," - Sent: ",q.user_progress_sent_at?new Date(q.user_progress_sent_at).toLocaleDateString():"N/A"," ",Le&&"(Removed)"," "]})]}),a.jsx(ts,{size:18,className:"text-green-500 flex-shrink-0",title:`Sent (${q.user_progress_attempts} attempts)`})]},q.id)},U=()=>j?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):Y?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(vn,{size:20,className:"inline mr-1 mb-0.5"})," ",Y," "]}):$?a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-blue/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Total Sends"})," ",a.jsx("span",{className:"font-bold text-accent-blue",children:$.totalSends})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-purple/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Unique Routes Climbed"})," ",a.jsx("span",{className:"font-bold text-accent-purple",children:$.uniqueRoutes})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-red/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Highest Grade Sent"})," ",a.jsx("span",{className:"font-bold text-accent-red",children:$.highestGrade||"N/A"})," "]})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No stats available yet."});if(u)return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 text-center",children:[a.jsx(vn,{size:48,className:"text-red-500 mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Profile"}),a.jsx("p",{className:"text-red-600 mb-6",children:u}),a.jsx("button",{onClick:s,className:"mt-4 text-sm text-accent-blue underline",children:"Go Back"})]});const W=l?"Loading...":(i==null?void 0:i.display_name)||"Climber",V=l?"":(i==null?void 0:i.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(W)}&background=random&color=fff`,Q=l?[]:(i==null?void 0:i.selected_gym_ids)||[],je=(e==null?void 0:e.id)===ie;return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[a.jsxs("header",{className:"bg-gradient-to-r from-brand-green to-brand-gray p-4 pt-8 pb-20 text-white relative",children:[a.jsx("button",{onClick:s,className:"absolute top-4 left-4 text-white/80 hover:text-white z-10",children:a.jsx(lr,{size:24})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-0",children:[l?a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-white shadow-lg bg-gray-300 animate-pulse"}):a.jsx("img",{src:V,alt:W,className:"w-20 h-20 rounded-full border-4 border-white shadow-lg object-cover bg-gray-300"}),a.jsxs("div",{className:"flex-grow min-w-0",children:[l?a.jsx("div",{className:"h-8 bg-white/30 rounded w-3/4 animate-pulse mb-1"}):a.jsx("h1",{className:"text-2xl font-bold truncate",children:W}),l?a.jsx("div",{className:"h-4 bg-white/30 rounded w-1/2 animate-pulse mt-1"}):a.jsxs("div",{className:"text-sm opacity-90 mt-1 flex items-start gap-1",children:[a.jsx(Qr,{size:14,className:"mt-0.5 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:[" ",Q.length>0?Q.map(q=>r(q)).join(", "):"No gyms selected"," "]})]}),a.jsx("div",{className:"text-sm opacity-90 mt-2 flex items-center gap-4",children:T?a.jsx(ae,{size:14,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>Te("followers"),className:"hover:underline disabled:opacity-70",disabled:l||D.followers===0,children:[a.jsx("strong",{className:"font-bold",children:D.followers})," Followers"]}),a.jsxs("button",{onClick:()=>Te("following"),className:"hover:underline disabled:opacity-70",disabled:l||D.following===0,children:[a.jsx("strong",{className:"font-bold",children:D.following})," Following"]})]})})]})]}),e&&!je&&a.jsx("div",{className:"absolute bottom-4 right-4 z-10",children:a.jsx("button",{onClick:Pe,disabled:ne||E||l,className:`px-4 py-1.5 rounded-full text-sm font-semibold transition-colors duration-200 flex items-center gap-1.5 disabled:opacity-60 ${K?"bg-white text-brand-green hover:bg-gray-200":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:ne||E?a.jsx(ae,{size:16,className:"animate-spin"}):K?a.jsxs(a.Fragment,{children:[a.jsx(Lo,{size:16})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ri,{size:16})," Follow"]})})})]}),a.jsxs("main",{className:"p-4 -mt-12 relative z-0",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow mb-4 flex",children:[a.jsxs("button",{onClick:()=>m("logbook"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${h==="logbook"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(Ch,{size:16})," Logbook "]}),a.jsxs("button",{onClick:()=>m("stats"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${h==="stats"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(jh,{size:16})," Stats "]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow min-h-[200px]",children:[h==="logbook"&&a.jsx("div",{children:b&&v.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading logbook... "]}):y?a.jsx("p",{className:"text-center text-red-500 p-6",children:y}):v.length>0?a.jsxs(a.Fragment,{children:[v.map(F),P&&a.jsx("button",{onClick:we,disabled:g,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[" ",a.jsx(ae,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No public climbs logged yet."})}),h==="stats"&&U()]})]}),ee&&ie&&a.jsx(ip,{userId:ie,dialogType:me,currentUser:e,onClose:ye,onNavigate:n})]})},Wv=e=>{const t=(e==null?void 0:e.display_name)||"User",n=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||n},Kv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Qv=({currentUser:e,activeGymId:t,onNavigate:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState([]),[l,c]=p.useState(!1),[u,d]=p.useState(null),[h,m]=p.useState([]),[v,x]=p.useState(!1),[b,k]=p.useState(null),[g,f]=p.useState(new Map),[y,_]=p.useState(new Map),[S,N]=p.useState([]),[P,A]=p.useState(!1),[$,O]=p.useState(null),j=p.useRef(null),B=p.useCallback(async()=>{A(!0),O(null);try{const{data:w,error:E}=await H.from("routes").select("*, gym:gyms ( name )").is("removed_at",null).order("created_at",{ascending:!1}).limit(3);if(E)throw new Error(`Failed to fetch trending routes: ${E.message}`);if(w){const M=w.map(D=>{var C;return{...D,gym_name:((C=D.gym)==null?void 0:C.name)||"Unknown Gym"}});N(M)}else N([])}catch(w){console.error("Error fetching trending routes:",w),O(w.message||"An unexpected error occurred."),N([])}finally{A(!1)}},[]);p.useEffect(()=>{B()},[B]);const Y=p.useCallback(async w=>{if(!e||w.length===0){f(new Map);return}try{const{data:E,error:M}=await H.from("user_follows").select("following_id").eq("follower_id",e.id).in("following_id",w);if(M){console.error("Error fetching follow statuses:",M),f(new Map);return}const D=new Map;w.forEach(C=>{const T=(E==null?void 0:E.some(I=>I.following_id===C))??!1;D.set(C,T)}),f(C=>{const T=new Map(C);return D.forEach((I,ee)=>T.set(ee,I)),T})}catch(E){console.error("Unexpected error fetching follow statuses:",E),f(new Map)}},[e]),X=p.useCallback(async()=>{if(!e||!t){m([]),x(!1),k(null);return}x(!0),k(null);try{const{data:w,error:E}=await H.rpc("get_suggested_climbers",{user_id_in:e.id,gym_id_in:t,limit_in:5});if(E)throw new Error(`Failed to fetch suggestions: ${E.message}`);const M=w||[];m(M),M.length>0&&Y(M.map(D=>D.user_id))}catch(w){console.error("Error fetching suggested climbers:",w),k(w.message||"An unexpected error occurred."),m([])}finally{x(!1)}},[e,t,Y]);p.useEffect(()=>{r.trim()?(m([]),x(!1),k(null)):X()},[X,t,r]);const K=p.useCallback(async w=>{if(!w.trim()||!e){o([]),c(!1),d(null);return}c(!0),d(null),m([]),x(!1),k(null);try{const{data:E,error:M}=await H.from("profiles").select("*").ilike("display_name",`%${w.trim()}%`).neq("user_id",e.id).limit(10);if(M)throw new Error(`Failed to search climbers: ${M.message}`);const D=E||[];o(D),D.length>0&&Y(D.map(C=>C.user_id))}catch(E){console.error("Error searching climbers:",E),d(E.message||"An unexpected error occurred."),o([])}finally{c(!1)}},[e,Y]);p.useEffect(()=>(j.current&&clearTimeout(j.current),r.trim()?j.current=setTimeout(()=>K(r),300):(o([]),c(!1),d(null),X()),()=>{j.current&&clearTimeout(j.current)}),[r,K,X]);const J=async(w,E)=>{if(!e||y.get(w))return;_(D=>new Map(D).set(w,!0));const M=g.get(w)||!1;try{if(M)await Uo(e.id,w),f(D=>new Map(D).set(w,!1));else{await Fo(e.id,w),f(T=>new Map(T).set(w,!0));const D={followed_user_id:w,followed_user_name:E},{error:C}=await H.from("activity_log").insert({user_id:e.id,gym_id:t,activity_type:"follow_user",details:D});C&&console.error("Error logging follow activity:",C)}}catch(D){console.error("Error updating follow status:",D);const C=await Bo(e.id,w);f(T=>new Map(T).set(w,C))}finally{_(D=>new Map(D).set(w,!1))}},ne=w=>{const E=g.get(w.user_id)||!1,M=y.get(w.user_id)||!1;return a.jsxs("div",{className:"flex items-center justify-between gap-3 p-2 border-b last:border-b-0",children:[a.jsxs("button",{onClick:()=>n("publicProfile",{profileUserId:w.user_id}),className:"flex items-center gap-3 flex-grow hover:opacity-80",children:[a.jsx("img",{src:Wv(w),alt:w.display_name,className:"w-10 h-10 rounded-full object-cover bg-gray-300"}),a.jsx("div",{children:a.jsx("p",{className:"font-medium text-brand-gray text-sm",children:w.display_name})})]}),a.jsx("button",{onClick:()=>J(w.user_id,w.display_name),disabled:M||!e,className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors duration-200 flex items-center gap-1 disabled:opacity-60 ${E?"bg-gray-200 text-brand-gray hover:bg-gray-300":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:M?a.jsx(ae,{size:14,className:"animate-spin"}):E?a.jsxs(a.Fragment,{children:[a.jsx(Lo,{size:14})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ri,{size:14})," Follow"]})})]},w.user_id)};return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[" ",a.jsx("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:a.jsxs("h1",{className:"text-xl font-bold text-center text-brand-green flex items-center justify-center gap-2",children:[a.jsx(Eh,{size:24,className:"text-accent-blue"})," Discover"]})}),a.jsxs("main",{className:"p-4 space-y-6",children:[a.jsxs("section",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3 flex items-center gap-2",children:[a.jsx(ty,{size:20})," Community Highlights"]}),P?a.jsxs("div",{className:"flex justify-center items-center p-6 bg-white rounded-lg shadow",children:[a.jsx(ae,{className:"animate-spin text-accent-blue mr-2",size:24}),a.jsx("p",{className:"text-brand-gray",children:"Loading highlights..."})]}):$?a.jsx("p",{className:"text-center text-red-500 p-6 bg-white rounded-lg shadow",children:$}):S.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(w=>a.jsxs("div",{onClick:()=>n("routeDetail",{routeId:w.id}),className:"bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow",children:[w.image_url?a.jsx("img",{src:w.image_url,alt:w.name,className:"w-full h-32 object-cover"}):a.jsx("div",{className:`w-full h-32 ${Kv(w.grade_color)} flex items-center justify-center text-white font-bold text-2xl`,children:w.grade}),a.jsxs("div",{className:"p-3",children:[a.jsxs("p",{className:"font-semibold text-brand-gray truncate",children:[w.name," (",w.grade,")"]}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:w.gym_name})]})]},w.id))}):a.jsx("p",{className:"text-center text-gray-500 p-6 bg-white rounded-lg shadow",children:"No trending routes found right now."})]}),a.jsxs("section",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3 flex items-center gap-2",children:[a.jsx(ry,{size:20})," Connect with Climbers"]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx("input",{type:"text",placeholder:"Search climbers by display name...",value:r,onChange:w=>s(w.target.value),className:"w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-white",disabled:!e}),a.jsx(ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow space-y-3",children:[l&&a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(ae,{className:"animate-spin text-accent-blue",size:24}),a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:"Searching..."})]}),v&&!r.trim()&&a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(ae,{className:"animate-spin text-accent-blue",size:24}),a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:"Loading suggestions..."})]}),u&&a.jsxs("p",{className:"text-center text-red-500 text-sm py-4 flex items-center justify-center gap-2",children:[a.jsx(vn,{size:18})," ",u]}),b&&!r.trim()&&!v&&a.jsxs("p",{className:"text-center text-red-500 text-sm py-4 flex items-center justify-center gap-2",children:[a.jsx(vn,{size:18})," ",b]}),!l&&!u&&r.trim()&&i.length>0&&i.map(ne),!l&&!u&&r.trim()&&i.length===0&&a.jsxs("p",{className:"text-center text-gray-500 text-sm py-4",children:['No climbers found matching "',r,'".']}),!r.trim()&&!v&&!b&&h.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-xs font-semibold text-brand-gray uppercase tracking-wide flex items-center gap-1.5 mb-1",children:[a.jsx(To,{size:14,className:"text-accent-yellow"})," Suggestions for You"]}),h.map(ne)]}),!r.trim()&&!v&&!b&&h.length===0&&a.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"No suggestions found for your current gym right now."}),!e&&a.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"Log in to connect with climbers."})]})]})]})]})},Jv=({title:e,feedbackType:t,onClose:n,currentUser:r})=>{const[s,i]=p.useState(""),[o,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(!1),m=async v=>{if(v.preventDefault(),!s.trim()||!r){u(r?"Message cannot be empty.":"You must be logged in to send feedback.");return}l(!0),u(null),h(!1);try{await sp(t,s),h(!0),i(""),setTimeout(n,2e3)}catch(x){u(x.message||"An unexpected error occurred.")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-brand-gray",children:e}),a.jsx("button",{onClick:n,disabled:o,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:a.jsx(Nc,{size:24})})]}),a.jsx("form",{onSubmit:m,className:"p-4 space-y-4",children:d?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ts,{className:"mx-auto text-green-500 mb-2",size:40}),a.jsx("p",{className:"text-brand-gray font-medium",children:"Feedback Sent!"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for your input."})]}):a.jsxs(a.Fragment,{children:[a.jsx("textarea",{rows:5,value:s,onChange:v=>i(v.target.value),placeholder:"Enter your message here...",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",required:!0,disabled:o||!r}),c&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:c}),!r&&a.jsx("p",{className:"text-yellow-600 text-sm text-center bg-yellow-50 p-2 rounded border border-yellow-200",children:"You must be logged in to send feedback."}),a.jsx("button",{type:"submit",disabled:o||!s.trim()||!r,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx(ae,{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(jc,{size:18}),a.jsx("span",{children:"Send Feedback"})]})})]})})]})})},Yv=({currentUser:e,userMetadata:t,onNavigate:n,onLogout:r,onNavigateToGymSelection:s,onBack:i})=>{const[o,l]=p.useState(!1),[c,u]=p.useState(!1),d=async()=>{l(!0),await r()},h=({icon:m,label:v,onClick:x,isButton:b=!0,isDestructive:k=!1})=>a.jsxs("button",{onClick:x,disabled:!b||o,className:`flex items-center justify-between w-full p-4 text-left ${b?"hover:bg-gray-50 active:bg-gray-100":""} ${k?"text-red-600":"text-brand-gray"} disabled:opacity-50`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(m,{size:20,className:k?"text-red-500":"text-brand-gray"}),a.jsx("span",{className:"text-sm font-medium",children:v})]}),b&&!k&&a.jsx(Ug,{size:18,className:"text-gray-400"}),b&&k&&o&&a.jsx(ae,{size:18,className:"animate-spin"})]});return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsx("button",{onClick:i,className:"mr-4 text-brand-gray hover:text-brand-green",children:a.jsx(lr,{size:24})}),a.jsx("h1",{className:"text-xl font-bold text-brand-green",children:"Settings"})]}),a.jsxs("main",{className:"p-4 space-y-6 pb-10",children:[" ",a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Account"}),a.jsx(h,{icon:qg,label:"Logout",onClick:d,isDestructive:!0})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Gyms"}),a.jsx(h,{icon:Mg,label:"Manage My Gyms",onClick:s})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Support"}),a.jsx(h,{icon:Ph,label:"Contact Us",onClick:()=>u(!0)})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"About"}),a.jsx(h,{icon:Vg,label:"App Version",isButton:!1}),a.jsxs("div",{className:"px-4 pb-3",children:[a.jsx("p",{className:"text-sm text-brand-gray ml-[32px]",children:"1.0.0 (Alpha)"})," "]})]})]}),c&&a.jsx(Jv,{title:"Contact Us",feedbackType:"contact",onClose:()=>u(!1),currentUser:e})]})},Xv=({currentView:e,onNavigate:t})=>{const n=[{name:"dashboard",label:"Home",icon:Bg},{name:"routes",label:"Routes",icon:Rh},{name:"log",label:"Log Climb",icon:Qg,isCenter:!0},{name:"discover",label:"Discover",icon:Eh},{name:"profile",label:"Profile",icon:Ro}];return a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_5px_rgba(0,0,0,0.1)] flex justify-around items-center h-16 z-20",children:n.map(r=>{const s=e===r.name,i=r.icon;return a.jsxs("button",{onClick:()=>t(r.name),className:`flex flex-col items-center justify-center flex-grow text-center px-2 transition-colors duration-200 ${s?"text-accent-blue":"text-brand-gray hover:text-accent-blue/80"} ${r.isCenter?"-mt-4":""}`,children:[a.jsx("div",{className:`${r.isCenter?"bg-accent-blue text-white rounded-full p-3 shadow-lg mb-1":""}`,children:a.jsx(i,{size:r.isCenter?28:24,strokeWidth:s?2.5:2})}),!r.isCenter&&a.jsx("span",{className:`text-xs mt-1 ${s?"font-semibold":""}`,children:r.label})]},r.name)})})};function Zv(){const[e,t]=p.useState("welcome"),[n,r]=p.useState("onboarding"),[s,i]=p.useState("dashboard"),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(null),[m,v]=p.useState(null),[x,b]=p.useState(!1),[k,g]=p.useState(null),[f,y]=p.useState(null),[_,S]=p.useState(new Map),[N,P]=p.useState(!0),[A,$]=p.useState(!1),[O,j]=p.useState(!1),[B,Y]=p.useState(void 0),[X,K]=p.useState(void 0),[J,ne]=p.useState(!1),[w,E]=p.useState(null),[M,D]=p.useState([]),[C,T]=p.useState(!1),I=p.useCallback(F=>{var U;return F?((U=_.get(F))==null?void 0:U.name)||"Loading Gym...":"Unknown Gym"},[_]);p.useEffect(()=>{(async()=>{const U=new Set;o.forEach(V=>U.add(V)),c&&U.add(c),f!=null&&f.selected_gym_ids&&f.selected_gym_ids.forEach(V=>U.add(V));const W=Array.from(U).filter(Boolean);if(W.length===0){S(new Map);return}j(!0);try{const{data:V,error:Q}=await H.from("gyms").select("id, name, city, state, country").in("id",W);if(Q)console.error("[Gym Details Effect] Error fetching gym details:",Q),S(new Map);else if(V){const je=new Map;V.forEach(q=>je.set(q.id,q)),S(je)}}catch(V){console.error("[Gym Details Effect] Unexpected error fetching gym details:",V),S(new Map)}finally{j(!1)}})()},[c,o,f]);const ee=p.useCallback(async F=>{console.log("[fetchUserMetadata] Fetching metadata for logged-in user:",F),$(!0);let U=null;try{const{data:W,error:V}=await H.from("profiles").select("*").eq("user_id",F).single();if(V&&V.code!=="PGRST116")console.error("[fetchUserMetadata] Error fetching user metadata:",V.message),y(null),l([]),u(null);else if(W){console.log("[fetchUserMetadata] User metadata fetched successfully:",W),y(W),U=W;const Q=W.selected_gym_ids||[],je=W.current_gym_id||null;l(Q);const q=je||(Q.length>0?Q[0]:null);u(q),Q.length>0?(t("complete"),r(xe=>xe==="onboarding"?"dashboard":xe)):(t("gymSelection"),r("onboarding"))}else console.log("[fetchUserMetadata] No user metadata found for user:",F),y(null),l([]),u(null),t("gymSelection"),r("onboarding")}catch(W){console.error("[fetchUserMetadata] Unexpected error during fetch:",W),y(null),l([]),u(null),t("gymSelection"),r("onboarding")}finally{$(!1)}return U},[]);p.useEffect(()=>{let F=!0;P(!0);const U=()=>{F&&(b(!1),g(null),y(null),l([]),u(null),h(null),v(null),S(new Map),r("onboarding"),t("auth"),i("dashboard"),$(!1),j(!1),K(void 0),ne(!1),E(null),Y(void 0),D([]),T(!1))};H.auth.getSession().then(({data:{session:V}})=>{F&&(g((V==null?void 0:V.user)??null),b(!!(V!=null&&V.user)),V!=null&&V.user||U(),P(!1))}).catch(V=>{console.error("[Auth Effect] Error getting initial session:",V),F&&(U(),P(!1))});const{data:W}=H.auth.onAuthStateChange((V,Q)=>{var Le;if(!F)return;const je=k==null?void 0:k.id,q=((Le=Q==null?void 0:Q.user)==null?void 0:Le.id)!==je,xe=!(Q!=null&&Q.user)&&!!je;(q||xe)&&(g((Q==null?void 0:Q.user)??null),b(!!(Q!=null&&Q.user)),Q!=null&&Q.user?($(!0),K(void 0),ne(!1),E(null),Y(void 0),D([]),T(!1),v(null)):U())});return()=>{F=!1,W==null||W.subscription.unsubscribe()}},[]),p.useEffect(()=>(k&&!N?ee(k.id).catch(F=>{console.error("[Data Fetch Effect] Error during metadata fetch:",F)}):k||$(!1),()=>{}),[k,ee,N]),p.useEffect(()=>{(async()=>{var U;if(n!=="routeDetail"&&n!=="addBeta"||!d){J||(K(void 0),E(null));return}console.log(`[Route Detail Effect] Fetching details for route ID: ${d} (View: ${n})`),ne(!0),E(null),K(void 0);try{const{data:W,error:V}=await H.from("routes").select("*, location_name:locations ( name )").eq("id",d).single();if(V)console.error("[Route Detail Effect] Error fetching route details:",V),E(V.code==="PGRST116"?"Route not found.":`Failed to load route details: ${V.message}`),K(null);else if(W){const Q={...W,location_name:((U=W.location_name)==null?void 0:U.name)||null};console.log("[Route Detail Effect] Route details fetched successfully:",Q),K(Q)}else console.warn("[Route Detail Effect] Route not found in DB (ID:",d,")"),E("Route not found."),K(null)}catch(W){console.error("[Route Detail Effect] Unexpected error fetching route details:",W),E("An unexpected error occurred while fetching route details."),K(null)}finally{ne(!1)}})()},[d,n]),p.useEffect(()=>{(async()=>{if(!c||n!=="log"){D([]),T(!1);return}T(!0);try{const{data:U,error:W}=await H.from("routes").select("id, gym_id, name, grade, grade_color, date_set, location_id, removed_at, location_name:locations ( name )").eq("gym_id",c).is("removed_at",null).order("name",{ascending:!0});if(W)console.error("[Active Gym Routes Effect] Error fetching routes:",W),D([]);else{const V=U.map(Q=>{var je;return{...Q,location_name:((je=Q.location_name)==null?void 0:je.name)||null}});D(V)}}catch(U){console.error("[Active Gym Routes Effect] Unexpected error:",U),D([])}finally{T(!1)}})()},[c,n]),p.useEffect(()=>{["log","settings","addBeta","publicProfile","profile"].includes(n)||i(n)},[n]);const ue=(F,U)=>{console.log(`Navigating to: ${F}`,U),F!=="routes"&&!(U!=null&&U.searchTerm)&&Y(void 0),F!=="profile"&&F!=="publicProfile"&&!(U!=null&&U.profileUserId)&&v(null),U!=null&&U.routeId&&(F==="routeDetail"||F==="addBeta")&&h(U.routeId),U!=null&&U.searchTerm&&F==="routes"&&Y(U.searchTerm),U!=null&&U.profileUserId&&(F==="profile"||F==="publicProfile")&&v(U.profileUserId),r(F)},me=()=>{u(null),r("onboarding"),t("gymSelection")},Be=async(F,U,W)=>{$(!0);try{const{error:V}=await H.from("profiles").upsert({user_id:F,selected_gym_ids:U,current_gym_id:W},{onConflict:"user_id"});V?(console.error("Error saving selected gyms (upsert):",V),alert(`Error saving gym selection: ${V.message}`),await ee(F)):(l(U),u(W),y(Q=>{var je;return Q?{...Q,selected_gym_ids:U,current_gym_id:W}:{user_id:F,display_name:((je=k==null?void 0:k.user_metadata)==null?void 0:je.display_name)||"Climber",selected_gym_ids:U,current_gym_id:W,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}),t("complete"),r("dashboard"))}catch(V){console.error("Unexpected error persisting gym selection:",V),alert("An unexpected error occurred while saving your gym selection."),k&&await ee(k.id)}finally{$(!1)}},ie=async F=>{if(console.log(`Gym selection complete. Selected gyms: ${F.join(", ")}`),F.length>0&&k){const U=F[0],W=c&&F.includes(c)?c:U;await Be(k.id,F,W)}else k?alert("Please select at least one gym."):(alert("Error: User session not found. Please try logging in again."),we())},Z=F=>{l(F)},le=()=>{$(!0)},re=async F=>{if(k&&F!==c){const U=c;u(F),r("dashboard"),h(null),$(!0);try{const{error:W}=await H.from("profiles").update({current_gym_id:F}).eq("user_id",k.id);W?(console.error("Error updating current gym:",W),u(U),alert(`Failed to switch gym: ${W.message}`)):y(V=>V?{...V,current_gym_id:F}:null)}catch(W){console.error("Unexpected error switching gym:",W),u(U),alert("An unexpected error occurred while switching gyms.")}finally{$(!1)}}},oe=()=>{console.log(`HandleBack called. Current view: ${n}, Previous view: ${s}`),n==="routeDetail"||n==="addBeta"?(r("routes"),h(null)):n==="routes"?(r("dashboard"),Y(void 0)):n==="log"||n==="settings"||n==="profile"||n==="publicProfile"?(r(s),(n==="profile"||n==="publicProfile")&&v(null)):n==="discover"?r("dashboard"):n==="onboarding"&&e==="gymSelection"?t("auth"):n==="onboarding"&&e==="gymSelection"&&x&&(f!=null&&f.selected_gym_ids)&&f.selected_gym_ids.length>0?(r("dashboard"),t("complete")):r("dashboard")},ce=()=>{r("routeDetail")},Pe=()=>{r(s)},we=async()=>{P(!0);const{error:F}=await H.auth.signOut();F&&(alert(`Logout failed: ${F.message}`),P(!1))},Te=()=>{switch(e){case"welcome":return a.jsx(iy,{onNext:()=>t("auth")});case"auth":return a.jsx(kv,{onAuthSuccess:le});case"gymSelection":return a.jsx(jv,{preSelectedGymsIds:o,onGymsSelected:Z,onNext:ie,currentUser:k});default:return null}};return(()=>{if(N||x&&(A||O))return a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ae,{className:"animate-spin mr-2"}),"Loading App..."]});if(!x||x&&e!=="complete"||n==="onboarding")return x&&e!=="complete"&&n!=="onboarding"?(r("onboarding"),a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ae,{className:"animate-spin mr-2"}),"Loading Onboarding..."]})):Te();if(x&&k&&e==="complete"){if(n==="onboarding")return r("dashboard"),a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ae,{className:"animate-spin mr-2"}),"Redirecting..."]});const U=I(c),W=!["settings","addBeta","routeDetail","log","publicProfile"].includes(n),V=W?a.jsx(Xv,{currentView:n,onNavigate:ue}):null;let Q;switch(n){case"dashboard":Q=a.jsx(sd,{currentUser:k,selectedGyms:o,activeGymId:c,onSwitchGym:re,getGymNameById:I,onNavigateToGymSelection:me,onNavigate:ue});break;case"routes":Q=a.jsx(Lv,{currentUser:k,activeGymId:c,activeGymName:U,onNavigate:ue,initialSearchTerm:B});break;case"routeDetail":Q=a.jsx(zv,{currentUser:k,route:X,isLoading:J,error:w,onBack:oe,onNavigate:ue});break;case"addBeta":J?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-brand-gray",children:[a.jsx(ae,{className:"animate-spin mr-2"}),"Loading Route Info..."]}):w||!X?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-red-500",children:["Error loading route context: ",w||"Route not found."," ",a.jsx("button",{onClick:oe,className:"underline",children:"Go Back"})]}):Q=a.jsx(Dv,{currentUser:k,route:X,onBack:oe,onSubmitSuccess:ce});break;case"log":C?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-brand-gray",children:[a.jsx(ae,{className:"animate-spin mr-2"}),"Loading Routes..."]}):Q=a.jsx(Fv,{currentUser:k,activeGymId:c,availableRoutes:M,onBack:oe,onSubmitSuccess:Pe});break;case"discover":Q=a.jsx(Qv,{currentUser:k,activeGymId:c,onNavigate:ue});break;case"profile":Q=a.jsx(Vv,{currentUser:k,viewingProfileId:null,onNavigate:ue,getGymNameById:I});break;case"publicProfile":m?Q=a.jsx(qv,{currentUser:k,viewingProfileId:m,onNavigate:ue,getGymNameById:I,onBack:oe}):(console.error("Error: viewingProfileId is missing for publicProfile view."),r("discover"),Q=a.jsx("div",{className:"p-4 pt-16 text-center text-red-500",children:"Error: Profile ID missing."}));break;case"settings":Q=a.jsx(Yv,{currentUser:k,userMetadata:f,onNavigate:ue,onLogout:we,onNavigateToGymSelection:me,onBack:oe});break;default:r("dashboard"),Q=a.jsx(sd,{currentUser:k,selectedGyms:o,activeGymId:c,onSwitchGym:re,getGymNameById:I,onNavigateToGymSelection:me,onNavigate:ue})}return a.jsxs("div",{className:"font-sans",children:[" ",a.jsxs("div",{className:W?"pb-16":"",children:[" ",Q," "]})," ",V," "]})}return Te()})()}Sh(document.getElementById("root")).render(a.jsx(p.StrictMode,{children:a.jsx(Zv,{})}));export{ex as g};
