(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Mt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ex(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ap(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var dd={exports:{}},fo={},fd={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ys=Symbol.for("react.element"),lp=Symbol.for("react.portal"),up=Symbol.for("react.fragment"),cp=Symbol.for("react.strict_mode"),dp=Symbol.for("react.profiler"),fp=Symbol.for("react.provider"),hp=Symbol.for("react.context"),pp=Symbol.for("react.forward_ref"),mp=Symbol.for("react.suspense"),gp=Symbol.for("react.memo"),yp=Symbol.for("react.lazy"),Au=Symbol.iterator;function vp(e){return e===null||typeof e!="object"?null:(e=Au&&e[Au]||e["@@iterator"],typeof e=="function"?e:null)}var hd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pd=Object.assign,md={};function Xn(e,t,r){this.props=e,this.context=t,this.refs=md,this.updater=r||hd}Xn.prototype.isReactComponent={};Xn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gd(){}gd.prototype=Xn.prototype;function Tl(e,t,r){this.props=e,this.context=t,this.refs=md,this.updater=r||hd}var Ll=Tl.prototype=new gd;Ll.constructor=Tl;pd(Ll,Xn.prototype);Ll.isPureReactComponent=!0;var $u=Array.isArray,yd=Object.prototype.hasOwnProperty,Rl={current:null},vd={key:!0,ref:!0,__self:!0,__source:!0};function xd(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)yd.call(t,n)&&!vd.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Ys,type:e,key:i,ref:o,props:s,_owner:Rl.current}}function xp(e,t){return{$$typeof:Ys,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Al(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ys}function wp(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Ou=/\/+/g;function Vo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wp(""+e.key):t.toString(36)}function Ei(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ys:case lp:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Vo(o,0):n,$u(s)?(r="",e!=null&&(r=e.replace(Ou,"$&/")+"/"),Ei(s,t,r,"",function(c){return c})):s!=null&&(Al(s)&&(s=xp(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ou,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",$u(e))for(var l=0;l<e.length;l++){i=e[l];var u=n+Vo(i,l);o+=Ei(i,t,r,u,s)}else if(u=vp(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=n+Vo(i,l++),o+=Ei(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function oi(e,t,r){if(e==null)return e;var n=[],s=0;return Ei(e,n,"","",function(i){return t.call(r,i,s++)}),n}function _p(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ct={current:null},Ci={transition:null},bp={ReactCurrentDispatcher:ct,ReactCurrentBatchConfig:Ci,ReactCurrentOwner:Rl};function wd(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:oi,forEach:function(e,t,r){oi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return oi(e,function(){t++}),t},toArray:function(e){return oi(e,function(t){return t})||[]},only:function(e){if(!Al(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};de.Component=Xn;de.Fragment=up;de.Profiler=dp;de.PureComponent=Tl;de.StrictMode=cp;de.Suspense=mp;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bp;de.act=wd;de.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=pd({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Rl.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)yd.call(t,u)&&!vd.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:Ys,type:e.type,key:s,ref:i,props:n,_owner:o}};de.createContext=function(e){return e={$$typeof:hp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fp,_context:e},e.Consumer=e};de.createElement=xd;de.createFactory=function(e){var t=xd.bind(null,e);return t.type=e,t};de.createRef=function(){return{current:null}};de.forwardRef=function(e){return{$$typeof:pp,render:e}};de.isValidElement=Al;de.lazy=function(e){return{$$typeof:yp,_payload:{_status:-1,_result:e},_init:_p}};de.memo=function(e,t){return{$$typeof:gp,type:e,compare:t===void 0?null:t}};de.startTransition=function(e){var t=Ci.transition;Ci.transition={};try{e()}finally{Ci.transition=t}};de.unstable_act=wd;de.useCallback=function(e,t){return ct.current.useCallback(e,t)};de.useContext=function(e){return ct.current.useContext(e)};de.useDebugValue=function(){};de.useDeferredValue=function(e){return ct.current.useDeferredValue(e)};de.useEffect=function(e,t){return ct.current.useEffect(e,t)};de.useId=function(){return ct.current.useId()};de.useImperativeHandle=function(e,t,r){return ct.current.useImperativeHandle(e,t,r)};de.useInsertionEffect=function(e,t){return ct.current.useInsertionEffect(e,t)};de.useLayoutEffect=function(e,t){return ct.current.useLayoutEffect(e,t)};de.useMemo=function(e,t){return ct.current.useMemo(e,t)};de.useReducer=function(e,t,r){return ct.current.useReducer(e,t,r)};de.useRef=function(e){return ct.current.useRef(e)};de.useState=function(e){return ct.current.useState(e)};de.useSyncExternalStore=function(e,t,r){return ct.current.useSyncExternalStore(e,t,r)};de.useTransition=function(){return ct.current.useTransition()};de.version="18.3.1";fd.exports=de;var m=fd.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp=m,Sp=Symbol.for("react.element"),jp=Symbol.for("react.fragment"),Np=Object.prototype.hasOwnProperty,Ep=kp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cp={key:!0,ref:!0,__self:!0,__source:!0};function _d(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Np.call(t,n)&&!Cp.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Sp,type:e,key:i,ref:o,props:s,_owner:Ep.current}}fo.Fragment=jp;fo.jsx=_d;fo.jsxs=_d;dd.exports=fo;var a=dd.exports,bd={exports:{}},Ct={},kd={exports:{}},Sd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(w,C){var I=w.length;w.push(C);e:for(;0<I;){var F=I-1>>>1,E=w[F];if(0<s(E,C))w[F]=C,w[I]=E,I=F;else break e}}function r(w){return w.length===0?null:w[0]}function n(w){if(w.length===0)return null;var C=w[0],I=w.pop();if(I!==C){w[0]=I;e:for(var F=0,E=w.length,T=E>>>1;F<T;){var D=2*(F+1)-1,ee=w[D],ue=D+1,pe=w[ue];if(0>s(ee,I))ue<E&&0>s(pe,ee)?(w[F]=pe,w[ue]=I,F=ue):(w[F]=ee,w[D]=I,F=D);else if(ue<E&&0>s(pe,I))w[F]=pe,w[ue]=I,F=ue;else break e}}return C}function s(w,C){var I=w.sortIndex-C.sortIndex;return I!==0?I:w.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,h=null,p=3,v=!1,x=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(w){for(var C=r(c);C!==null;){if(C.callback===null)n(c);else if(C.startTime<=w)n(c),C.sortIndex=C.expirationTime,t(u,C);else break;C=r(c)}}function _(w){if(b=!1,y(w),!x)if(r(u)!==null)x=!0,J(S);else{var C=r(c);C!==null&&ne(_,C.startTime-w)}}function S(w,C){x=!1,b&&(b=!1,g(A),A=-1),v=!0;var I=p;try{for(y(C),h=r(u);h!==null&&(!(h.expirationTime>C)||w&&!j());){var F=h.callback;if(typeof F=="function"){h.callback=null,p=h.priorityLevel;var E=F(h.expirationTime<=C);C=e.unstable_now(),typeof E=="function"?h.callback=E:h===r(u)&&n(u),y(C)}else n(u);h=r(u)}if(h!==null)var T=!0;else{var D=r(c);D!==null&&ne(_,D.startTime-C),T=!1}return T}finally{h=null,p=I,v=!1}}var N=!1,P=null,A=-1,$=5,O=-1;function j(){return!(e.unstable_now()-O<$)}function V(){if(P!==null){var w=e.unstable_now();O=w;var C=!0;try{C=P(!0,w)}finally{C?Y():(N=!1,P=null)}}else N=!1}var Y;if(typeof f=="function")Y=function(){f(V)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,W=Z.port2;Z.port1.onmessage=V,Y=function(){W.postMessage(null)}}else Y=function(){k(V,0)};function J(w){P=w,N||(N=!0,Y())}function ne(w,C){A=k(function(){w(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(w){w.callback=null},e.unstable_continueExecution=function(){x||v||(x=!0,J(S))},e.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<w?Math.floor(1e3/w):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(w){switch(p){case 1:case 2:case 3:var C=3;break;default:C=p}var I=p;p=C;try{return w()}finally{p=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(w,C){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var I=p;p=w;try{return C()}finally{p=I}},e.unstable_scheduleCallback=function(w,C,I){var F=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?F+I:F):I=F,w){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=I+E,w={id:d++,callback:C,priorityLevel:w,startTime:I,expirationTime:E,sortIndex:-1},I>F?(w.sortIndex=I,t(c,w),r(u)===null&&w===r(c)&&(b?(g(A),A=-1):b=!0,ne(_,I-F))):(w.sortIndex=E,t(u,w),x||v||(x=!0,J(S))),w},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(w){var C=p;return function(){var I=p;p=C;try{return w.apply(this,arguments)}finally{p=I}}}})(Sd);kd.exports=Sd;var Pp=kd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tp=m,Et=Pp;function R(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jd=new Set,Rs={};function un(e,t){Bn(e,t),Bn(e+"Capture",t)}function Bn(e,t){for(Rs[e]=t,e=0;e<t.length;e++)jd.add(t[e])}var hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ta=Object.prototype.hasOwnProperty,Lp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zu={},Mu={};function Rp(e){return Ta.call(Mu,e)?!0:Ta.call(zu,e)?!1:Lp.test(e)?Mu[e]=!0:(zu[e]=!0,!1)}function Ap(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $p(e,t,r,n){if(t===null||typeof t>"u"||Ap(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dt(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tt[e]=new dt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tt[t]=new dt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tt[e]=new dt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tt[e]=new dt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tt[e]=new dt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tt[e]=new dt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tt[e]=new dt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tt[e]=new dt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tt[e]=new dt(e,5,!1,e.toLowerCase(),null,!1,!1)});var $l=/[\-:]([a-z])/g;function Ol(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($l,Ol);tt[t]=new dt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tt[e]=new dt(e,1,!1,e.toLowerCase(),null,!1,!1)});tt.xlinkHref=new dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tt[e]=new dt(e,1,!1,e.toLowerCase(),null,!0,!0)});function zl(e,t,r,n){var s=tt.hasOwnProperty(t)?tt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($p(t,r,s,n)&&(r=null),n||s===null?Rp(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var vr=Tp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ai=Symbol.for("react.element"),bn=Symbol.for("react.portal"),kn=Symbol.for("react.fragment"),Ml=Symbol.for("react.strict_mode"),La=Symbol.for("react.profiler"),Nd=Symbol.for("react.provider"),Ed=Symbol.for("react.context"),Il=Symbol.for("react.forward_ref"),Ra=Symbol.for("react.suspense"),Aa=Symbol.for("react.suspense_list"),Fl=Symbol.for("react.memo"),kr=Symbol.for("react.lazy"),Cd=Symbol.for("react.offscreen"),Iu=Symbol.iterator;function os(e){return e===null||typeof e!="object"?null:(e=Iu&&e[Iu]||e["@@iterator"],typeof e=="function"?e:null)}var ze=Object.assign,Ho;function ms(e){if(Ho===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ho=t&&t[1]||""}return`
`+Ho+e}var Go=!1;function qo(e,t){if(!e||Go)return"";Go=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{Go=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ms(e):""}function Op(e){switch(e.tag){case 5:return ms(e.type);case 16:return ms("Lazy");case 13:return ms("Suspense");case 19:return ms("SuspenseList");case 0:case 2:case 15:return e=qo(e.type,!1),e;case 11:return e=qo(e.type.render,!1),e;case 1:return e=qo(e.type,!0),e;default:return""}}function $a(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case kn:return"Fragment";case bn:return"Portal";case La:return"Profiler";case Ml:return"StrictMode";case Ra:return"Suspense";case Aa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ed:return(e.displayName||"Context")+".Consumer";case Nd:return(e._context.displayName||"Context")+".Provider";case Il:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fl:return t=e.displayName||null,t!==null?t:$a(e.type)||"Memo";case kr:t=e._payload,e=e._init;try{return $a(e(t))}catch{}}return null}function zp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $a(t);case 8:return t===Ml?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Pd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mp(e){var t=Pd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function li(e){e._valueTracker||(e._valueTracker=Mp(e))}function Td(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Pd(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Fi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Oa(e,t){var r=t.checked;return ze({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Fu(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Fr(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ld(e,t){t=t.checked,t!=null&&zl(e,"checked",t,!1)}function za(e,t){Ld(e,t);var r=Fr(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ma(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ma(e,t.type,Fr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Du(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ma(e,t,r){(t!=="number"||Fi(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var gs=Array.isArray;function On(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Fr(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Ia(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(R(91));return ze({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Uu(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(R(92));if(gs(r)){if(1<r.length)throw Error(R(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fr(r)}}function Rd(e,t){var r=Fr(t.value),n=Fr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Bu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ad(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fa(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ad(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ui,$d=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ui=ui||document.createElement("div"),ui.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ui.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function As(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ws={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ip=["Webkit","ms","Moz","O"];Object.keys(ws).forEach(function(e){Ip.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ws[t]=ws[e]})});function Od(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ws.hasOwnProperty(e)&&ws[e]?(""+t).trim():t+"px"}function zd(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Od(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var Fp=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Da(e,t){if(t){if(Fp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(R(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(R(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(R(61))}if(t.style!=null&&typeof t.style!="object")throw Error(R(62))}}function Ua(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ba=null;function Dl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Va=null,zn=null,Mn=null;function Vu(e){if(e=ei(e)){if(typeof Va!="function")throw Error(R(280));var t=e.stateNode;t&&(t=yo(t),Va(e.stateNode,e.type,t))}}function Md(e){zn?Mn?Mn.push(e):Mn=[e]:zn=e}function Id(){if(zn){var e=zn,t=Mn;if(Mn=zn=null,Vu(e),t)for(e=0;e<t.length;e++)Vu(t[e])}}function Fd(e,t){return e(t)}function Dd(){}var Wo=!1;function Ud(e,t,r){if(Wo)return e(t,r);Wo=!0;try{return Fd(e,t,r)}finally{Wo=!1,(zn!==null||Mn!==null)&&(Dd(),Id())}}function $s(e,t){var r=e.stateNode;if(r===null)return null;var n=yo(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(R(231,t,typeof r));return r}var Ha=!1;if(hr)try{var as={};Object.defineProperty(as,"passive",{get:function(){Ha=!0}}),window.addEventListener("test",as,as),window.removeEventListener("test",as,as)}catch{Ha=!1}function Dp(e,t,r,n,s,i,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var _s=!1,Di=null,Ui=!1,Ga=null,Up={onError:function(e){_s=!0,Di=e}};function Bp(e,t,r,n,s,i,o,l,u){_s=!1,Di=null,Dp.apply(Up,arguments)}function Vp(e,t,r,n,s,i,o,l,u){if(Bp.apply(this,arguments),_s){if(_s){var c=Di;_s=!1,Di=null}else throw Error(R(198));Ui||(Ui=!0,Ga=c)}}function cn(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Bd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Hu(e){if(cn(e)!==e)throw Error(R(188))}function Hp(e){var t=e.alternate;if(!t){if(t=cn(e),t===null)throw Error(R(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Hu(s),e;if(i===n)return Hu(s),t;i=i.sibling}throw Error(R(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o)throw Error(R(189))}}if(r.alternate!==n)throw Error(R(190))}if(r.tag!==3)throw Error(R(188));return r.stateNode.current===r?e:t}function Vd(e){return e=Hp(e),e!==null?Hd(e):null}function Hd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Hd(e);if(t!==null)return t;e=e.sibling}return null}var Gd=Et.unstable_scheduleCallback,Gu=Et.unstable_cancelCallback,Gp=Et.unstable_shouldYield,qp=Et.unstable_requestPaint,Ue=Et.unstable_now,Wp=Et.unstable_getCurrentPriorityLevel,Ul=Et.unstable_ImmediatePriority,qd=Et.unstable_UserBlockingPriority,Bi=Et.unstable_NormalPriority,Kp=Et.unstable_LowPriority,Wd=Et.unstable_IdlePriority,ho=null,nr=null;function Qp(e){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(ho,e,void 0,(e.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:Xp,Jp=Math.log,Yp=Math.LN2;function Xp(e){return e>>>=0,e===0?32:31-(Jp(e)/Yp|0)|0}var ci=64,di=4194304;function ys(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vi(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=ys(l):(i&=o,i!==0&&(n=ys(i)))}else o=r&~s,o!==0?n=ys(o):i!==0&&(n=ys(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Kt(t),s=1<<r,n|=e[r],t&=~s;return n}function Zp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function em(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Kt(i),l=1<<o,u=s[o];u===-1?(!(l&r)||l&n)&&(s[o]=Zp(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function qa(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Kd(){var e=ci;return ci<<=1,!(ci&4194240)&&(ci=64),e}function Ko(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Xs(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kt(t),e[t]=r}function tm(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Kt(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Bl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Kt(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var _e=0;function Qd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jd,Vl,Yd,Xd,Zd,Wa=!1,fi=[],Lr=null,Rr=null,Ar=null,Os=new Map,zs=new Map,Nr=[],rm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qu(e,t){switch(e){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Rr=null;break;case"mouseover":case"mouseout":Ar=null;break;case"pointerover":case"pointerout":Os.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zs.delete(t.pointerId)}}function ls(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=ei(t),t!==null&&Vl(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function nm(e,t,r,n,s){switch(t){case"focusin":return Lr=ls(Lr,e,t,r,n,s),!0;case"dragenter":return Rr=ls(Rr,e,t,r,n,s),!0;case"mouseover":return Ar=ls(Ar,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Os.set(i,ls(Os.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,zs.set(i,ls(zs.get(i)||null,e,t,r,n,s)),!0}return!1}function ef(e){var t=Yr(e.target);if(t!==null){var r=cn(t);if(r!==null){if(t=r.tag,t===13){if(t=Bd(r),t!==null){e.blockedOn=t,Zd(e.priority,function(){Yd(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ka(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ba=n,r.target.dispatchEvent(n),Ba=null}else return t=ei(r),t!==null&&Vl(t),e.blockedOn=r,!1;t.shift()}return!0}function Wu(e,t,r){Pi(e)&&r.delete(t)}function sm(){Wa=!1,Lr!==null&&Pi(Lr)&&(Lr=null),Rr!==null&&Pi(Rr)&&(Rr=null),Ar!==null&&Pi(Ar)&&(Ar=null),Os.forEach(Wu),zs.forEach(Wu)}function us(e,t){e.blockedOn===t&&(e.blockedOn=null,Wa||(Wa=!0,Et.unstable_scheduleCallback(Et.unstable_NormalPriority,sm)))}function Ms(e){function t(s){return us(s,e)}if(0<fi.length){us(fi[0],e);for(var r=1;r<fi.length;r++){var n=fi[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Lr!==null&&us(Lr,e),Rr!==null&&us(Rr,e),Ar!==null&&us(Ar,e),Os.forEach(t),zs.forEach(t),r=0;r<Nr.length;r++)n=Nr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Nr.length&&(r=Nr[0],r.blockedOn===null);)ef(r),r.blockedOn===null&&Nr.shift()}var In=vr.ReactCurrentBatchConfig,Hi=!0;function im(e,t,r,n){var s=_e,i=In.transition;In.transition=null;try{_e=1,Hl(e,t,r,n)}finally{_e=s,In.transition=i}}function om(e,t,r,n){var s=_e,i=In.transition;In.transition=null;try{_e=4,Hl(e,t,r,n)}finally{_e=s,In.transition=i}}function Hl(e,t,r,n){if(Hi){var s=Ka(e,t,r,n);if(s===null)sa(e,t,n,Gi,r),qu(e,n);else if(nm(s,e,t,r,n))n.stopPropagation();else if(qu(e,n),t&4&&-1<rm.indexOf(e)){for(;s!==null;){var i=ei(s);if(i!==null&&Jd(i),i=Ka(e,t,r,n),i===null&&sa(e,t,n,Gi,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else sa(e,t,n,null,r)}}var Gi=null;function Ka(e,t,r,n){if(Gi=null,e=Dl(n),e=Yr(e),e!==null)if(t=cn(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Bd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gi=e,null}function tf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wp()){case Ul:return 1;case qd:return 4;case Bi:case Kp:return 16;case Wd:return 536870912;default:return 16}default:return 16}}var Pr=null,Gl=null,Ti=null;function rf(){if(Ti)return Ti;var e,t=Gl,r=t.length,n,s="value"in Pr?Pr.value:Pr.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return Ti=s.slice(e,1<n?1-n:void 0)}function Li(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function hi(){return!0}function Ku(){return!1}function Pt(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?hi:Ku,this.isPropagationStopped=Ku,this}return ze(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=hi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=hi)},persist:function(){},isPersistent:hi}),t}var Zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ql=Pt(Zn),Zs=ze({},Zn,{view:0,detail:0}),am=Pt(Zs),Qo,Jo,cs,po=ze({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cs&&(cs&&e.type==="mousemove"?(Qo=e.screenX-cs.screenX,Jo=e.screenY-cs.screenY):Jo=Qo=0,cs=e),Qo)},movementY:function(e){return"movementY"in e?e.movementY:Jo}}),Qu=Pt(po),lm=ze({},po,{dataTransfer:0}),um=Pt(lm),cm=ze({},Zs,{relatedTarget:0}),Yo=Pt(cm),dm=ze({},Zn,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Pt(dm),hm=ze({},Zn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Pt(hm),mm=ze({},Zn,{data:0}),Ju=Pt(mm),gm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ym={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vm[e])?!!t[e]:!1}function Wl(){return xm}var wm=ze({},Zs,{key:function(e){if(e.key){var t=gm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Li(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ym[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wl,charCode:function(e){return e.type==="keypress"?Li(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Li(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_m=Pt(wm),bm=ze({},po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yu=Pt(bm),km=ze({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wl}),Sm=Pt(km),jm=ze({},Zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nm=Pt(jm),Em=ze({},po,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Cm=Pt(Em),Pm=[9,13,27,32],Kl=hr&&"CompositionEvent"in window,bs=null;hr&&"documentMode"in document&&(bs=document.documentMode);var Tm=hr&&"TextEvent"in window&&!bs,nf=hr&&(!Kl||bs&&8<bs&&11>=bs),Xu=" ",Zu=!1;function sf(e,t){switch(e){case"keyup":return Pm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function of(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sn=!1;function Lm(e,t){switch(e){case"compositionend":return of(t);case"keypress":return t.which!==32?null:(Zu=!0,Xu);case"textInput":return e=t.data,e===Xu&&Zu?null:e;default:return null}}function Rm(e,t){if(Sn)return e==="compositionend"||!Kl&&sf(e,t)?(e=rf(),Ti=Gl=Pr=null,Sn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nf&&t.locale!=="ko"?null:t.data;default:return null}}var Am={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ec(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Am[e.type]:t==="textarea"}function af(e,t,r,n){Md(n),t=qi(t,"onChange"),0<t.length&&(r=new ql("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ks=null,Is=null;function $m(e){vf(e,0)}function mo(e){var t=En(e);if(Td(t))return e}function Om(e,t){if(e==="change")return t}var lf=!1;if(hr){var Xo;if(hr){var Zo="oninput"in document;if(!Zo){var tc=document.createElement("div");tc.setAttribute("oninput","return;"),Zo=typeof tc.oninput=="function"}Xo=Zo}else Xo=!1;lf=Xo&&(!document.documentMode||9<document.documentMode)}function rc(){ks&&(ks.detachEvent("onpropertychange",uf),Is=ks=null)}function uf(e){if(e.propertyName==="value"&&mo(Is)){var t=[];af(t,Is,e,Dl(e)),Ud($m,t)}}function zm(e,t,r){e==="focusin"?(rc(),ks=t,Is=r,ks.attachEvent("onpropertychange",uf)):e==="focusout"&&rc()}function Mm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mo(Is)}function Im(e,t){if(e==="click")return mo(t)}function Fm(e,t){if(e==="input"||e==="change")return mo(t)}function Dm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Jt=typeof Object.is=="function"?Object.is:Dm;function Fs(e,t){if(Jt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Ta.call(t,s)||!Jt(e[s],t[s]))return!1}return!0}function nc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sc(e,t){var r=nc(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=nc(r)}}function cf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function df(){for(var e=window,t=Fi();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Fi(e.document)}return t}function Ql(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Um(e){var t=df(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&cf(r.ownerDocument.documentElement,r)){if(n!==null&&Ql(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=sc(r,i);var o=sc(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Bm=hr&&"documentMode"in document&&11>=document.documentMode,jn=null,Qa=null,Ss=null,Ja=!1;function ic(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ja||jn==null||jn!==Fi(n)||(n=jn,"selectionStart"in n&&Ql(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ss&&Fs(Ss,n)||(Ss=n,n=qi(Qa,"onSelect"),0<n.length&&(t=new ql("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=jn)))}function pi(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Nn={animationend:pi("Animation","AnimationEnd"),animationiteration:pi("Animation","AnimationIteration"),animationstart:pi("Animation","AnimationStart"),transitionend:pi("Transition","TransitionEnd")},ea={},ff={};hr&&(ff=document.createElement("div").style,"AnimationEvent"in window||(delete Nn.animationend.animation,delete Nn.animationiteration.animation,delete Nn.animationstart.animation),"TransitionEvent"in window||delete Nn.transitionend.transition);function go(e){if(ea[e])return ea[e];if(!Nn[e])return e;var t=Nn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ff)return ea[e]=t[r];return e}var hf=go("animationend"),pf=go("animationiteration"),mf=go("animationstart"),gf=go("transitionend"),yf=new Map,oc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ur(e,t){yf.set(e,t),un(t,[e])}for(var ta=0;ta<oc.length;ta++){var ra=oc[ta],Vm=ra.toLowerCase(),Hm=ra[0].toUpperCase()+ra.slice(1);Ur(Vm,"on"+Hm)}Ur(hf,"onAnimationEnd");Ur(pf,"onAnimationIteration");Ur(mf,"onAnimationStart");Ur("dblclick","onDoubleClick");Ur("focusin","onFocus");Ur("focusout","onBlur");Ur(gf,"onTransitionEnd");Bn("onMouseEnter",["mouseout","mouseover"]);Bn("onMouseLeave",["mouseout","mouseover"]);Bn("onPointerEnter",["pointerout","pointerover"]);Bn("onPointerLeave",["pointerout","pointerover"]);un("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));un("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));un("onBeforeInput",["compositionend","keypress","textInput","paste"]);un("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));un("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));un("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gm=new Set("cancel close invalid load scroll toggle".split(" ").concat(vs));function ac(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Vp(n,t,void 0,e),e.currentTarget=null}function vf(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;ac(s,l,c),i=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;ac(s,l,c),i=u}}}if(Ui)throw e=Ga,Ui=!1,Ga=null,e}function Ce(e,t){var r=t[tl];r===void 0&&(r=t[tl]=new Set);var n=e+"__bubble";r.has(n)||(xf(t,e,2,!1),r.add(n))}function na(e,t,r){var n=0;t&&(n|=4),xf(r,e,n,t)}var mi="_reactListening"+Math.random().toString(36).slice(2);function Ds(e){if(!e[mi]){e[mi]=!0,jd.forEach(function(r){r!=="selectionchange"&&(Gm.has(r)||na(r,!1,e),na(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mi]||(t[mi]=!0,na("selectionchange",!1,t))}}function xf(e,t,r,n){switch(tf(t)){case 1:var s=im;break;case 4:s=om;break;default:s=Hl}r=s.bind(null,t,r,e),s=void 0,!Ha||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function sa(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Yr(l),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Ud(function(){var c=i,d=Dl(r),h=[];e:{var p=yf.get(e);if(p!==void 0){var v=ql,x=e;switch(e){case"keypress":if(Li(r)===0)break e;case"keydown":case"keyup":v=_m;break;case"focusin":x="focus",v=Yo;break;case"focusout":x="blur",v=Yo;break;case"beforeblur":case"afterblur":v=Yo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Sm;break;case hf:case pf:case mf:v=fm;break;case gf:v=Nm;break;case"scroll":v=am;break;case"wheel":v=Cm;break;case"copy":case"cut":case"paste":v=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Yu}var b=(t&4)!==0,k=!b&&e==="scroll",g=b?p!==null?p+"Capture":null:p;b=[];for(var f=c,y;f!==null;){y=f;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,g!==null&&(_=$s(f,g),_!=null&&b.push(Us(f,_,y)))),k)break;f=f.return}0<b.length&&(p=new v(p,x,null,r,d),h.push({event:p,listeners:b}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",p&&r!==Ba&&(x=r.relatedTarget||r.fromElement)&&(Yr(x)||x[pr]))break e;if((v||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,v?(x=r.relatedTarget||r.toElement,v=c,x=x?Yr(x):null,x!==null&&(k=cn(x),x!==k||x.tag!==5&&x.tag!==6)&&(x=null)):(v=null,x=c),v!==x)){if(b=Qu,_="onMouseLeave",g="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(b=Yu,_="onPointerLeave",g="onPointerEnter",f="pointer"),k=v==null?p:En(v),y=x==null?p:En(x),p=new b(_,f+"leave",v,r,d),p.target=k,p.relatedTarget=y,_=null,Yr(d)===c&&(b=new b(g,f+"enter",x,r,d),b.target=y,b.relatedTarget=k,_=b),k=_,v&&x)t:{for(b=v,g=x,f=0,y=b;y;y=gn(y))f++;for(y=0,_=g;_;_=gn(_))y++;for(;0<f-y;)b=gn(b),f--;for(;0<y-f;)g=gn(g),y--;for(;f--;){if(b===g||g!==null&&b===g.alternate)break t;b=gn(b),g=gn(g)}b=null}else b=null;v!==null&&lc(h,p,v,b,!1),x!==null&&k!==null&&lc(h,k,x,b,!0)}}e:{if(p=c?En(c):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var S=Om;else if(ec(p))if(lf)S=Fm;else{S=Mm;var N=zm}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=Im);if(S&&(S=S(e,c))){af(h,S,r,d);break e}N&&N(e,p,c),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Ma(p,"number",p.value)}switch(N=c?En(c):window,e){case"focusin":(ec(N)||N.contentEditable==="true")&&(jn=N,Qa=c,Ss=null);break;case"focusout":Ss=Qa=jn=null;break;case"mousedown":Ja=!0;break;case"contextmenu":case"mouseup":case"dragend":Ja=!1,ic(h,r,d);break;case"selectionchange":if(Bm)break;case"keydown":case"keyup":ic(h,r,d)}var P;if(Kl)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Sn?sf(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(nf&&r.locale!=="ko"&&(Sn||A!=="onCompositionStart"?A==="onCompositionEnd"&&Sn&&(P=rf()):(Pr=d,Gl="value"in Pr?Pr.value:Pr.textContent,Sn=!0)),N=qi(c,A),0<N.length&&(A=new Ju(A,e,null,r,d),h.push({event:A,listeners:N}),P?A.data=P:(P=of(r),P!==null&&(A.data=P)))),(P=Tm?Lm(e,r):Rm(e,r))&&(c=qi(c,"onBeforeInput"),0<c.length&&(d=new Ju("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=P))}vf(h,t)})}function Us(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qi(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=$s(e,r),i!=null&&n.unshift(Us(e,i,s)),i=$s(e,t),i!=null&&n.push(Us(e,i,s))),e=e.return}return n}function gn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function lc(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,c=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&c!==null&&(l=c,s?(u=$s(r,i),u!=null&&o.unshift(Us(r,u,l))):s||(u=$s(r,i),u!=null&&o.push(Us(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var qm=/\r\n?/g,Wm=/\u0000|\uFFFD/g;function uc(e){return(typeof e=="string"?e:""+e).replace(qm,`
`).replace(Wm,"")}function gi(e,t,r){if(t=uc(t),uc(e)!==t&&r)throw Error(R(425))}function Wi(){}var Ya=null,Xa=null;function Za(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var el=typeof setTimeout=="function"?setTimeout:void 0,Km=typeof clearTimeout=="function"?clearTimeout:void 0,cc=typeof Promise=="function"?Promise:void 0,Qm=typeof queueMicrotask=="function"?queueMicrotask:typeof cc<"u"?function(e){return cc.resolve(null).then(e).catch(Jm)}:el;function Jm(e){setTimeout(function(){throw e})}function ia(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ms(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ms(t)}function $r(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function dc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var es=Math.random().toString(36).slice(2),rr="__reactFiber$"+es,Bs="__reactProps$"+es,pr="__reactContainer$"+es,tl="__reactEvents$"+es,Ym="__reactListeners$"+es,Xm="__reactHandles$"+es;function Yr(e){var t=e[rr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pr]||r[rr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=dc(e);e!==null;){if(r=e[rr])return r;e=dc(e)}return t}e=r,r=e.parentNode}return null}function ei(e){return e=e[rr]||e[pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function En(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(R(33))}function yo(e){return e[Bs]||null}var rl=[],Cn=-1;function Br(e){return{current:e}}function Pe(e){0>Cn||(e.current=rl[Cn],rl[Cn]=null,Cn--)}function je(e,t){Cn++,rl[Cn]=e.current,e.current=t}var Dr={},ot=Br(Dr),yt=Br(!1),rn=Dr;function Vn(e,t){var r=e.type.contextTypes;if(!r)return Dr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function vt(e){return e=e.childContextTypes,e!=null}function Ki(){Pe(yt),Pe(ot)}function fc(e,t,r){if(ot.current!==Dr)throw Error(R(168));je(ot,t),je(yt,r)}function wf(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(R(108,zp(e)||"Unknown",s));return ze({},r,n)}function Qi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Dr,rn=ot.current,je(ot,e),je(yt,yt.current),!0}function hc(e,t,r){var n=e.stateNode;if(!n)throw Error(R(169));r?(e=wf(e,t,rn),n.__reactInternalMemoizedMergedChildContext=e,Pe(yt),Pe(ot),je(ot,e)):Pe(yt),je(yt,r)}var ur=null,vo=!1,oa=!1;function _f(e){ur===null?ur=[e]:ur.push(e)}function Zm(e){vo=!0,_f(e)}function Vr(){if(!oa&&ur!==null){oa=!0;var e=0,t=_e;try{var r=ur;for(_e=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ur=null,vo=!1}catch(s){throw ur!==null&&(ur=ur.slice(e+1)),Gd(Ul,Vr),s}finally{_e=t,oa=!1}}return null}var Pn=[],Tn=0,Ji=null,Yi=0,At=[],$t=0,nn=null,cr=1,dr="";function Wr(e,t){Pn[Tn++]=Yi,Pn[Tn++]=Ji,Ji=e,Yi=t}function bf(e,t,r){At[$t++]=cr,At[$t++]=dr,At[$t++]=nn,nn=e;var n=cr;e=dr;var s=32-Kt(n)-1;n&=~(1<<s),r+=1;var i=32-Kt(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,cr=1<<32-Kt(t)+s|r<<s|n,dr=i+e}else cr=1<<i|r<<s|n,dr=e}function Jl(e){e.return!==null&&(Wr(e,1),bf(e,1,0))}function Yl(e){for(;e===Ji;)Ji=Pn[--Tn],Pn[Tn]=null,Yi=Pn[--Tn],Pn[Tn]=null;for(;e===nn;)nn=At[--$t],At[$t]=null,dr=At[--$t],At[$t]=null,cr=At[--$t],At[$t]=null}var Nt=null,jt=null,Re=!1,Wt=null;function kf(e,t){var r=Ot(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function pc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nt=e,jt=$r(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nt=e,jt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=nn!==null?{id:cr,overflow:dr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ot(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Nt=e,jt=null,!0):!1;default:return!1}}function nl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sl(e){if(Re){var t=jt;if(t){var r=t;if(!pc(e,t)){if(nl(e))throw Error(R(418));t=$r(r.nextSibling);var n=Nt;t&&pc(e,t)?kf(n,r):(e.flags=e.flags&-4097|2,Re=!1,Nt=e)}}else{if(nl(e))throw Error(R(418));e.flags=e.flags&-4097|2,Re=!1,Nt=e}}}function mc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nt=e}function yi(e){if(e!==Nt)return!1;if(!Re)return mc(e),Re=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Za(e.type,e.memoizedProps)),t&&(t=jt)){if(nl(e))throw Sf(),Error(R(418));for(;t;)kf(e,t),t=$r(t.nextSibling)}if(mc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(R(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){jt=$r(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}jt=null}}else jt=Nt?$r(e.stateNode.nextSibling):null;return!0}function Sf(){for(var e=jt;e;)e=$r(e.nextSibling)}function Hn(){jt=Nt=null,Re=!1}function Xl(e){Wt===null?Wt=[e]:Wt.push(e)}var eg=vr.ReactCurrentBatchConfig;function ds(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(R(309));var n=r.stateNode}if(!n)throw Error(R(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(R(284));if(!r._owner)throw Error(R(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(R(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gc(e){var t=e._init;return t(e._payload)}function jf(e){function t(g,f){if(e){var y=g.deletions;y===null?(g.deletions=[f],g.flags|=16):y.push(f)}}function r(g,f){if(!e)return null;for(;f!==null;)t(g,f),f=f.sibling;return null}function n(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function s(g,f){return g=Ir(g,f),g.index=0,g.sibling=null,g}function i(g,f,y){return g.index=y,e?(y=g.alternate,y!==null?(y=y.index,y<f?(g.flags|=2,f):y):(g.flags|=2,f)):(g.flags|=1048576,f)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,f,y,_){return f===null||f.tag!==6?(f=ha(y,g.mode,_),f.return=g,f):(f=s(f,y),f.return=g,f)}function u(g,f,y,_){var S=y.type;return S===kn?d(g,f,y.props.children,_,y.key):f!==null&&(f.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===kr&&gc(S)===f.type)?(_=s(f,y.props),_.ref=ds(g,f,y),_.return=g,_):(_=Ii(y.type,y.key,y.props,null,g.mode,_),_.ref=ds(g,f,y),_.return=g,_)}function c(g,f,y,_){return f===null||f.tag!==4||f.stateNode.containerInfo!==y.containerInfo||f.stateNode.implementation!==y.implementation?(f=pa(y,g.mode,_),f.return=g,f):(f=s(f,y.children||[]),f.return=g,f)}function d(g,f,y,_,S){return f===null||f.tag!==7?(f=tn(y,g.mode,_,S),f.return=g,f):(f=s(f,y),f.return=g,f)}function h(g,f,y){if(typeof f=="string"&&f!==""||typeof f=="number")return f=ha(""+f,g.mode,y),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case ai:return y=Ii(f.type,f.key,f.props,null,g.mode,y),y.ref=ds(g,null,f),y.return=g,y;case bn:return f=pa(f,g.mode,y),f.return=g,f;case kr:var _=f._init;return h(g,_(f._payload),y)}if(gs(f)||os(f))return f=tn(f,g.mode,y,null),f.return=g,f;vi(g,f)}return null}function p(g,f,y,_){var S=f!==null?f.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(g,f,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ai:return y.key===S?u(g,f,y,_):null;case bn:return y.key===S?c(g,f,y,_):null;case kr:return S=y._init,p(g,f,S(y._payload),_)}if(gs(y)||os(y))return S!==null?null:d(g,f,y,_,null);vi(g,y)}return null}function v(g,f,y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(y)||null,l(f,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ai:return g=g.get(_.key===null?y:_.key)||null,u(f,g,_,S);case bn:return g=g.get(_.key===null?y:_.key)||null,c(f,g,_,S);case kr:var N=_._init;return v(g,f,y,N(_._payload),S)}if(gs(_)||os(_))return g=g.get(y)||null,d(f,g,_,S,null);vi(f,_)}return null}function x(g,f,y,_){for(var S=null,N=null,P=f,A=f=0,$=null;P!==null&&A<y.length;A++){P.index>A?($=P,P=null):$=P.sibling;var O=p(g,P,y[A],_);if(O===null){P===null&&(P=$);break}e&&P&&O.alternate===null&&t(g,P),f=i(O,f,A),N===null?S=O:N.sibling=O,N=O,P=$}if(A===y.length)return r(g,P),Re&&Wr(g,A),S;if(P===null){for(;A<y.length;A++)P=h(g,y[A],_),P!==null&&(f=i(P,f,A),N===null?S=P:N.sibling=P,N=P);return Re&&Wr(g,A),S}for(P=n(g,P);A<y.length;A++)$=v(P,g,A,y[A],_),$!==null&&(e&&$.alternate!==null&&P.delete($.key===null?A:$.key),f=i($,f,A),N===null?S=$:N.sibling=$,N=$);return e&&P.forEach(function(j){return t(g,j)}),Re&&Wr(g,A),S}function b(g,f,y,_){var S=os(y);if(typeof S!="function")throw Error(R(150));if(y=S.call(y),y==null)throw Error(R(151));for(var N=S=null,P=f,A=f=0,$=null,O=y.next();P!==null&&!O.done;A++,O=y.next()){P.index>A?($=P,P=null):$=P.sibling;var j=p(g,P,O.value,_);if(j===null){P===null&&(P=$);break}e&&P&&j.alternate===null&&t(g,P),f=i(j,f,A),N===null?S=j:N.sibling=j,N=j,P=$}if(O.done)return r(g,P),Re&&Wr(g,A),S;if(P===null){for(;!O.done;A++,O=y.next())O=h(g,O.value,_),O!==null&&(f=i(O,f,A),N===null?S=O:N.sibling=O,N=O);return Re&&Wr(g,A),S}for(P=n(g,P);!O.done;A++,O=y.next())O=v(P,g,A,O.value,_),O!==null&&(e&&O.alternate!==null&&P.delete(O.key===null?A:O.key),f=i(O,f,A),N===null?S=O:N.sibling=O,N=O);return e&&P.forEach(function(V){return t(g,V)}),Re&&Wr(g,A),S}function k(g,f,y,_){if(typeof y=="object"&&y!==null&&y.type===kn&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ai:e:{for(var S=y.key,N=f;N!==null;){if(N.key===S){if(S=y.type,S===kn){if(N.tag===7){r(g,N.sibling),f=s(N,y.props.children),f.return=g,g=f;break e}}else if(N.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===kr&&gc(S)===N.type){r(g,N.sibling),f=s(N,y.props),f.ref=ds(g,N,y),f.return=g,g=f;break e}r(g,N);break}else t(g,N);N=N.sibling}y.type===kn?(f=tn(y.props.children,g.mode,_,y.key),f.return=g,g=f):(_=Ii(y.type,y.key,y.props,null,g.mode,_),_.ref=ds(g,f,y),_.return=g,g=_)}return o(g);case bn:e:{for(N=y.key;f!==null;){if(f.key===N)if(f.tag===4&&f.stateNode.containerInfo===y.containerInfo&&f.stateNode.implementation===y.implementation){r(g,f.sibling),f=s(f,y.children||[]),f.return=g,g=f;break e}else{r(g,f);break}else t(g,f);f=f.sibling}f=pa(y,g.mode,_),f.return=g,g=f}return o(g);case kr:return N=y._init,k(g,f,N(y._payload),_)}if(gs(y))return x(g,f,y,_);if(os(y))return b(g,f,y,_);vi(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,f!==null&&f.tag===6?(r(g,f.sibling),f=s(f,y),f.return=g,g=f):(r(g,f),f=ha(y,g.mode,_),f.return=g,g=f),o(g)):r(g,f)}return k}var Gn=jf(!0),Nf=jf(!1),Xi=Br(null),Zi=null,Ln=null,Zl=null;function eu(){Zl=Ln=Zi=null}function tu(e){var t=Xi.current;Pe(Xi),e._currentValue=t}function il(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Fn(e,t){Zi=e,Zl=Ln=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gt=!0),e.firstContext=null)}function It(e){var t=e._currentValue;if(Zl!==e)if(e={context:e,memoizedValue:t,next:null},Ln===null){if(Zi===null)throw Error(R(308));Ln=e,Zi.dependencies={lanes:0,firstContext:e}}else Ln=Ln.next=e;return t}var Xr=null;function ru(e){Xr===null?Xr=[e]:Xr.push(e)}function Ef(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,ru(t)):(r.next=s.next,s.next=r),t.interleaved=r,mr(e,n)}function mr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sr=!1;function nu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Or(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ye&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,mr(e,r)}return s=n.interleaved,s===null?(t.next=t,ru(n)):(t.next=s.next,s.next=t),n.interleaved=t,mr(e,r)}function Ri(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Bl(e,r)}}function yc(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function eo(e,t,r,n){var s=e.updateQueue;Sr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?i=c:o.next=c,o=u;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;o=0,d=c=u=null,l=i;do{var p=l.lane,v=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(p=t,v=r,b.tag){case 1:if(x=b.payload,typeof x=="function"){h=x.call(v,h,p);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,p=typeof x=="function"?x.call(v,h,p):x,p==null)break e;h=ze({},h,p);break e;case 2:Sr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else v={eventTime:v,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=v,u=h):d=d.next=v,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);on|=o,e.lanes=o,e.memoizedState=h}}function vc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(R(191,s));s.call(n)}}}var ti={},sr=Br(ti),Vs=Br(ti),Hs=Br(ti);function Zr(e){if(e===ti)throw Error(R(174));return e}function su(e,t){switch(je(Hs,t),je(Vs,e),je(sr,ti),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Fa(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Fa(t,e)}Pe(sr),je(sr,t)}function qn(){Pe(sr),Pe(Vs),Pe(Hs)}function Pf(e){Zr(Hs.current);var t=Zr(sr.current),r=Fa(t,e.type);t!==r&&(je(Vs,e),je(sr,r))}function iu(e){Vs.current===e&&(Pe(sr),Pe(Vs))}var $e=Br(0);function to(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var aa=[];function ou(){for(var e=0;e<aa.length;e++)aa[e]._workInProgressVersionPrimary=null;aa.length=0}var Ai=vr.ReactCurrentDispatcher,la=vr.ReactCurrentBatchConfig,sn=0,Oe=null,We=null,Je=null,ro=!1,js=!1,Gs=0,tg=0;function nt(){throw Error(R(321))}function au(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Jt(e[r],t[r]))return!1;return!0}function lu(e,t,r,n,s,i){if(sn=i,Oe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ai.current=e===null||e.memoizedState===null?ig:og,e=r(n,s),js){i=0;do{if(js=!1,Gs=0,25<=i)throw Error(R(301));i+=1,Je=We=null,t.updateQueue=null,Ai.current=ag,e=r(n,s)}while(js)}if(Ai.current=no,t=We!==null&&We.next!==null,sn=0,Je=We=Oe=null,ro=!1,t)throw Error(R(300));return e}function uu(){var e=Gs!==0;return Gs=0,e}function tr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?Oe.memoizedState=Je=e:Je=Je.next=e,Je}function Ft(){if(We===null){var e=Oe.alternate;e=e!==null?e.memoizedState:null}else e=We.next;var t=Je===null?Oe.memoizedState:Je.next;if(t!==null)Je=t,We=e;else{if(e===null)throw Error(R(310));We=e,e={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Je===null?Oe.memoizedState=Je=e:Je=Je.next=e}return Je}function qs(e,t){return typeof t=="function"?t(e):t}function ua(e){var t=Ft(),r=t.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=e;var n=We,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=o=null,u=null,c=i;do{var d=c.lane;if((sn&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,o=n):u=u.next=h,Oe.lanes|=d,on|=d}c=c.next}while(c!==null&&c!==i);u===null?o=n:u.next=l,Jt(n,t.memoizedState)||(gt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Oe.lanes|=i,on|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ca(e){var t=Ft(),r=t.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Jt(i,t.memoizedState)||(gt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Tf(){}function Lf(e,t){var r=Oe,n=Ft(),s=t(),i=!Jt(n.memoizedState,s);if(i&&(n.memoizedState=s,gt=!0),n=n.queue,cu($f.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Je!==null&&Je.memoizedState.tag&1){if(r.flags|=2048,Ws(9,Af.bind(null,r,n,s,t),void 0,null),Ye===null)throw Error(R(349));sn&30||Rf(r,t,s)}return s}function Rf(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Af(e,t,r,n){t.value=r,t.getSnapshot=n,Of(t)&&zf(e)}function $f(e,t,r){return r(function(){Of(t)&&zf(e)})}function Of(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Jt(e,r)}catch{return!0}}function zf(e){var t=mr(e,1);t!==null&&Qt(t,e,1,-1)}function xc(e){var t=tr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:e},t.queue=e,e=e.dispatch=sg.bind(null,Oe,e),[t.memoizedState,e]}function Ws(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Mf(){return Ft().memoizedState}function $i(e,t,r,n){var s=tr();Oe.flags|=e,s.memoizedState=Ws(1|t,r,void 0,n===void 0?null:n)}function xo(e,t,r,n){var s=Ft();n=n===void 0?null:n;var i=void 0;if(We!==null){var o=We.memoizedState;if(i=o.destroy,n!==null&&au(n,o.deps)){s.memoizedState=Ws(t,r,i,n);return}}Oe.flags|=e,s.memoizedState=Ws(1|t,r,i,n)}function wc(e,t){return $i(8390656,8,e,t)}function cu(e,t){return xo(2048,8,e,t)}function If(e,t){return xo(4,2,e,t)}function Ff(e,t){return xo(4,4,e,t)}function Df(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Uf(e,t,r){return r=r!=null?r.concat([e]):null,xo(4,4,Df.bind(null,t,e),r)}function du(){}function Bf(e,t){var r=Ft();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&au(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Vf(e,t){var r=Ft();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&au(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Hf(e,t,r){return sn&21?(Jt(r,t)||(r=Kd(),Oe.lanes|=r,on|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gt=!0),e.memoizedState=r)}function rg(e,t){var r=_e;_e=r!==0&&4>r?r:4,e(!0);var n=la.transition;la.transition={};try{e(!1),t()}finally{_e=r,la.transition=n}}function Gf(){return Ft().memoizedState}function ng(e,t,r){var n=Mr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qf(e))Wf(t,r);else if(r=Ef(e,t,r,n),r!==null){var s=ut();Qt(r,e,n,s),Kf(r,t,n)}}function sg(e,t,r){var n=Mr(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qf(e))Wf(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,Jt(l,o)){var u=t.interleaved;u===null?(s.next=s,ru(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=Ef(e,t,s,n),r!==null&&(s=ut(),Qt(r,e,n,s),Kf(r,t,n))}}function qf(e){var t=e.alternate;return e===Oe||t!==null&&t===Oe}function Wf(e,t){js=ro=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Kf(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Bl(e,r)}}var no={readContext:It,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useInsertionEffect:nt,useLayoutEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useMutableSource:nt,useSyncExternalStore:nt,useId:nt,unstable_isNewReconciler:!1},ig={readContext:It,useCallback:function(e,t){return tr().memoizedState=[e,t===void 0?null:t],e},useContext:It,useEffect:wc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,$i(4194308,4,Df.bind(null,t,e),r)},useLayoutEffect:function(e,t){return $i(4194308,4,e,t)},useInsertionEffect:function(e,t){return $i(4,2,e,t)},useMemo:function(e,t){var r=tr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=tr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ng.bind(null,Oe,e),[n.memoizedState,e]},useRef:function(e){var t=tr();return e={current:e},t.memoizedState=e},useState:xc,useDebugValue:du,useDeferredValue:function(e){return tr().memoizedState=e},useTransition:function(){var e=xc(!1),t=e[0];return e=rg.bind(null,e[1]),tr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Oe,s=tr();if(Re){if(r===void 0)throw Error(R(407));r=r()}else{if(r=t(),Ye===null)throw Error(R(349));sn&30||Rf(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,wc($f.bind(null,n,i,e),[e]),n.flags|=2048,Ws(9,Af.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=tr(),t=Ye.identifierPrefix;if(Re){var r=dr,n=cr;r=(n&~(1<<32-Kt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Gs++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=tg++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},og={readContext:It,useCallback:Bf,useContext:It,useEffect:cu,useImperativeHandle:Uf,useInsertionEffect:If,useLayoutEffect:Ff,useMemo:Vf,useReducer:ua,useRef:Mf,useState:function(){return ua(qs)},useDebugValue:du,useDeferredValue:function(e){var t=Ft();return Hf(t,We.memoizedState,e)},useTransition:function(){var e=ua(qs)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:Tf,useSyncExternalStore:Lf,useId:Gf,unstable_isNewReconciler:!1},ag={readContext:It,useCallback:Bf,useContext:It,useEffect:cu,useImperativeHandle:Uf,useInsertionEffect:If,useLayoutEffect:Ff,useMemo:Vf,useReducer:ca,useRef:Mf,useState:function(){return ca(qs)},useDebugValue:du,useDeferredValue:function(e){var t=Ft();return We===null?t.memoizedState=e:Hf(t,We.memoizedState,e)},useTransition:function(){var e=ca(qs)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:Tf,useSyncExternalStore:Lf,useId:Gf,unstable_isNewReconciler:!1};function Ht(e,t){if(e&&e.defaultProps){t=ze({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ol(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ze({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var wo={isMounted:function(e){return(e=e._reactInternals)?cn(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ut(),s=Mr(e),i=fr(n,s);i.payload=t,r!=null&&(i.callback=r),t=Or(e,i,s),t!==null&&(Qt(t,e,s,n),Ri(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ut(),s=Mr(e),i=fr(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Or(e,i,s),t!==null&&(Qt(t,e,s,n),Ri(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ut(),n=Mr(e),s=fr(r,n);s.tag=2,t!=null&&(s.callback=t),t=Or(e,s,n),t!==null&&(Qt(t,e,n,r),Ri(t,e,n))}};function _c(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Fs(r,n)||!Fs(s,i):!0}function Qf(e,t,r){var n=!1,s=Dr,i=t.contextType;return typeof i=="object"&&i!==null?i=It(i):(s=vt(t)?rn:ot.current,n=t.contextTypes,i=(n=n!=null)?Vn(e,s):Dr),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=wo,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function bc(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&wo.enqueueReplaceState(t,t.state,null)}function al(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},nu(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=It(i):(i=vt(t)?rn:ot.current,s.context=Vn(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ol(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&wo.enqueueReplaceState(s,s.state,null),eo(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Wn(e,t){try{var r="",n=t;do r+=Op(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function da(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ll(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var lg=typeof WeakMap=="function"?WeakMap:Map;function Jf(e,t,r){r=fr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){io||(io=!0,vl=n),ll(e,t)},r}function Yf(e,t,r){r=fr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ll(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ll(e,t),typeof n!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function kc(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new lg;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=bg.bind(null,e,t,r),t.then(e,e))}function Sc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jc(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fr(-1,1),t.tag=2,Or(r,t,1))),r.lanes|=1),e)}var ug=vr.ReactCurrentOwner,gt=!1;function lt(e,t,r,n){t.child=e===null?Nf(t,null,r,n):Gn(t,e.child,r,n)}function Nc(e,t,r,n,s){r=r.render;var i=t.ref;return Fn(t,s),n=lu(e,t,r,n,i,s),r=uu(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gr(e,t,s)):(Re&&r&&Jl(t),t.flags|=1,lt(e,t,n,s),t.child)}function Ec(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!xu(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Xf(e,t,i,n,s)):(e=Ii(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Fs,r(o,n)&&e.ref===t.ref)return gr(e,t,s)}return t.flags|=1,e=Ir(i,n),e.ref=t.ref,e.return=t,t.child=e}function Xf(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Fs(i,n)&&e.ref===t.ref)if(gt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(gt=!0);else return t.lanes=e.lanes,gr(e,t,s)}return ul(e,t,r,n,s)}function Zf(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(An,St),St|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,je(An,St),St|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,je(An,St),St|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,je(An,St),St|=n;return lt(e,t,s,r),t.child}function eh(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ul(e,t,r,n,s){var i=vt(r)?rn:ot.current;return i=Vn(t,i),Fn(t,s),r=lu(e,t,r,n,i,s),n=uu(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gr(e,t,s)):(Re&&n&&Jl(t),t.flags|=1,lt(e,t,r,s),t.child)}function Cc(e,t,r,n,s){if(vt(r)){var i=!0;Qi(t)}else i=!1;if(Fn(t,s),t.stateNode===null)Oi(e,t),Qf(t,r,n),al(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=It(c):(c=vt(r)?rn:ot.current,c=Vn(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==c)&&bc(t,o,n,c),Sr=!1;var p=t.memoizedState;o.state=p,eo(t,n,o,s),u=t.memoizedState,l!==n||p!==u||yt.current||Sr?(typeof d=="function"&&(ol(t,r,d,n),u=t.memoizedState),(l=Sr||_c(t,r,l,n,p,u,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=c,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Cf(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:Ht(t.type,l),o.props=c,h=t.pendingProps,p=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=It(u):(u=vt(r)?rn:ot.current,u=Vn(t,u));var v=r.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==u)&&bc(t,o,n,u),Sr=!1,p=t.memoizedState,o.state=p,eo(t,n,o,s);var x=t.memoizedState;l!==h||p!==x||yt.current||Sr?(typeof v=="function"&&(ol(t,r,v,n),x=t.memoizedState),(c=Sr||_c(t,r,c,n,p,x,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,x,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,x,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),o.props=n,o.state=x,o.context=u,n=c):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return cl(e,t,r,n,i,s)}function cl(e,t,r,n,s,i){eh(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&hc(t,r,!1),gr(e,t,i);n=t.stateNode,ug.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Gn(t,e.child,null,i),t.child=Gn(t,null,l,i)):lt(e,t,l,i),t.memoizedState=n.state,s&&hc(t,r,!0),t.child}function th(e){var t=e.stateNode;t.pendingContext?fc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&fc(e,t.context,!1),su(e,t.containerInfo)}function Pc(e,t,r,n,s){return Hn(),Xl(s),t.flags|=256,lt(e,t,r,n),t.child}var dl={dehydrated:null,treeContext:null,retryLane:0};function fl(e){return{baseLanes:e,cachePool:null,transitions:null}}function rh(e,t,r){var n=t.pendingProps,s=$e.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),je($e,s&1),e===null)return sl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ko(o,n,0,null),e=tn(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=fl(r),t.memoizedState=dl,e):fu(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return cg(e,t,o,n,l,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,l=s.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=Ir(s,u),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ir(l,i):(i=tn(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?fl(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=dl,n}return i=e.child,e=i.sibling,n=Ir(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function fu(e,t){return t=ko({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xi(e,t,r,n){return n!==null&&Xl(n),Gn(t,e.child,null,r),e=fu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function cg(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=da(Error(R(422))),xi(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=ko({mode:"visible",children:n.children},s,0,null),i=tn(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Gn(t,e.child,null,o),t.child.memoizedState=fl(o),t.memoizedState=dl,i);if(!(t.mode&1))return xi(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(R(419)),n=da(i,n,void 0),xi(e,t,o,n)}if(l=(o&e.childLanes)!==0,gt||l){if(n=Ye,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,mr(e,s),Qt(n,e,s,-1))}return vu(),n=da(Error(R(421))),xi(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kg.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,jt=$r(s.nextSibling),Nt=t,Re=!0,Wt=null,e!==null&&(At[$t++]=cr,At[$t++]=dr,At[$t++]=nn,cr=e.id,dr=e.overflow,nn=t),t=fu(t,n.children),t.flags|=4096,t)}function Tc(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),il(e.return,t,r)}function fa(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function nh(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(lt(e,t,n.children,r),n=$e.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Tc(e,r,t);else if(e.tag===19)Tc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(je($e,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&to(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),fa(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&to(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}fa(t,!0,r,null,i);break;case"together":fa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Oi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),on|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(R(153));if(t.child!==null){for(e=t.child,r=Ir(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ir(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function dg(e,t,r){switch(t.tag){case 3:th(t),Hn();break;case 5:Pf(t);break;case 1:vt(t.type)&&Qi(t);break;case 4:su(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;je(Xi,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(je($e,$e.current&1),t.flags|=128,null):r&t.child.childLanes?rh(e,t,r):(je($e,$e.current&1),e=gr(e,t,r),e!==null?e.sibling:null);je($e,$e.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return nh(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),je($e,$e.current),n)break;return null;case 22:case 23:return t.lanes=0,Zf(e,t,r)}return gr(e,t,r)}var sh,hl,ih,oh;sh=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hl=function(){};ih=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Zr(sr.current);var i=null;switch(r){case"input":s=Oa(e,s),n=Oa(e,n),i=[];break;case"select":s=ze({},s,{value:void 0}),n=ze({},n,{value:void 0}),i=[];break;case"textarea":s=Ia(e,s),n=Ia(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wi)}Da(r,n);var o;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Rs.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(l=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Rs.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Ce("scroll",e),i||l===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};oh=function(e,t,r,n){r!==n&&(t.flags|=4)};function fs(e,t){if(!Re)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function st(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function fg(e,t,r){var n=t.pendingProps;switch(Yl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(t),null;case 1:return vt(t.type)&&Ki(),st(t),null;case 3:return n=t.stateNode,qn(),Pe(yt),Pe(ot),ou(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wt!==null&&(_l(Wt),Wt=null))),hl(e,t),st(t),null;case 5:iu(t);var s=Zr(Hs.current);if(r=t.type,e!==null&&t.stateNode!=null)ih(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(R(166));return st(t),null}if(e=Zr(sr.current),yi(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[rr]=t,n[Bs]=i,e=(t.mode&1)!==0,r){case"dialog":Ce("cancel",n),Ce("close",n);break;case"iframe":case"object":case"embed":Ce("load",n);break;case"video":case"audio":for(s=0;s<vs.length;s++)Ce(vs[s],n);break;case"source":Ce("error",n);break;case"img":case"image":case"link":Ce("error",n),Ce("load",n);break;case"details":Ce("toggle",n);break;case"input":Fu(n,i),Ce("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ce("invalid",n);break;case"textarea":Uu(n,i),Ce("invalid",n)}Da(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&gi(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&gi(n.textContent,l,e),s=["children",""+l]):Rs.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ce("scroll",n)}switch(r){case"input":li(n),Du(n,i,!0);break;case"textarea":li(n),Bu(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Wi)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ad(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[rr]=t,e[Bs]=n,sh(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ua(r,n),r){case"dialog":Ce("cancel",e),Ce("close",e),s=n;break;case"iframe":case"object":case"embed":Ce("load",e),s=n;break;case"video":case"audio":for(s=0;s<vs.length;s++)Ce(vs[s],e);s=n;break;case"source":Ce("error",e),s=n;break;case"img":case"image":case"link":Ce("error",e),Ce("load",e),s=n;break;case"details":Ce("toggle",e),s=n;break;case"input":Fu(e,n),s=Oa(e,n),Ce("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=ze({},n,{value:void 0}),Ce("invalid",e);break;case"textarea":Uu(e,n),s=Ia(e,n),Ce("invalid",e);break;default:s=n}Da(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?zd(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&$d(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&As(e,u):typeof u=="number"&&As(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Rs.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ce("scroll",e):u!=null&&zl(e,i,u,o))}switch(r){case"input":li(e),Du(e,n,!1);break;case"textarea":li(e),Bu(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Fr(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?On(e,!!n.multiple,i,!1):n.defaultValue!=null&&On(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wi)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return st(t),null;case 6:if(e&&t.stateNode!=null)oh(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(R(166));if(r=Zr(Hs.current),Zr(sr.current),yi(t)){if(n=t.stateNode,r=t.memoizedProps,n[rr]=t,(i=n.nodeValue!==r)&&(e=Nt,e!==null))switch(e.tag){case 3:gi(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&gi(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[rr]=t,t.stateNode=n}return st(t),null;case 13:if(Pe($e),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Re&&jt!==null&&t.mode&1&&!(t.flags&128))Sf(),Hn(),t.flags|=98560,i=!1;else if(i=yi(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(R(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));i[rr]=t}else Hn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;st(t),i=!1}else Wt!==null&&(_l(Wt),Wt=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||$e.current&1?Ke===0&&(Ke=3):vu())),t.updateQueue!==null&&(t.flags|=4),st(t),null);case 4:return qn(),hl(e,t),e===null&&Ds(t.stateNode.containerInfo),st(t),null;case 10:return tu(t.type._context),st(t),null;case 17:return vt(t.type)&&Ki(),st(t),null;case 19:if(Pe($e),i=t.memoizedState,i===null)return st(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)fs(i,!1);else{if(Ke!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=to(e),o!==null){for(t.flags|=128,fs(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return je($e,$e.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ue()>Kn&&(t.flags|=128,n=!0,fs(i,!1),t.lanes=4194304)}else{if(!n)if(e=to(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),fs(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Re)return st(t),null}else 2*Ue()-i.renderingStartTime>Kn&&r!==1073741824&&(t.flags|=128,n=!0,fs(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ue(),t.sibling=null,r=$e.current,je($e,n?r&1|2:r&1),t):(st(t),null);case 22:case 23:return yu(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?St&1073741824&&(st(t),t.subtreeFlags&6&&(t.flags|=8192)):st(t),null;case 24:return null;case 25:return null}throw Error(R(156,t.tag))}function hg(e,t){switch(Yl(t),t.tag){case 1:return vt(t.type)&&Ki(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return qn(),Pe(yt),Pe(ot),ou(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return iu(t),null;case 13:if(Pe($e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(R(340));Hn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Pe($e),null;case 4:return qn(),null;case 10:return tu(t.type._context),null;case 22:case 23:return yu(),null;case 24:return null;default:return null}}var wi=!1,it=!1,pg=typeof WeakSet=="function"?WeakSet:Set,G=null;function Rn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Fe(e,t,n)}else r.current=null}function pl(e,t,r){try{r()}catch(n){Fe(e,t,n)}}var Lc=!1;function mg(e,t){if(Ya=Hi,e=df(),Ql(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var v;h!==r||s!==0&&h.nodeType!==3||(l=o+s),h!==i||n!==0&&h.nodeType!==3||(u=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)p=h,h=v;for(;;){if(h===e)break t;if(p===r&&++c===s&&(l=o),p===i&&++d===n&&(u=o),(v=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=v}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xa={focusedElem:e,selectionRange:r},Hi=!1,G=t;G!==null;)if(t=G,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,G=e;else for(;G!==null;){t=G;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,k=x.memoizedState,g=t.stateNode,f=g.getSnapshotBeforeUpdate(t.elementType===t.type?b:Ht(t.type,b),k);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(_){Fe(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,G=e;break}G=t.return}return x=Lc,Lc=!1,x}function Ns(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&pl(t,r,i)}s=s.next}while(s!==n)}}function _o(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ml(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ah(e){var t=e.alternate;t!==null&&(e.alternate=null,ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[rr],delete t[Bs],delete t[tl],delete t[Ym],delete t[Xm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lh(e){return e.tag===5||e.tag===3||e.tag===4}function Rc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wi));else if(n!==4&&(e=e.child,e!==null))for(gl(e,t,r),e=e.sibling;e!==null;)gl(e,t,r),e=e.sibling}function yl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(yl(e,t,r),e=e.sibling;e!==null;)yl(e,t,r),e=e.sibling}var Ze=null,Gt=!1;function wr(e,t,r){for(r=r.child;r!==null;)uh(e,t,r),r=r.sibling}function uh(e,t,r){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(ho,r)}catch{}switch(r.tag){case 5:it||Rn(r,t);case 6:var n=Ze,s=Gt;Ze=null,wr(e,t,r),Ze=n,Gt=s,Ze!==null&&(Gt?(e=Ze,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ze.removeChild(r.stateNode));break;case 18:Ze!==null&&(Gt?(e=Ze,r=r.stateNode,e.nodeType===8?ia(e.parentNode,r):e.nodeType===1&&ia(e,r),Ms(e)):ia(Ze,r.stateNode));break;case 4:n=Ze,s=Gt,Ze=r.stateNode.containerInfo,Gt=!0,wr(e,t,r),Ze=n,Gt=s;break;case 0:case 11:case 14:case 15:if(!it&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&pl(r,t,o),s=s.next}while(s!==n)}wr(e,t,r);break;case 1:if(!it&&(Rn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Fe(r,t,l)}wr(e,t,r);break;case 21:wr(e,t,r);break;case 22:r.mode&1?(it=(n=it)||r.memoizedState!==null,wr(e,t,r),it=n):wr(e,t,r);break;default:wr(e,t,r)}}function Ac(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pg),t.forEach(function(n){var s=Sg.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Vt(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ze=l.stateNode,Gt=!1;break e;case 3:Ze=l.stateNode.containerInfo,Gt=!0;break e;case 4:Ze=l.stateNode.containerInfo,Gt=!0;break e}l=l.return}if(Ze===null)throw Error(R(160));uh(i,o,s),Ze=null,Gt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Fe(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ch(t,e),t=t.sibling}function ch(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vt(t,e),Zt(e),n&4){try{Ns(3,e,e.return),_o(3,e)}catch(b){Fe(e,e.return,b)}try{Ns(5,e,e.return)}catch(b){Fe(e,e.return,b)}}break;case 1:Vt(t,e),Zt(e),n&512&&r!==null&&Rn(r,r.return);break;case 5:if(Vt(t,e),Zt(e),n&512&&r!==null&&Rn(r,r.return),e.flags&32){var s=e.stateNode;try{As(s,"")}catch(b){Fe(e,e.return,b)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Ld(s,i),Ua(l,o);var c=Ua(l,i);for(o=0;o<u.length;o+=2){var d=u[o],h=u[o+1];d==="style"?zd(s,h):d==="dangerouslySetInnerHTML"?$d(s,h):d==="children"?As(s,h):zl(s,d,h,c)}switch(l){case"input":za(s,i);break;case"textarea":Rd(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?On(s,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?On(s,!!i.multiple,i.defaultValue,!0):On(s,!!i.multiple,i.multiple?[]:"",!1))}s[Bs]=i}catch(b){Fe(e,e.return,b)}}break;case 6:if(Vt(t,e),Zt(e),n&4){if(e.stateNode===null)throw Error(R(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){Fe(e,e.return,b)}}break;case 3:if(Vt(t,e),Zt(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ms(t.containerInfo)}catch(b){Fe(e,e.return,b)}break;case 4:Vt(t,e),Zt(e);break;case 13:Vt(t,e),Zt(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(mu=Ue())),n&4&&Ac(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(it=(c=it)||d,Vt(t,e),it=c):Vt(t,e),Zt(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(G=e,d=e.child;d!==null;){for(h=G=d;G!==null;){switch(p=G,v=p.child,p.tag){case 0:case 11:case 14:case 15:Ns(4,p,p.return);break;case 1:Rn(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){Fe(n,r,b)}}break;case 5:Rn(p,p.return);break;case 22:if(p.memoizedState!==null){Oc(h);continue}}v!==null?(v.return=p,G=v):Oc(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,u=h.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Od("display",o))}catch(b){Fe(e,e.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){Fe(e,e.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vt(t,e),Zt(e),n&4&&Ac(e);break;case 21:break;default:Vt(t,e),Zt(e)}}function Zt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(lh(r)){var n=r;break e}r=r.return}throw Error(R(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(As(s,""),n.flags&=-33);var i=Rc(e);yl(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Rc(e);gl(e,l,o);break;default:throw Error(R(161))}}catch(u){Fe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gg(e,t,r){G=e,dh(e)}function dh(e,t,r){for(var n=(e.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||wi;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||it;l=wi;var c=it;if(wi=o,(it=u)&&!c)for(G=s;G!==null;)o=G,u=o.child,o.tag===22&&o.memoizedState!==null?zc(s):u!==null?(u.return=o,G=u):zc(s);for(;i!==null;)G=i,dh(i),i=i.sibling;G=s,wi=l,it=c}$c(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):$c(e)}}function $c(e){for(;G!==null;){var t=G;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:it||_o(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!it)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Ht(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&vc(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}vc(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ms(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}it||t.flags&512&&ml(t)}catch(p){Fe(t,t.return,p)}}if(t===e){G=null;break}if(r=t.sibling,r!==null){r.return=t.return,G=r;break}G=t.return}}function Oc(e){for(;G!==null;){var t=G;if(t===e){G=null;break}var r=t.sibling;if(r!==null){r.return=t.return,G=r;break}G=t.return}}function zc(e){for(;G!==null;){var t=G;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_o(4,t)}catch(u){Fe(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){Fe(t,s,u)}}var i=t.return;try{ml(t)}catch(u){Fe(t,i,u)}break;case 5:var o=t.return;try{ml(t)}catch(u){Fe(t,o,u)}}}catch(u){Fe(t,t.return,u)}if(t===e){G=null;break}var l=t.sibling;if(l!==null){l.return=t.return,G=l;break}G=t.return}}var yg=Math.ceil,so=vr.ReactCurrentDispatcher,hu=vr.ReactCurrentOwner,zt=vr.ReactCurrentBatchConfig,ye=0,Ye=null,qe=null,et=0,St=0,An=Br(0),Ke=0,Ks=null,on=0,bo=0,pu=0,Es=null,pt=null,mu=0,Kn=1/0,ar=null,io=!1,vl=null,zr=null,_i=!1,Tr=null,oo=0,Cs=0,xl=null,zi=-1,Mi=0;function ut(){return ye&6?Ue():zi!==-1?zi:zi=Ue()}function Mr(e){return e.mode&1?ye&2&&et!==0?et&-et:eg.transition!==null?(Mi===0&&(Mi=Kd()),Mi):(e=_e,e!==0||(e=window.event,e=e===void 0?16:tf(e.type)),e):1}function Qt(e,t,r,n){if(50<Cs)throw Cs=0,xl=null,Error(R(185));Xs(e,r,n),(!(ye&2)||e!==Ye)&&(e===Ye&&(!(ye&2)&&(bo|=r),Ke===4&&Er(e,et)),xt(e,n),r===1&&ye===0&&!(t.mode&1)&&(Kn=Ue()+500,vo&&Vr()))}function xt(e,t){var r=e.callbackNode;em(e,t);var n=Vi(e,e===Ye?et:0);if(n===0)r!==null&&Gu(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Gu(r),t===1)e.tag===0?Zm(Mc.bind(null,e)):_f(Mc.bind(null,e)),Qm(function(){!(ye&6)&&Vr()}),r=null;else{switch(Qd(n)){case 1:r=Ul;break;case 4:r=qd;break;case 16:r=Bi;break;case 536870912:r=Wd;break;default:r=Bi}r=xh(r,fh.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function fh(e,t){if(zi=-1,Mi=0,ye&6)throw Error(R(327));var r=e.callbackNode;if(Dn()&&e.callbackNode!==r)return null;var n=Vi(e,e===Ye?et:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ao(e,n);else{t=n;var s=ye;ye|=2;var i=ph();(Ye!==e||et!==t)&&(ar=null,Kn=Ue()+500,en(e,t));do try{wg();break}catch(l){hh(e,l)}while(!0);eu(),so.current=i,ye=s,qe!==null?t=0:(Ye=null,et=0,t=Ke)}if(t!==0){if(t===2&&(s=qa(e),s!==0&&(n=s,t=wl(e,s))),t===1)throw r=Ks,en(e,0),Er(e,n),xt(e,Ue()),r;if(t===6)Er(e,n);else{if(s=e.current.alternate,!(n&30)&&!vg(s)&&(t=ao(e,n),t===2&&(i=qa(e),i!==0&&(n=i,t=wl(e,i))),t===1))throw r=Ks,en(e,0),Er(e,n),xt(e,Ue()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(R(345));case 2:Kr(e,pt,ar);break;case 3:if(Er(e,n),(n&130023424)===n&&(t=mu+500-Ue(),10<t)){if(Vi(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){ut(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=el(Kr.bind(null,e,pt,ar),t);break}Kr(e,pt,ar);break;case 4:if(Er(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Kt(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=Ue()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yg(n/1960))-n,10<n){e.timeoutHandle=el(Kr.bind(null,e,pt,ar),n);break}Kr(e,pt,ar);break;case 5:Kr(e,pt,ar);break;default:throw Error(R(329))}}}return xt(e,Ue()),e.callbackNode===r?fh.bind(null,e):null}function wl(e,t){var r=Es;return e.current.memoizedState.isDehydrated&&(en(e,t).flags|=256),e=ao(e,t),e!==2&&(t=pt,pt=r,t!==null&&_l(t)),e}function _l(e){pt===null?pt=e:pt.push.apply(pt,e)}function vg(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Jt(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Er(e,t){for(t&=~pu,t&=~bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Kt(t),n=1<<r;e[r]=-1,t&=~n}}function Mc(e){if(ye&6)throw Error(R(327));Dn();var t=Vi(e,0);if(!(t&1))return xt(e,Ue()),null;var r=ao(e,t);if(e.tag!==0&&r===2){var n=qa(e);n!==0&&(t=n,r=wl(e,n))}if(r===1)throw r=Ks,en(e,0),Er(e,t),xt(e,Ue()),r;if(r===6)throw Error(R(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Kr(e,pt,ar),xt(e,Ue()),null}function gu(e,t){var r=ye;ye|=1;try{return e(t)}finally{ye=r,ye===0&&(Kn=Ue()+500,vo&&Vr())}}function an(e){Tr!==null&&Tr.tag===0&&!(ye&6)&&Dn();var t=ye;ye|=1;var r=zt.transition,n=_e;try{if(zt.transition=null,_e=1,e)return e()}finally{_e=n,zt.transition=r,ye=t,!(ye&6)&&Vr()}}function yu(){St=An.current,Pe(An)}function en(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Km(r)),qe!==null)for(r=qe.return;r!==null;){var n=r;switch(Yl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ki();break;case 3:qn(),Pe(yt),Pe(ot),ou();break;case 5:iu(n);break;case 4:qn();break;case 13:Pe($e);break;case 19:Pe($e);break;case 10:tu(n.type._context);break;case 22:case 23:yu()}r=r.return}if(Ye=e,qe=e=Ir(e.current,null),et=St=t,Ke=0,Ks=null,pu=bo=on=0,pt=Es=null,Xr!==null){for(t=0;t<Xr.length;t++)if(r=Xr[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}Xr=null}return e}function hh(e,t){do{var r=qe;try{if(eu(),Ai.current=no,ro){for(var n=Oe.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ro=!1}if(sn=0,Je=We=Oe=null,js=!1,Gs=0,hu.current=null,r===null||r.return===null){Ke=1,Ks=t,qe=null;break}e:{var i=e,o=r.return,l=r,u=t;if(t=et,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=Sc(o);if(v!==null){v.flags&=-257,jc(v,o,l,i,t),v.mode&1&&kc(i,c,t),t=v,u=c;var x=t.updateQueue;if(x===null){var b=new Set;b.add(u),t.updateQueue=b}else x.add(u);break e}else{if(!(t&1)){kc(i,c,t),vu();break e}u=Error(R(426))}}else if(Re&&l.mode&1){var k=Sc(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),jc(k,o,l,i,t),Xl(Wn(u,l));break e}}i=u=Wn(u,l),Ke!==4&&(Ke=2),Es===null?Es=[i]:Es.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=Jf(i,u,t);yc(i,g);break e;case 1:l=u;var f=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zr===null||!zr.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Yf(i,l,t);yc(i,_);break e}}i=i.return}while(i!==null)}gh(r)}catch(S){t=S,qe===r&&r!==null&&(qe=r=r.return);continue}break}while(!0)}function ph(){var e=so.current;return so.current=no,e===null?no:e}function vu(){(Ke===0||Ke===3||Ke===2)&&(Ke=4),Ye===null||!(on&268435455)&&!(bo&268435455)||Er(Ye,et)}function ao(e,t){var r=ye;ye|=2;var n=ph();(Ye!==e||et!==t)&&(ar=null,en(e,t));do try{xg();break}catch(s){hh(e,s)}while(!0);if(eu(),ye=r,so.current=n,qe!==null)throw Error(R(261));return Ye=null,et=0,Ke}function xg(){for(;qe!==null;)mh(qe)}function wg(){for(;qe!==null&&!Gp();)mh(qe)}function mh(e){var t=vh(e.alternate,e,St);e.memoizedProps=e.pendingProps,t===null?gh(e):qe=t,hu.current=null}function gh(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hg(r,t),r!==null){r.flags&=32767,qe=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ke=6,qe=null;return}}else if(r=fg(r,t,St),r!==null){qe=r;return}if(t=t.sibling,t!==null){qe=t;return}qe=t=e}while(t!==null);Ke===0&&(Ke=5)}function Kr(e,t,r){var n=_e,s=zt.transition;try{zt.transition=null,_e=1,_g(e,t,r,n)}finally{zt.transition=s,_e=n}return null}function _g(e,t,r,n){do Dn();while(Tr!==null);if(ye&6)throw Error(R(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(R(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(tm(e,i),e===Ye&&(qe=Ye=null,et=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||_i||(_i=!0,xh(Bi,function(){return Dn(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=zt.transition,zt.transition=null;var o=_e;_e=1;var l=ye;ye|=4,hu.current=null,mg(e,r),ch(r,e),Um(Xa),Hi=!!Ya,Xa=Ya=null,e.current=r,gg(r),qp(),ye=l,_e=o,zt.transition=i}else e.current=r;if(_i&&(_i=!1,Tr=e,oo=s),i=e.pendingLanes,i===0&&(zr=null),Qp(r.stateNode),xt(e,Ue()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(io)throw io=!1,e=vl,vl=null,e;return oo&1&&e.tag!==0&&Dn(),i=e.pendingLanes,i&1?e===xl?Cs++:(Cs=0,xl=e):Cs=0,Vr(),null}function Dn(){if(Tr!==null){var e=Qd(oo),t=zt.transition,r=_e;try{if(zt.transition=null,_e=16>e?16:e,Tr===null)var n=!1;else{if(e=Tr,Tr=null,oo=0,ye&6)throw Error(R(331));var s=ye;for(ye|=4,G=e.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(G=c;G!==null;){var d=G;switch(d.tag){case 0:case 11:case 15:Ns(8,d,i)}var h=d.child;if(h!==null)h.return=d,G=h;else for(;G!==null;){d=G;var p=d.sibling,v=d.return;if(ah(d),d===c){G=null;break}if(p!==null){p.return=v,G=p;break}G=v}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var k=b.sibling;b.sibling=null,b=k}while(b!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ns(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,G=g;break e}G=i.return}}var f=e.current;for(G=f;G!==null;){o=G;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,G=y;else e:for(o=f;G!==null;){if(l=G,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_o(9,l)}}catch(S){Fe(l,l.return,S)}if(l===o){G=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,G=_;break e}G=l.return}}if(ye=s,Vr(),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(ho,e)}catch{}n=!0}return n}finally{_e=r,zt.transition=t}}return!1}function Ic(e,t,r){t=Wn(r,t),t=Jf(e,t,1),e=Or(e,t,1),t=ut(),e!==null&&(Xs(e,1,t),xt(e,t))}function Fe(e,t,r){if(e.tag===3)Ic(e,e,r);else for(;t!==null;){if(t.tag===3){Ic(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zr===null||!zr.has(n))){e=Wn(r,e),e=Yf(t,e,1),t=Or(t,e,1),e=ut(),t!==null&&(Xs(t,1,e),xt(t,e));break}}t=t.return}}function bg(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ut(),e.pingedLanes|=e.suspendedLanes&r,Ye===e&&(et&r)===r&&(Ke===4||Ke===3&&(et&130023424)===et&&500>Ue()-mu?en(e,0):pu|=r),xt(e,t)}function yh(e,t){t===0&&(e.mode&1?(t=di,di<<=1,!(di&130023424)&&(di=4194304)):t=1);var r=ut();e=mr(e,t),e!==null&&(Xs(e,t,r),xt(e,r))}function kg(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),yh(e,r)}function Sg(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(R(314))}n!==null&&n.delete(t),yh(e,r)}var vh;vh=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||yt.current)gt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return gt=!1,dg(e,t,r);gt=!!(e.flags&131072)}else gt=!1,Re&&t.flags&1048576&&bf(t,Yi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Oi(e,t),e=t.pendingProps;var s=Vn(t,ot.current);Fn(t,r),s=lu(null,t,n,e,s,r);var i=uu();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vt(n)?(i=!0,Qi(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,nu(t),s.updater=wo,t.stateNode=s,s._reactInternals=t,al(t,n,e,r),t=cl(null,t,n,!0,i,r)):(t.tag=0,Re&&i&&Jl(t),lt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Oi(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Ng(n),e=Ht(n,e),s){case 0:t=ul(null,t,n,e,r);break e;case 1:t=Cc(null,t,n,e,r);break e;case 11:t=Nc(null,t,n,e,r);break e;case 14:t=Ec(null,t,n,Ht(n.type,e),r);break e}throw Error(R(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ht(n,s),ul(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ht(n,s),Cc(e,t,n,s,r);case 3:e:{if(th(t),e===null)throw Error(R(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Cf(e,t),eo(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Wn(Error(R(423)),t),t=Pc(e,t,n,r,s);break e}else if(n!==s){s=Wn(Error(R(424)),t),t=Pc(e,t,n,r,s);break e}else for(jt=$r(t.stateNode.containerInfo.firstChild),Nt=t,Re=!0,Wt=null,r=Nf(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Hn(),n===s){t=gr(e,t,r);break e}lt(e,t,n,r)}t=t.child}return t;case 5:return Pf(t),e===null&&sl(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Za(n,s)?o=null:i!==null&&Za(n,i)&&(t.flags|=32),eh(e,t),lt(e,t,o,r),t.child;case 6:return e===null&&sl(t),null;case 13:return rh(e,t,r);case 4:return su(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Gn(t,null,n,r):lt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ht(n,s),Nc(e,t,n,s,r);case 7:return lt(e,t,t.pendingProps,r),t.child;case 8:return lt(e,t,t.pendingProps.children,r),t.child;case 12:return lt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,je(Xi,n._currentValue),n._currentValue=o,i!==null)if(Jt(i.value,o)){if(i.children===s.children&&!yt.current){t=gr(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=fr(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),il(i.return,r,t),l.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(R(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),il(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}lt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Fn(t,r),s=It(s),n=n(s),t.flags|=1,lt(e,t,n,r),t.child;case 14:return n=t.type,s=Ht(n,t.pendingProps),s=Ht(n.type,s),Ec(e,t,n,s,r);case 15:return Xf(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ht(n,s),Oi(e,t),t.tag=1,vt(n)?(e=!0,Qi(t)):e=!1,Fn(t,r),Qf(t,n,s),al(t,n,s,r),cl(null,t,n,!0,e,r);case 19:return nh(e,t,r);case 22:return Zf(e,t,r)}throw Error(R(156,t.tag))};function xh(e,t){return Gd(e,t)}function jg(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(e,t,r,n){return new jg(e,t,r,n)}function xu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ng(e){if(typeof e=="function")return xu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Il)return 11;if(e===Fl)return 14}return 2}function Ir(e,t){var r=e.alternate;return r===null?(r=Ot(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ii(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")xu(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case kn:return tn(r.children,s,i,t);case Ml:o=8,s|=8;break;case La:return e=Ot(12,r,t,s|2),e.elementType=La,e.lanes=i,e;case Ra:return e=Ot(13,r,t,s),e.elementType=Ra,e.lanes=i,e;case Aa:return e=Ot(19,r,t,s),e.elementType=Aa,e.lanes=i,e;case Cd:return ko(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Nd:o=10;break e;case Ed:o=9;break e;case Il:o=11;break e;case Fl:o=14;break e;case kr:o=16,n=null;break e}throw Error(R(130,e==null?e:typeof e,""))}return t=Ot(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function tn(e,t,r,n){return e=Ot(7,e,n,t),e.lanes=r,e}function ko(e,t,r,n){return e=Ot(22,e,n,t),e.elementType=Cd,e.lanes=r,e.stateNode={isHidden:!1},e}function ha(e,t,r){return e=Ot(6,e,null,t),e.lanes=r,e}function pa(e,t,r){return t=Ot(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Eg(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ko(0),this.expirationTimes=Ko(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ko(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function wu(e,t,r,n,s,i,o,l,u){return e=new Eg(e,t,r,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ot(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},nu(i),e}function Cg(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function wh(e){if(!e)return Dr;e=e._reactInternals;e:{if(cn(e)!==e||e.tag!==1)throw Error(R(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(R(171))}if(e.tag===1){var r=e.type;if(vt(r))return wf(e,r,t)}return t}function _h(e,t,r,n,s,i,o,l,u){return e=wu(r,n,!0,e,s,i,o,l,u),e.context=wh(null),r=e.current,n=ut(),s=Mr(r),i=fr(n,s),i.callback=t??null,Or(r,i,s),e.current.lanes=s,Xs(e,s,n),xt(e,n),e}function So(e,t,r,n){var s=t.current,i=ut(),o=Mr(s);return r=wh(r),t.context===null?t.context=r:t.pendingContext=r,t=fr(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Or(s,t,o),e!==null&&(Qt(e,s,o,i),Ri(e,s,o)),o}function lo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Fc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function _u(e,t){Fc(e,t),(e=e.alternate)&&Fc(e,t)}function Pg(){return null}var bh=typeof reportError=="function"?reportError:function(e){console.error(e)};function bu(e){this._internalRoot=e}jo.prototype.render=bu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(R(409));So(e,t,null,null)};jo.prototype.unmount=bu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;an(function(){So(null,e,null,null)}),t[pr]=null}};function jo(e){this._internalRoot=e}jo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Xd();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Nr.length&&t!==0&&t<Nr[r].priority;r++);Nr.splice(r,0,e),r===0&&ef(e)}};function ku(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function No(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dc(){}function Tg(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=lo(o);i.call(c)}}var o=_h(t,n,e,0,null,!1,!1,"",Dc);return e._reactRootContainer=o,e[pr]=o.current,Ds(e.nodeType===8?e.parentNode:e),an(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var c=lo(u);l.call(c)}}var u=wu(e,0,!1,null,null,!1,!1,"",Dc);return e._reactRootContainer=u,e[pr]=u.current,Ds(e.nodeType===8?e.parentNode:e),an(function(){So(t,u,r,n)}),u}function Eo(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=lo(o);l.call(u)}}So(t,o,e,s)}else o=Tg(r,t,e,s,n);return lo(o)}Jd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ys(t.pendingLanes);r!==0&&(Bl(t,r|1),xt(t,Ue()),!(ye&6)&&(Kn=Ue()+500,Vr()))}break;case 13:an(function(){var n=mr(e,1);if(n!==null){var s=ut();Qt(n,e,1,s)}}),_u(e,1)}};Vl=function(e){if(e.tag===13){var t=mr(e,134217728);if(t!==null){var r=ut();Qt(t,e,134217728,r)}_u(e,134217728)}};Yd=function(e){if(e.tag===13){var t=Mr(e),r=mr(e,t);if(r!==null){var n=ut();Qt(r,e,t,n)}_u(e,t)}};Xd=function(){return _e};Zd=function(e,t){var r=_e;try{return _e=e,t()}finally{_e=r}};Va=function(e,t,r){switch(t){case"input":if(za(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=yo(n);if(!s)throw Error(R(90));Td(n),za(n,s)}}}break;case"textarea":Rd(e,r);break;case"select":t=r.value,t!=null&&On(e,!!r.multiple,t,!1)}};Fd=gu;Dd=an;var Lg={usingClientEntryPoint:!1,Events:[ei,En,yo,Md,Id,gu]},hs={findFiberByHostInstance:Yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rg={bundleType:hs.bundleType,version:hs.version,rendererPackageName:hs.rendererPackageName,rendererConfig:hs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Vd(e),e===null?null:e.stateNode},findFiberByHostInstance:hs.findFiberByHostInstance||Pg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bi.isDisabled&&bi.supportsFiber)try{ho=bi.inject(Rg),nr=bi}catch{}}Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lg;Ct.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ku(t))throw Error(R(200));return Cg(e,t,null,r)};Ct.createRoot=function(e,t){if(!ku(e))throw Error(R(299));var r=!1,n="",s=bh;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=wu(e,1,!1,null,null,r,!1,n,s),e[pr]=t.current,Ds(e.nodeType===8?e.parentNode:e),new bu(t)};Ct.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(R(188)):(e=Object.keys(e).join(","),Error(R(268,e)));return e=Vd(t),e=e===null?null:e.stateNode,e};Ct.flushSync=function(e){return an(e)};Ct.hydrate=function(e,t,r){if(!No(t))throw Error(R(200));return Eo(null,e,t,!0,r)};Ct.hydrateRoot=function(e,t,r){if(!ku(e))throw Error(R(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=bh;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=_h(t,null,e,1,r??null,s,!1,i,o),e[pr]=t.current,Ds(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new jo(t)};Ct.render=function(e,t,r){if(!No(t))throw Error(R(200));return Eo(null,e,t,!1,r)};Ct.unmountComponentAtNode=function(e){if(!No(e))throw Error(R(40));return e._reactRootContainer?(an(function(){Eo(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0):!1};Ct.unstable_batchedUpdates=gu;Ct.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!No(r))throw Error(R(200));if(e==null||e._reactInternals===void 0)throw Error(R(38));return Eo(e,t,r,!1,n)};Ct.version="18.3.1-next-f1338f8080-20240426";function kh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kh)}catch(e){console.error(e)}}kh(),bd.exports=Ct;var Ag=bd.exports,Sh,Uc=Ag;Sh=Uc.createRoot,Uc.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $g={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),se=(e,t)=>{const r=m.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:u,...c},d)=>m.createElement("svg",{ref:d,...$g,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Og(e)}`,l].join(" "),...c},[...t.map(([h,p])=>m.createElement(h,p)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=se("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=se("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=se("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=se("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=se("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=se("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=se("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=se("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=se("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=se("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=se("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=se("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=se("MessageSquareText",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=se("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=se("PencilLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}],["path",{d:"m15 5 3 3",key:"1w25hb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=se("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=se("PlusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=se("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=se("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xg=se("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=se("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=se("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=se("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=se("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),iy=({onNext:e})=>a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-brand-green to-brand-gray flex flex-col items-center justify-center p-8 text-white",children:[a.jsxs("div",{className:"text-center max-w-md",children:[a.jsxs("div",{className:"flex justify-center items-center mb-8",children:[a.jsx(Th,{size:48,className:"text-accent-yellow mr-2"}),a.jsx("span",{className:"text-4xl font-bold ml-2",children:"The Circuit"})]}),a.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Connect, Climb, Conquer."}),a.jsx("p",{className:"text-lg mb-8 opacity-90",children:"Your Gym's Beta, In Your Pocket."}),a.jsxs("div",{className:"space-y-4 mb-12 text-left px-4",children:[a.jsx("p",{children:"✓ Discover and share routes (beta) in your gym."}),a.jsx("p",{children:"✓ Track your climbs and progress."}),a.jsx("p",{children:"✓ Connect with fellow climbers."})]}),a.jsx("button",{onClick:e,className:"w-full bg-accent-yellow hover:bg-opacity-90 text-brand-gray font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg",children:"Get Started"})]}),a.jsxs("div",{className:"absolute bottom-4 text-xs opacity-70",children:["Photo by ",a.jsx("a",{href:"https://unsplash.com/@scottagoodwill?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Scott Goodwill"})," on ",a.jsx("a",{href:"https://unsplash.com/photos/white-and-black-mountain-illustration-y8Ngwq34_Ak?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Unsplash"})]}),a.jsx("div",{className:"absolute inset-0 -z-10 bg-cover bg-center opacity-20",style:{backgroundImage:"url('https://images.unsplash.com/photo-1587404840900-836445ab150f?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')"}})]}),oy="modulepreload",ay=function(e){return"/"+e},Vc={},Jn=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=ay(u),u in Vc)return;Vc[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":oy,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((p,v)=>{h.addEventListener("load",p),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},ly=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Jn(async()=>{const{default:n}=await Promise.resolve().then(()=>rs);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Eu extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class uy extends Eu{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class cy extends Eu{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class dy extends Eu{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bl;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(bl||(bl={}));var fy=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};class hy{constructor(t,{headers:r={},customFetch:n,region:s=bl.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=ly(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return fy(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let l={},{region:u}=r;u||(u=this.region),u&&u!=="any"&&(l["x-region"]=u);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(l["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(l["Content-Type"]="application/json",c=JSON.stringify(o)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:c}).catch(x=>{throw new uy(x)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new cy(d);if(!d.ok)throw new dy(d);let p=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return p==="application/json"?v=yield d.json():p==="application/octet-stream"?v=yield d.blob():p==="text/event-stream"?v=d:p==="multipart/form-data"?v=yield d.formData():v=yield d.text(),{data:v,error:null}}catch(s){return{data:null,error:s}}})}}var mt={},Cu={},Ro={},si={},Ao={},$o={},py=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yn=py();const my=Yn.fetch,Ah=Yn.fetch.bind(Yn),$h=Yn.Headers,gy=Yn.Request,yy=Yn.Response,rs=Object.freeze(Object.defineProperty({__proto__:null,Headers:$h,Request:gy,Response:yy,default:Ah,fetch:my},Symbol.toStringTag,{value:"Module"})),vy=ap(rs);var Oo={};Object.defineProperty(Oo,"__esModule",{value:!0});let xy=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Oo.default=xy;var Oh=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($o,"__esModule",{value:!0});const wy=Oh(vy),_y=Oh(Oo);let by=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=wy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,u;let c=null,d=null,h=null,p=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const g=await i.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=g:d=JSON.parse(g))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),k=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&k&&k.length>1&&(h=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,p=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(d=[],c=null,p=200,v="OK")}catch{i.status===404&&b===""?(p=204,v="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,p=200,v="OK"),c&&this.shouldThrowOnError)throw new _y.default(c)}return{error:c,data:d,count:h,status:p,statusText:v}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,u;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};$o.default=by;var ky=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ao,"__esModule",{value:!0});const Sy=ky($o);let jy=class extends Sy.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const u=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${u};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ao.default=jy;var Ny=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(si,"__esModule",{value:!0});const Ey=Ny(Ao);let Cy=class extends Ey.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};si.default=Cy;var Py=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ro,"__esModule",{value:!0});const ps=Py(si);let Ty=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new ps.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new ps.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const u=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new ps.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new ps.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ps.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ro.default=Ty;var zo={},Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.version=void 0;Mo.version="0.0.0-automated";Object.defineProperty(zo,"__esModule",{value:!0});zo.DEFAULT_HEADERS=void 0;const Ly=Mo;zo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ly.version}`};var zh=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cu,"__esModule",{value:!0});const Ry=zh(Ro),Ay=zh(si),$y=zo;let Oy=class Mh{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},$y.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new Ry.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Mh(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let u;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",u=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new Ay.default({method:o,url:l,headers:c,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};Cu.default=Oy;var ns=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mt,"__esModule",{value:!0});mt.PostgrestError=mt.PostgrestBuilder=mt.PostgrestTransformBuilder=mt.PostgrestFilterBuilder=mt.PostgrestQueryBuilder=mt.PostgrestClient=void 0;const Ih=ns(Cu);mt.PostgrestClient=Ih.default;const Fh=ns(Ro);mt.PostgrestQueryBuilder=Fh.default;const Dh=ns(si);mt.PostgrestFilterBuilder=Dh.default;const Uh=ns(Ao);mt.PostgrestTransformBuilder=Uh.default;const Bh=ns($o);mt.PostgrestBuilder=Bh.default;const Vh=ns(Oo);mt.PostgrestError=Vh.default;var zy=mt.default={PostgrestClient:Ih.default,PostgrestQueryBuilder:Fh.default,PostgrestFilterBuilder:Dh.default,PostgrestTransformBuilder:Uh.default,PostgrestBuilder:Bh.default,PostgrestError:Vh.default};const{PostgrestClient:My,PostgrestQueryBuilder:ox,PostgrestFilterBuilder:ax,PostgrestTransformBuilder:lx,PostgrestBuilder:ux,PostgrestError:cx}=zy,Iy="2.11.2",Fy={"X-Client-Info":`realtime-js/${Iy}`},Dy="1.0.0",Hh=1e4,Uy=1e3;var Un;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Un||(Un={}));var kt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(kt||(kt={}));var qt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(qt||(qt={}));var kl;(function(e){e.websocket="websocket"})(kl||(kl={}));var Jr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Jr||(Jr={}));class By{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+s));o=o+s;const u=n.decode(t.slice(o,o+i));o=o+i;const c=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class Gh{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Se;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Se||(Se={}));const Hc=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,o)=>(i[o]=Vy(o,e,t,s),i),{})},Vy=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!n.includes(i)?qh(i,o):Sl(o)},qh=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Wy(t,r)}switch(e){case Se.bool:return Hy(t);case Se.float4:case Se.float8:case Se.int2:case Se.int4:case Se.int8:case Se.numeric:case Se.oid:return Gy(t);case Se.json:case Se.jsonb:return qy(t);case Se.timestamp:return Ky(t);case Se.abstime:case Se.date:case Se.daterange:case Se.int4range:case Se.int8range:case Se.money:case Se.reltime:case Se.text:case Se.time:case Se.timestamptz:case Se.timetz:case Se.tsrange:case Se.tstzrange:return Sl(t);default:return Sl(t)}},Sl=e=>e,Hy=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Gy=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},qy=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Wy=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>qh(t,l))}return e},Ky=e=>typeof e=="string"?e.replace(" ","T"):e,Wh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class ma{constructor(t,r,n={},s=Hh){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gc;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gc||(Gc={}));class Ps{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ps.syncState(this.state,s,i,o),this.pendingDiffs.forEach(u=>{this.state=Ps.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ps.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),o=this.transformState(r),l={},u={};return this.map(i,(c,d)=>{o[c]||(u[c]=d)}),this.map(o,(c,d)=>{const h=i[c];if(h){const p=d.map(k=>k.presence_ref),v=h.map(k=>k.presence_ref),x=d.filter(k=>v.indexOf(k.presence_ref)<0),b=h.filter(k=>p.indexOf(k.presence_ref)<0);x.length>0&&(l[c]=x),b.length>0&&(u[c]=b)}else l[c]=d}),this.syncDiff(i,{joins:l,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,u)=>{var c;const d=(c=t[l])!==null&&c!==void 0?c:[];if(t[l]=this.cloneDeep(u),d.length>0){const h=t[l].map(v=>v.presence_ref),p=d.filter(v=>h.indexOf(v.presence_ref)<0);t[l].unshift(...p)}n(l,d,u)}),this.map(o,(l,u)=>{let c=t[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=c,s(l,c,u),c.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qc;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(qc||(qc={}));var Wc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Wc||(Wc={}));var lr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(lr||(lr={}));class Pu{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ma(this,qt.join,this.params,this.timeout),this.rejoinTimer=new Gh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(qt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Ps(this),this.broadcastEndpointURL=Wh(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(d=>t==null?void 0:t(lr.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(lr.CLOSED));const u={},c={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&s!==void 0?s:[],private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var h;if(this.socket.setAuth(),d===void 0){t==null||t(lr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,v=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,x=[];for(let b=0;b<v;b++){const k=p[b],{filter:{event:g,schema:f,table:y,filter:_}}=k,S=d&&d[b];if(S&&S.event===g&&S.schema===f&&S.table===y&&S.filter===_)x.push(Object.assign(Object.assign({},k),{id:S.id}));else{this.unsubscribe(),t==null||t(lr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(lr.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(lr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(lr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=kt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new ma(this,qt.leave,{},t);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ma(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=qt;if(n&&[l,u,c,d].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var x,b,k;return((x=v.filter)===null||x===void 0?void 0:x.event)==="*"||((k=(b=v.filter)===null||b===void 0?void 0:b.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(v=>v.callback(p,n)):(i=this.bindings[o])===null||i===void 0||i.filter(v=>{var x,b,k,g,f,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const _=v.id,S=(x=v.filter)===null||x===void 0?void 0:x.event;return _&&((b=r.ids)===null||b===void 0?void 0:b.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((k=r.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const _=(f=(g=v==null?void 0:v.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return _==="*"||_===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof p=="object"&&"ids"in p){const x=p.data,{schema:b,table:k,commit_timestamp:g,type:f,errors:y}=x;p=Object.assign(Object.assign({},{schema:b,table:k,commit_timestamp:g,eventType:f,new:{},old:{},errors:y}),this._getPayloadRecords(x))}v.callback(p,n)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Pu.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(qt.close,{},t)}_onError(t){this._on(qt.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Hc(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Hc(t.columns,t.old_record)),r}}const Qy=()=>{},Jy=typeof WebSocket<"u",Yy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xy{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Fy,this.params={},this.timeout=Hh,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Qy,this.conn=null,this.sendBuffer=[],this.serializer=new By,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Jn(async()=>{const{default:u}=await Promise.resolve().then(()=>rs);return{default:u}},void 0).then(({default:u})=>u(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${kl.websocket}`,this.httpEndpoint=Wh(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Jy){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Zy(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Jn(async()=>{const{default:t}=await import("./browser-C2jYADYG.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Dy}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Un.connecting:return Jr.Connecting;case Un.open:return Jr.Open;case Un.closing:return Jr.Closing;default:return Jr.Closed}}isConnected(){return this.connectionState()===Jr.Open}channel(t,r={config:{}}){const n=new Pu(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(s=>{r&&s.updateJoinPayload({access_token:r}),s.joinedOnce&&s._isJoined()&&s._push(qt.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Uy,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:i,ref:o}=r;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(n)).forEach(l=>l._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(qt.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Yy],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Zy{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Un.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Tu extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Qe(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class e0 extends Tu{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class jl extends Tu{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var t0=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};const Kh=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Jn(async()=>{const{default:n}=await Promise.resolve().then(()=>rs);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},r0=()=>t0(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Jn(()=>Promise.resolve().then(()=>rs),void 0)).Response:Response}),Nl=e=>{if(Array.isArray(e))return e.map(r=>Nl(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Nl(n)}),t};var dn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};const ga=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),n0=(e,t,r)=>dn(void 0,void 0,void 0,function*(){const n=yield r0();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new e0(ga(s),e.status||500))}).catch(s=>{t(new jl(ga(s),s))}):t(new jl(ga(e),e))}),s0=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function ii(e,t,r,n,s,i){return dn(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,s0(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>n0(u,l,n))})})}function co(e,t,r,n){return dn(this,void 0,void 0,function*(){return ii(e,"GET",t,r,n)})}function jr(e,t,r,n,s){return dn(this,void 0,void 0,function*(){return ii(e,"POST",t,n,s,r)})}function i0(e,t,r,n,s){return dn(this,void 0,void 0,function*(){return ii(e,"PUT",t,n,s,r)})}function o0(e,t,r,n){return dn(this,void 0,void 0,function*(){return ii(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Qh(e,t,r,n,s){return dn(this,void 0,void 0,function*(){return ii(e,"DELETE",t,n,s,r)})}var ht=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};const a0={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class l0{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Kh(s)}uploadOrUpdate(t,r,n,s){return ht(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Kc),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const c=this._removeEmptyFolders(r),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),p=yield h.json();return h.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(Qe(i))return{data:null,error:i};throw i}})}upload(t,r,n){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return ht(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let u;const c=Object.assign({upsert:Kc.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",c.cacheControl)):(u=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:u,headers:d}),p=yield h.json();return h.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(u){if(Qe(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t,r){return ht(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield jr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Tu("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}update(t,r,n){return ht(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ht(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}copy(t,r,n){return ht(this,void 0,void 0,function*(){try{return{data:{path:(yield jr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return ht(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield jr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return ht(this,void 0,void 0,function*(){try{const s=yield jr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}download(t,r){return ht(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield co(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Qe(l))return{data:null,error:l};throw l}})}info(t){return ht(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield co(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Nl(n),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}exists(t){return ht(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield o0(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Qe(n)&&n instanceof jl){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${c}`)}}}remove(t){return ht(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}list(t,r,n){return ht(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},a0),r),{prefix:t||""});return{data:yield jr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Qe(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const u0="2.7.1",c0={"X-Client-Info":`storage-js/${u0}`};var yn=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};class d0{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},c0),r),this.fetch=Kh(n)}listBuckets(){return yn(this,void 0,void 0,function*(){try{return{data:yield co(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Qe(t))return{data:null,error:t};throw t}})}getBucket(t){return yn(this,void 0,void 0,function*(){try{return{data:yield co(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return yn(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return yn(this,void 0,void 0,function*(){try{return{data:yield i0(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qe(n))return{data:null,error:n};throw n}})}emptyBucket(t){return yn(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}deleteBucket(t){return yn(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Qe(r))return{data:null,error:r};throw r}})}}class f0 extends d0{constructor(t,r={},n){super(t,r,n)}from(t){return new l0(this.url,this.headers,t,this.fetch)}}const h0="2.49.4";let xs="";typeof Deno<"u"?xs="deno":typeof document<"u"?xs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xs="react-native":xs="node";const p0={"X-Client-Info":`supabase-js-${xs}/${h0}`},m0={headers:p0},g0={schema:"public"},y0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},v0={};var x0=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};const w0=e=>{let t;return e?t=e:typeof fetch>"u"?t=Ah:t=fetch,(...r)=>t(...r)},_0=()=>typeof Headers>"u"?$h:Headers,b0=(e,t,r)=>{const n=w0(r),s=_0();return(i,o)=>x0(void 0,void 0,void 0,function*(){var l;const u=(l=yield t())!==null&&l!==void 0?l:e;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,Object.assign(Object.assign({},o),{headers:c}))})};var k0=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};function S0(e){return e.replace(/\/$/,"")}function j0(e,t){const{db:r,auth:n,realtime:s,global:i}=e,{db:o,auth:l,realtime:u,global:c}=t,d={db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},l),n),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>k0(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const Jh="2.69.1",_n=30*1e3,El=3,ya=El*_n,N0="http://localhost:9999",E0="supabase.auth.token",C0={"X-Client-Info":`gotrue-js/${Jh}`},Cl="X-Supabase-Api-Version",Yh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P0=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,T0=6e5;class Lu extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class L0 extends Lu{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function R0(e){return le(e)&&e.name==="AuthApiError"}class Xh extends Lu{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Hr extends Lu{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class _r extends Hr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function A0(e){return le(e)&&e.name==="AuthSessionMissingError"}class va extends Hr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ki extends Hr{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Si extends Hr{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $0(e){return le(e)&&e.name==="AuthImplicitGrantRedirectError"}class Qc extends Hr{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pl extends Hr{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function xa(e){return le(e)&&e.name==="AuthRetryableFetchError"}class Jc extends Hr{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ts extends Hr{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xc=` 	
\r=`.split(""),O0=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Xc.length;t+=1)e[Xc[t].charCodeAt(0)]=-2;for(let t=0;t<Yc.length;t+=1)e[Yc[t].charCodeAt(0)]=t;return e})();function Zh(e,t,r){const n=O0[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Zc(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{I0(o,n,r)};for(let o=0;o<e.length;o+=1)Zh(e.charCodeAt(o),s,i);return t.join("")}function z0(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function M0(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}z0(n,t)}}function I0(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function F0(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Zh(e.charCodeAt(s),r,n);return new Uint8Array(t)}function D0(e){const t=[];return M0(e,r=>t.push(r)),new Uint8Array(t)}function U0(e){return Math.round(Date.now()/1e3)+e}function B0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const er=()=>typeof window<"u"&&typeof document<"u",qr={tested:!1,writable:!1},Ls=()=>{if(!er())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(qr.tested)return qr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),qr.tested=!0,qr.writable=!0}catch{qr.tested=!0,qr.writable=!1}return qr.writable};function V0(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const ep=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Jn(async()=>{const{default:n}=await Promise.resolve().then(()=>rs);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},H0=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",tp=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ji=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ni=async(e,t)=>{await e.removeItem(t)};class Io{constructor(){this.promise=new Io.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Io.promiseConstructor=Promise;function wa(e){const t=e.split(".");if(t.length!==3)throw new Ts("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!P0.test(t[n]))throw new Ts("JWT not in base64url format");return{header:JSON.parse(Zc(t[0])),payload:JSON.parse(Zc(t[1])),signature:F0(t[2]),raw:{header:t[0],payload:t[1]}}}async function G0(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function q0(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function W0(e){return("0"+e.toString(16)).substr(-2)}function K0(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,W0).join("")}async function Q0(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function J0(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Q0(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vn(e,t,r=!1){const n=K0();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await tp(e,`${t}-code-verifier`,s);const i=await J0(n);return[i,n===i?"plain":"s256"]}const Y0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function X0(e){const t=e.headers.get(Cl);if(!t||!t.match(Y0))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Z0(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function ev(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var tv=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const Qr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),rv=[502,503,504];async function ed(e){var t;if(!H0(e))throw new Pl(Qr(e),0);if(rv.includes(e.status))throw new Pl(Qr(e),e.status);let r;try{r=await e.json()}catch(i){throw new Xh(Qr(i),i)}let n;const s=X0(e);if(s&&s.getTime()>=Yh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Jc(Qr(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new _r}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Jc(Qr(r),e.status,r.weak_password.reasons);throw new L0(Qr(r),e.status||500,n)}const nv=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function he(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Cl]||(i[Cl]=Yh["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await sv(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function sv(e,t,r,n,s,i){const o=nv(t,n,s,i);let l;try{l=await e(r,Object.assign({},o))}catch(u){throw console.error(u),new Pl(Qr(u),0)}if(l.ok||await ed(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(u){await ed(u)}}function br(e){var t;let r=null;lv(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=U0(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function td(e){const t=br(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Cr(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function iv(e){return{data:e,error:null}}function ov(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,o=tv(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},o);return{data:{properties:l,user:u},error:null}}function av(e){return e}function lv(e){return e.access_token&&e.refresh_token&&e.expires_in}var uv=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class cv{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=ep(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await he(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await he(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Cr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=uv(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await he(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ov,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(le(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await he(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Cr})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,o,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await he(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:av});if(d.error)throw d.error;const h=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return v.length>0&&(v.forEach(x=>{const b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(x.split(";")[1].split("=")[1]);c[`${k}Page`]=b}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(le(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await he(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Cr})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await he(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Cr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await he(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Cr})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await he(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(le(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await he(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}}const dv={getItem:e=>Ls()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ls()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ls()&&globalThis.localStorage.removeItem(e)}};function rd(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function fv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xn={debug:!!(globalThis&&Ls()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rp extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class hv extends rp{}async function pv(e,t,r){xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),xn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new hv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(xn.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}fv();const mv={url:N0,storageKey:E0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:C0,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function nd(e,t,r){return await r()}class Js{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Js.nextInstanceID,Js.nextInstanceID+=1,this.instanceID>0&&er()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},mv),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new cv({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=ep(s.fetch),this.lock=s.lock||nd,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:er()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=pv:this.lock=nd,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Ls()?this.storage=dv:(this.memoryStorage={},this.storage=rd(this.memoryStorage)):(this.memoryStorage={},this.storage=rd(this.memoryStorage)),er()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jh}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=V0(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),er()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),$0(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return le(r)?{error:r}:{error:new Xh("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:br}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const u=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(le(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:d,password:h,options:p}=t;let v=null,x=null;this.flowType==="pkce"&&([v,x]=await vn(this.storage,this.storageKey)),i=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:v,code_challenge_method:x},xform:br})}else if("phone"in t){const{phone:d,password:h,options:p}=t;i=await he(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:br})}else throw new ki("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const u=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(le(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:td})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await he(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:td})}else throw new ki("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new va}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(le(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await ji(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:o}=await he(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:br});if(await Ni(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new va}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(le(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:o}=t,l=await he(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:br}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new va}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(r){if(le(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,o;try{if("email"in t){const{email:l,options:u}=t;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await vn(this.storage,this.storageKey));const{error:h}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:u}=t,{data:c,error:d}=await he(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(o=u==null?void 0:u.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new ki("You must provide either an email or phone number.")}catch(l){if(le(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await he(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:br});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,c=o.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(le(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await vn(this.storage,this.storageKey)),await he(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:iv})}catch(i){if(le(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new _r;const{error:s}=await he(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(le(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:o}=await he(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:o,error:l}=await he(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ki("You must provide either an email or phone number and a type")}catch(r){if(le(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ji(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<ya:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(u,c,d)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Cr}):await this._useSession(async r=>{var n,s,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _r}:await he(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Cr})})}catch(r){if(le(r))return A0(r)&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new _r;const o=s.session;let l=null,u=null;this.flowType==="pkce"&&t.email!=null&&([l,u]=await vn(this.storage,this.storageKey));const{data:c,error:d}=await he(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:u}),jwt:o.access_token,xform:Cr});if(d)throw d;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new _r;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:o}=wa(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(le(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new _r;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(le(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!er())throw new Si("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Si(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Qc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Si("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Qc("No code detected.");const{data:f,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:u,token_type:c}=t;if(!i||!l||!o||!c)throw new Si("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let p=d+h;u&&(p=parseInt(u));const v=p-d;v*1e3<=_n&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${h}s`);const x=p-h;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,p,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,p,d);const{data:b,error:k}=await this._getUser(i);if(k)throw k;const g={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:p,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(le(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ji(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(R0(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Ni(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=B0(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await vn(this.storage,this.storageKey,!0));try{return await he(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(le(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var o,l,u,c,d;const{data:h,error:p}=i;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await he(this.fetch,"GET",v,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return er()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(le(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)throw o;return await he(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await q0(async s=>(s>0&&await G0(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await he(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:br})),(s,i)=>{const o=200*Math.pow(2,s);return i&&xa(i)&&Date.now()+o-n<_n})}catch(n){if(this._debug(r,"error",n),le(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),er()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await ji(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ya;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${ya}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),xa(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new _r;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Io;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new _r;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),le(i)){const o={session:null,error:i};return xa(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await tp(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Ni(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&er()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),_n);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/_n);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${_n}ms, refresh threshold is ${El} ticks`),s<=El&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof rp)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!er()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await vn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await he(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:u,error:c}=await he(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(r){if(le(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=await he(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(le(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await he(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(le(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=wa(s.access_token);let l=null;o.aal&&(l=o.aal);let u=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n||(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+T0>Date.now()))return n;const{data:s,error:i}=await he(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Ts("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===t),!n)throw new Ts("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:v,error:x}=await this.getSession();if(x||!v.session)return{data:null,error:x};n=v.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:u}}=wa(n);if(Z0(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:i,header:s,signature:o},error:null}}const c=ev(s.alg),d=await this.fetchJwk(s.kid,r),h=await crypto.subtle.importKey("jwk",d,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,D0(`${l}.${u}`)))throw new Ts("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}}Js.nextInstanceID=0;const gv=Js;class yv extends gv{constructor(t){super(t)}}var vv=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(d){try{c(n.next(d))}catch(h){o(h)}}function u(d){try{c(n.throw(d))}catch(h){o(h)}}function c(d){d.done?i(d.value):s(d.value).then(l,u)}c((n=n.apply(e,t||[])).next())})};class xv{constructor(t,r,n){var s,i,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=S0(t);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:g0,realtime:v0,auth:Object.assign(Object.assign({},y0),{storageKey:u}),global:m0},d=j0(n??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=b0(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new My(`${l}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new hy(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new f0(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return vv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:l,debug:u},c,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yv({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:l,debug:u,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Xy(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wv=(e,t,r)=>new xv(e,t,r),_v="https://eumvfwrylsomqgtwosnu.supabase.co",bv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV1bXZmd3J5bHNvbXFndHdvc251Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM0NTUyNTUsImV4cCI6MjA1OTAzMTI1NX0.M9_EIQju-RvV0cZ0Z1CAkvzpLU1KD64UVULdFkrVwPE",H=wv(_v,bv),Fo=async(e,t)=>{if(e===t)throw new Error("Cannot follow yourself.");const{error:r}=await H.from("user_follows").insert({follower_id:e,following_id:t});if(r)throw console.error("Error following user:",r),r;console.log(`User ${e} followed ${t}`)},Do=async(e,t)=>{const{error:r}=await H.from("user_follows").delete().eq("follower_id",e).eq("following_id",t);if(r)throw console.error("Error unfollowing user:",r),r;console.log(`User ${e} unfollowed ${t}`)},Uo=async(e,t)=>{const{data:r,error:n}=await H.from("user_follows").select("follower_id").eq("follower_id",e).eq("following_id",t).maybeSingle();return n?(console.error("Error checking follow status:",n),!1):!!r},np=async e=>{const{count:t,error:r}=await H.from("user_follows").select("*",{count:"exact",head:!0}).eq("following_id",e);r&&console.error("Error fetching follower count:",r);const{count:n,error:s}=await H.from("user_follows").select("*",{count:"exact",head:!0}).eq("follower_id",e);return s&&console.error("Error fetching following count:",s),{followers:t??0,following:n??0}},sp=async(e,t)=>{if(!t.trim())throw new Error("Feedback message cannot be empty.");const{error:r}=await H.from("feedback").insert({feedback_type:e,message:t.trim()});if(r)throw console.error("Error submitting feedback:",r),r.message.includes("check constraint violation")||r.message.includes("row level security policy")?new Error("You must be logged in to submit feedback."):r.message.includes("feedback_feedback_type_check")?new Error("Invalid feedback type provided."):new Error(`Failed to submit feedback: ${r.message}`);console.log(`${e} feedback submitted successfully.`)},kv=({onAuthSuccess:e})=>{const[t,r]=m.useState(!0),[n,s]=m.useState(""),[i,o]=m.useState(""),[l,u]=m.useState(""),[c,d]=m.useState(""),[h,p]=m.useState(null),[v,x]=m.useState(!1),b=async()=>{x(!0),p(null);const{error:f}=await H.auth.signInWithPassword({email:n,password:i});f?p(f.message):(console.log("Login successful!"),e()),x(!1)},k=async()=>{var _;if(x(!0),p(null),i!==l){p("Passwords do not match."),x(!1);return}if(i.length<6){p("Password must be at least 6 characters long."),x(!1);return}if(!c.trim()){p("Please enter a display name."),x(!1);return}const{data:f,error:y}=await H.auth.signUp({email:n,password:i,options:{emailRedirectTo:void 0,data:{display_name:c.trim()}}});y?p(y.message):(console.log("Sign up successful! Display name added."),(_=f==null?void 0:f.user)!=null&&_.id&&await H.from("profiles").update({display_name:c.trim()}).eq("user_id",f.user.id),e()),x(!1)},g=f=>{f.preventDefault(),!v&&(t?b():k())};return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4",children:[a.jsxs("div",{className:"flex justify-center items-center mb-8 text-brand-green",children:[a.jsx(Th,{size:36,className:"text-accent-yellow mr-2"}),a.jsx("span",{className:"text-3xl font-bold",children:"The Circuit"})]}),a.jsxs("div",{className:"w-full max-w-md bg-white p-8 rounded-lg shadow-md",children:[a.jsx("h2",{className:"text-2xl font-bold text-center text-brand-gray mb-6",children:t?"Welcome Back!":"Create Account"}),h&&a.jsx("p",{className:"text-red-500 text-sm mb-4 text-center",children:h}),a.jsxs("form",{onSubmit:g,className:"space-y-4",children:[!t&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-brand-gray mb-1",children:"Display Name"}),a.jsx("input",{type:"text",id:"displayName",value:c,onChange:f=>d(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"Your Climber Name"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-brand-gray mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:f=>s(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-brand-gray mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:i,onChange:f=>o(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"•••••••• (min. 6 characters)"})]}),!t&&a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-brand-gray mb-1",children:"Confirm Password"}),a.jsx("input",{type:"password",id:"confirmPassword",value:l,onChange:f=>u(f.target.value),required:!0,disabled:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-blue disabled:bg-gray-100",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",disabled:v,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:v?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):a.jsxs(a.Fragment,{children:[t?a.jsx(Gg,{size:18}):a.jsx(ni,{size:18}),a.jsx("span",{children:t?"Log In":"Sign Up"})]})})]}),a.jsxs("p",{className:"text-center text-sm text-brand-gray mt-6",children:[t?"Don't have an account?":"Already have an account?",a.jsx("button",{onClick:()=>{v||(r(!t),p(null),d(""),o(""),u(""))},disabled:v,className:"text-accent-blue hover:underline font-medium ml-1 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Sign Up":"Log In"})]})]})]})},Sv=({title:e,feedbackType:t,onClose:r,currentUser:n})=>{const[s,i]=m.useState(""),[o,l]=m.useState(!1),[u,c]=m.useState(null),[d,h]=m.useState(!1),p=async v=>{if(v.preventDefault(),!s.trim()||!n){c(n?"Message cannot be empty.":"You must be logged in to send feedback.");return}l(!0),c(null),h(!1);try{await sp(t,s),h(!0),i(""),setTimeout(r,2e3)}catch(x){c(x.message||"An unexpected error occurred.")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-brand-gray",children:e}),a.jsx("button",{onClick:r,disabled:o,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:a.jsx(Nu,{size:24})})]}),a.jsx("form",{onSubmit:p,className:"p-4 space-y-4",children:d?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ts,{className:"mx-auto text-green-500 mb-2",size:40}),a.jsx("p",{className:"text-brand-gray font-medium",children:"Suggestion Sent!"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for your input."})]}):a.jsxs(a.Fragment,{children:[a.jsx("textarea",{rows:5,value:s,onChange:v=>i(v.target.value),placeholder:"Enter gym name, location, and any other details...",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",required:!0,disabled:o||!n}),u&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:u}),!n&&a.jsx("p",{className:"text-yellow-600 text-sm text-center bg-yellow-50 p-2 rounded border border-yellow-200",children:"You must be logged in to suggest a gym."}),a.jsx("button",{type:"submit",disabled:o||!s.trim()||!n,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx(ie,{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ju,{size:18}),a.jsx("span",{children:"Send Suggestion"})]})})]})})]})})},_a=5,jv=({preSelectedGymsIds:e,onGymsSelected:t,onNext:r,currentUser:n})=>{const[s,i]=m.useState(""),[o,l]=m.useState(new Set(e)),[u,c]=m.useState([]),[d,h]=m.useState(!1),[p,v]=m.useState(!1),[x,b]=m.useState(null),[k,g]=m.useState(0),[f,y]=m.useState(!0),[_,S]=m.useState(!1),N=m.useRef(null),P=m.useCallback(async(j=0,V=!1,Y=s)=>{V?v(!0):(c([]),g(0),y(!0)),b(null);const Z=j*_a,W=Z+_a-1;try{let J=H.from("gyms").select("id, name, city, state, country",{count:"exact"}).order("name",{ascending:!0}).range(Z,W);if(Y.trim()){const I=`%${Y.trim()}%`;J=J.or(`name.ilike.${I},city.ilike.${I},state.ilike.${I}`)}const{data:ne,error:w,count:C}=await J;if(w)throw new Error(`Failed to load gyms: ${w.message}`);ne?(c(I=>V?[...I,...ne]:ne),g(j),y((j+1)*_a<(C??0))):(V||c([]),y(!1))}catch(J){console.error("Error fetching gyms:",J),b(J.message||"An unexpected error occurred."),V||c([]),y(!1)}finally{v(!1)}},[s]);m.useEffect(()=>{P(0)},[]),m.useEffect(()=>(N.current&&clearTimeout(N.current),s.trim()?N.current=setTimeout(()=>{P(0,!1,s)},300):P(0,!1,""),()=>{N.current&&clearTimeout(N.current)}),[s,P]);const A=j=>{const V=new Set(o);V.has(j)?V.delete(j):V.add(j),l(V),t(Array.from(V))},$=()=>{!p&&f&&P(k+1,!0,s)},O=()=>{r(Array.from(o))};return a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center p-4 pt-12",children:[a.jsxs("div",{className:"w-full max-w-lg",children:[a.jsx("h2",{className:"text-3xl font-bold text-center text-brand-green mb-2",children:"Select Your Gym(s)"}),a.jsx("p",{className:"text-center text-brand-gray mb-6",children:"Choose your primary climbing locations."}),a.jsxs("div",{className:"relative mb-6",children:[a.jsx("input",{type:"text",placeholder:"Search by gym name, city, or state...",value:s,onChange:j=>i(j.target.value),className:"w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue",disabled:d&&!p}),a.jsx(ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden max-h-[50vh] overflow-y-auto mb-6 border border-gray-200",children:d&&u.length===0?a.jsxs("div",{className:"flex justify-center items-center p-10",children:[a.jsx(ie,{className:"animate-spin text-accent-blue",size:32}),a.jsx("p",{className:"ml-3 text-brand-gray",children:"Loading gyms..."})]}):x?a.jsx("p",{className:"text-center text-red-500 p-6",children:x}):u.length>0?a.jsxs(a.Fragment,{children:[u.map(j=>a.jsxs("div",{onClick:()=>A(j.id),className:`flex items-center justify-between p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ${o.has(j.id)?"bg-accent-blue/10":""}`,children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Qn,{size:18,className:"text-brand-gray mr-3 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-brand-gray",children:j.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:[j.city,", ",j.state]})]})]}),o.has(j.id)?a.jsx(Fg,{className:"text-accent-blue",size:24}):a.jsx(Zg,{className:"text-gray-300",size:24})]},j.id)),f&&a.jsx("div",{className:"p-4 text-center border-t border-gray-100",children:a.jsx("button",{onClick:$,disabled:p,className:"text-accent-blue hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center w-full",children:p?a.jsxs(a.Fragment,{children:[a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading..."]}):"Load More Gyms"})})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No gyms found matching your search."})}),a.jsx("button",{onClick:O,disabled:o.size===0||d||!!x,className:`w-full font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg ${o.size>0&&!d&&!x?"bg-accent-blue text-white hover:bg-opacity-90":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:o.size>0?`Continue with ${o.size} Gym(s)`:"Select at least one gym"}),a.jsxs("p",{className:"text-center text-xs text-gray-400 mt-4",children:["Can't find your gym?"," ",a.jsx("button",{onClick:()=>S(!0),className:"underline hover:text-accent-blue disabled:opacity-50",disabled:!n,children:"Suggest it"})]})]}),_&&a.jsx(Sv,{title:"Suggest a Gym",feedbackType:"gym_suggestion",onClose:()=>S(!1),currentUser:n})]})},Nv=e=>{if(!e)return"text-brand-gray";const t={"accent-red":"text-accent-red","accent-blue":"text-accent-blue","accent-yellow":"text-accent-yellow","brand-green":"text-brand-green","accent-purple":"text-accent-purple","brand-gray":"text-brand-gray","brand-brown":"text-brand-brown"};return t[e]||t[e.replace("_","-")]||"text-brand-gray"},Ev=e=>{const t=new Date,r=new Date(e),n=Math.floor((t.getTime()-r.getTime())/1e3),s=Math.floor(n/60),i=Math.floor(s/60),o=Math.floor(i/24);return n<60?`${n}s ago`:s<60?`${s}m ago`:i<24?`${i}h ago`:o===1?"Yesterday":o<7?`${o}d ago`:r.toLocaleDateString()},Cv=e=>{const t=e.user_display_name||`User ${e.user_id.substring(0,6)}`,r=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return e.user_avatar_url||r},ba=10,sd=({currentUser:e,selectedGyms:t,activeGymId:r,onSwitchGym:n,getGymNameById:s,onNavigateToGymSelection:i,onNavigate:o})=>{const[l,u]=m.useState(!1),[c,d]=m.useState(""),[h,p]=m.useState([]),[v,x]=m.useState(!1),[b,k]=m.useState(!1),[g,f]=m.useState(null),[y,_]=m.useState(0),[S,N]=m.useState(!0),[P,A]=m.useState(null),[$,O]=m.useState(!1),[j,V]=m.useState(null),Y=T=>{n(T),u(!1)},Z=()=>{u(!1),i()},W=T=>{d(T.target.value)},J=()=>{o("routes",{searchTerm:c.trim()})},ne=m.useCallback(async(T=0,D=!1)=>{if(!r){p([]),x(!1),k(!1),f(null),N(!1);return}D?k(!0):(x(!0),p([]),_(0),N(!0)),f(null);const ee=T*ba,ue=ee+ba-1;try{const{data:pe,error:De,count:U}=await H.from("activity_log").select(`
                        *,
                        profile:profiles!user_id(display_name, avatar_url),
                        route:routes(
                          name,
                          grade,
                          grade_color,
                          location_info:locations ( name )
                        )
                    `,{count:"exact"}).eq("gym_id",r).order("created_at",{ascending:!1}).range(ee,ue);if(De)console.error("Error fetching activity log:",De),f(`Failed to load activity: ${De.message}`),D||p([]),N(!1);else if(pe){const fe=pe.map(oe=>{var me,we,ge,ke,Be,B,M;const K=oe.route,ce=K==null?void 0:K.location_info;return{...oe,user_display_name:(me=oe.profile)==null?void 0:me.display_name,user_avatar_url:(we=oe.profile)==null?void 0:we.avatar_url,route_name:(K==null?void 0:K.name)||((ge=oe.details)==null?void 0:ge.route_name),route_grade:(K==null?void 0:K.grade)||((ke=oe.details)==null?void 0:ke.route_grade),route_grade_color:(K==null?void 0:K.grade_color)||((Be=oe.details)==null?void 0:Be.route_grade_color),location_name:(ce==null?void 0:ce.name)||((B=oe.details)==null?void 0:B.location_name),followed_user_display_name:(M=oe.details)==null?void 0:M.followed_user_name,followed_user_avatar_url:null,details:oe.details}});p(oe=>D?[...oe,...fe]:fe),_(T),N(pe.length===ba)}else D||p([]),N(!1)}catch(pe){console.error("Unexpected error fetching activity log:",pe),f(pe.message||"An unexpected error occurred."),D||p([]),N(!1)}finally{x(!1),k(!1)}},[r]),w=m.useCallback(async T=>{if(!e||!T){A(null),O(!1),V(null);return}O(!0),V(null);try{const{data:D,error:ee}=await H.rpc("get_user_gym_quick_stats",{user_id_in:e.id,gym_id_in:T});if(ee)throw new Error(`Failed to load quick stats: ${ee.message}`);A(D?{sendsThisMonth:D.sendsThisMonth,highestGradeSent:D.highestGradeSent,betaAddedThisMonth:D.betaAddedThisMonth}:{sendsThisMonth:0,highestGradeSent:null,betaAddedThisMonth:0})}catch(D){console.error("Unexpected error fetching quick stats via RPC:",D),V(D.message||"An unexpected error occurred fetching stats."),A(null)}finally{O(!1)}},[e]);m.useEffect(()=>{ne(0),w(r)},[ne,w,r]);const C=()=>{!b&&S&&ne(y+1,!0)},I=T=>{var B,M,te,X,Q,Ne,q,xe,Te,ft,rt;let D=a.jsx(Bc,{size:18,className:"text-gray-500"}),ee="performed an action.";const ue=T.user_display_name||`User ${T.user_id.substring(0,6)}`,De=(e==null?void 0:e.id)===T.user_id?a.jsx("span",{className:"font-medium",children:ue}):a.jsxs("button",{onClick:()=>o("publicProfile",{profileUserId:T.user_id}),className:"font-medium hover:underline text-brand-green",children:[" ",ue," "]}),U=T.route_name||((B=T.details)==null?void 0:B.route_name)||"a route",fe=T.route_grade||((M=T.details)==null?void 0:M.route_grade)||"N/A",oe=T.route_grade_color||((te=T.details)==null?void 0:te.route_grade_color),K=T.location_name||((X=T.details)==null?void 0:X.location_name),ce=Nv(oe),me=a.jsxs(a.Fragment,{children:[T.route_id&&T.route_name?a.jsxs("button",{onClick:()=>o("routeDetail",{routeId:T.route_id}),className:`font-medium hover:underline ${ce}`,children:[" ",U," (",fe,") "]}):a.jsxs("span",{className:`font-medium ${ce}`,children:[" ",U," (",fe,") "]}),K&&a.jsxs("span",{className:"text-gray-500 text-xs",children:[" at ",K]})]}),we=((Q=T.details)==null?void 0:Q.followed_user_name)||"another user",ge=(Ne=T.details)==null?void 0:Ne.followed_user_id,ke=ge===(e==null?void 0:e.id),Be=ge?a.jsxs("button",{onClick:()=>o("publicProfile",{profileUserId:ge}),className:"font-medium hover:underline text-brand-green",children:[" ",ke?"you":we," "]}):a.jsx("span",{className:"font-medium",children:we});switch(T.activity_type){case"log_send":D=a.jsx(ts,{size:18,className:"text-green-500"}),ee=a.jsxs(a.Fragment,{children:["sent ",me,". ",(q=T.details)!=null&&q.attempts?`(${T.details.attempts} attempts)`:""]});break;case"log_attempt":D=a.jsx(Co,{size:18,className:"text-orange-400"}),ee=a.jsxs(a.Fragment,{children:["attempted ",me,"."]});break;case"add_beta":D=((xe=T.details)==null?void 0:xe.beta_type)==="video"?a.jsx(Qs,{size:18,className:"text-blue-500"}):((Te=T.details)==null?void 0:Te.beta_type)==="drawing"?a.jsx(Kg,{size:18,className:"text-purple-500"}):a.jsx(Bc,{size:18,className:"text-blue-500"}),ee=a.jsxs(a.Fragment,{children:["added ",((ft=T.details)==null?void 0:ft.beta_type)||""," beta for ",me,"."]});break;case"add_comment":D=a.jsx(Ph,{size:18,className:"text-indigo-500"}),ee=a.jsxs(a.Fragment,{children:["commented on ",me,': "',((rt=T.details)==null?void 0:rt.comment_snippet)||"...",'"']});break;case"add_route":D=a.jsx(Rh,{size:18,className:"text-brand-green"}),ee=a.jsxs(a.Fragment,{children:["added a new route: ",me,"."]});break;case"follow_user":D=a.jsx(Lo,{size:18,className:"text-accent-purple"}),ee=a.jsxs(a.Fragment,{children:["started following ",Be,"."]});break}return a.jsxs("div",{className:"bg-white p-3 rounded-lg shadow flex items-start space-x-3",children:[a.jsx("img",{src:Cv(T),alt:ue||"User Avatar",className:"w-10 h-10 rounded-full object-cover flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[" ",a.jsxs("div",{className:"text-sm",children:[De," ",ee]})," ",a.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:Ev(T.created_at)})," "]}),a.jsx("div",{className:"flex-shrink-0 ml-auto mt-1",children:D})]},T.id)},F=()=>$?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):j?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(yr,{size:20,className:"inline mr-1 mb-0.5"})," ",j," "]}):P?a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[" ",a.jsxs("div",{className:"p-3 bg-accent-blue/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-blue",children:P.sendsThisMonth})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Sends This Month"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-purple/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-purple",children:P.highestGradeSent||"N/A"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Highest Grade"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-yellow/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-yellow",children:P.betaAddedThisMonth})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Beta Added (Month)"})," "]})," "]}):a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[" ",a.jsxs("div",{className:"p-3 bg-accent-blue/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-blue",children:"0"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Sends This Month"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-purple/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-purple",children:"N/A"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Highest Grade"})," "]})," ",a.jsxs("div",{className:"p-3 bg-accent-yellow/10 rounded",children:[" ",a.jsx("p",{className:"text-2xl font-bold text-accent-yellow",children:"0"})," ",a.jsx("p",{className:"text-sm text-brand-gray",children:"Beta Added (Month)"})," "]})," "]}),E=s(r);return a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:[a.jsxs("div",{className:"flex justify-between items-center relative",children:[a.jsxs("button",{onClick:()=>u(!l),className:"flex items-center text-brand-green hover:text-opacity-80",children:[" ",a.jsx("h1",{className:"text-xl font-bold mr-1 truncate max-w-[200px] sm:max-w-xs",children:E})," ",a.jsx($n,{size:20,className:`transition-transform ${l?"rotate-180":""}`})," "]}),l&&a.jsxs("div",{className:"absolute top-full left-0 mt-2 w-60 bg-white rounded-md shadow-lg border z-20 max-h-60 overflow-y-auto",children:[" ",t.length>1&&t.map(T=>a.jsxs("button",{onClick:()=>Y(T),className:`block w-full text-left px-4 py-2 text-sm truncate ${r===T?"bg-accent-blue/10 text-accent-blue font-semibold":"text-brand-gray hover:bg-gray-100"}`,children:[" ",s(T)," "]},T))," ",t.length>1&&a.jsx("hr",{className:"my-1 border-gray-200"})," ",a.jsxs("button",{onClick:Z,className:"flex items-center w-full text-left px-4 py-2 text-sm text-accent-blue hover:bg-accent-blue/10",children:[" ",a.jsx(Lh,{size:16,className:"mr-2"})," Choose more gyms... "]})," "]})]}),a.jsxs("div",{className:"relative mt-4",children:[a.jsx("input",{type:"text",value:c,onChange:W,className:"absolute inset-0 opacity-0 pointer-events-none","aria-hidden":"true"}),a.jsxs("button",{onClick:J,className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-gray-100 text-left flex items-center text-gray-500 hover:border-gray-400",children:[" ",a.jsx(ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})," ",c||`Search routes at ${E}...`," "]})]})]}),a.jsxs("main",{className:"flex-grow p-4 space-y-6 overflow-y-auto pb-20",children:[a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:["Quick Stats (",E,")"]}),F()]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Recent Activity"}),v?a.jsxs("div",{className:"flex justify-center items-center p-6 bg-white rounded-lg shadow",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," ",a.jsx("p",{className:"text-brand-gray",children:"Loading activity..."})," "]}):g?a.jsx("p",{className:"text-center text-red-500 p-6 bg-white rounded-lg shadow",children:g}):h.length>0?a.jsxs("div",{className:"space-y-3",children:[h.map(I),S&&a.jsx("button",{onClick:C,disabled:b,className:"w-full mt-3 text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:b?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6 bg-white rounded-lg shadow",children:"No recent activity in this gym yet."})]})]})]})},Pv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Tv=({route:e,onClick:t})=>{const{name:r,grade:n,grade_color:s,location_name:i,setter:o,date_set:l,status:u,textBetaCount:c,videoBetaCount:d,hasComments:h,hasNotes:p,isOnWishlist:v,averageRating:x,ratingCount:b}=e,k=16,g="gap-1.5",f=i||"Unknown Location";return a.jsxs("div",{onClick:t,className:"bg-white p-4 rounded-lg shadow border border-gray-200 flex items-center gap-4 hover:shadow-md transition-shadow duration-200 cursor-pointer",children:[a.jsx("div",{className:`w-12 h-12 ${Pv(s)} rounded-full flex items-center justify-center text-white font-bold text-lg flex-shrink-0 shadow`,children:n}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsxs("div",{className:"flex flex-row gap-x-2 items-center",children:[" ",a.jsx("h3",{className:"text-lg font-semibold text-brand-gray truncate",children:r}),a.jsx("div",{className:`flex flex-row items-center ${g}`,children:v&&a.jsx(uo,{size:k-2,className:"text-accent-yellow",fill:"currentColor",title:"On Wishlist"})})]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-600 mt-1 gap-x-3 gap-y-1 flex-wrap",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Qn,{size:14})," ",f]}),o&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lo,{size:14})," ",o]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nh,{size:14})," ",new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]})]}),a.jsxs("div",{className:`flex flex-col items-end ${g} flex-shrink-0 ml-auto pl-2`,children:[c||d||b?a.jsxs("div",{className:"flex flex-row h-5 mb-1 gap-x-2",children:[" ",c&&c>0?a.jsxs("span",{className:"flex items-center text-blue-500",title:`${c} Text Beta`,children:[a.jsx(Su,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:c})]}):null,d&&d>0?a.jsxs("span",{className:"flex items-center text-purple-500",title:`${d} Video Beta`,children:[a.jsx(Qs,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:d})]}):null,b&&b>0?a.jsxs("span",{className:"flex items-center text-yellow-500",title:`Average Rating Available (${b} ratings)`,children:[a.jsx(Po,{size:k}),a.jsx("span",{className:"text-xs ml-0.5",children:x==null?void 0:x.toFixed(1)})]}):null]}):null,a.jsxs("div",{className:`flex flex-row ${g} h-5`,children:[" ",u==="sent"&&a.jsx(ts,{size:k,className:"text-green-500",title:"Sent"}),u==="attempted"&&a.jsx(Co,{size:k,className:"text-orange-400",title:"Attempted"})]})]})]})},id=e=>{if(e&&e.toUpperCase().startsWith("V")){const r=e.substring(1).split("-"),n=parseInt(r[r.length-1],10);return isNaN(n)?-1:n}return-1},ka=10,Lv=({activeGymId:e,activeGymName:t,onNavigate:r,initialSearchTerm:n,currentUser:s})=>{const[i,o]=m.useState(n||""),[l,u]=m.useState(!1),[c,d]=m.useState([]),[h,p]=m.useState(new Map),[v,x]=m.useState(new Map),[b,k]=m.useState(new Map),[g,f]=m.useState([]),[y,_]=m.useState(!1),[S,N]=m.useState(!1),[P,A]=m.useState(null),[$,O]=m.useState(0),[j,V]=m.useState(!0),[Y,Z]=m.useState(""),[W,J]=m.useState(""),[ne,w]=m.useState("all"),[C,I]=m.useState("date_newest"),F=m.useRef(null),[E,T]=m.useState(!1),D=m.useRef(null);m.useEffect(()=>{o(n||""),n||T(!1)},[n]),m.useEffect(()=>{n&&!E&&setTimeout(()=>{F.current&&(F.current.focus(),T(!0))},250)},[n,E]);const ee=m.useCallback(async(U=0,fe=!1)=>{if(!e){d([]),p(new Map),x(new Map),k(new Map),f([]),A(null),_(!1),N(!1),V(!1);return}fe?N(!0):(_(!0),d([]),O(0),V(!0),p(new Map),x(new Map),k(new Map)),A(null);const oe=U*ka;try{if(U===0){const{data:ge,error:ke}=await H.from("locations").select("*").eq("gym_id",e).order("name",{ascending:!0});ke?console.error("[RoutesScreen] Error fetching locations:",ke.message):f(ge||[])}const{data:K,error:ce}=await H.rpc("get_filtered_routes",{gym_id_in:e,search_term_in:i||null,location_id_in:Y||null,grade_in:W||null,sort_option_in:C!=="rating_highest"?C:"date_newest",page_size_in:ka,page_offset_in:oe});if(ce)throw new Error(`Failed to load routes via RPC: ${ce.message}`);if(!K||K.length===0){fe||d([]),V(!1),_(!1),N(!1);return}const me=K;d(ge=>fe?[...ge,...me]:me),O(U),V(me.length===ka);const we=me.map(ge=>ge.id);if(s&&we.length>0){const{data:ge,error:ke}=await H.from("user_route_progress").select("*").eq("user_id",s.id).in("route_id",we);ke?console.error("[RoutesScreen] Error fetching user progress:",ke.message):ge&&p(Be=>{const B=new Map(Be);return ge.forEach(M=>B.set(M.route_id,M)),B})}if(we.length>0){const{data:ge,error:ke}=await H.rpc("get_route_card_stats",{route_ids:we});ke?console.error("[RoutesScreen] Error fetching route card stats via RPC:",ke.message):ge&&x(Be=>{const B=new Map(Be);return ge.forEach(M=>{B.set(M.route_id,{textBetaCount:Number(M.text_beta_count),videoBetaCount:Number(M.video_beta_count),averageRating:M.average_rating,ratingCount:Number(M.rating_count)})}),B})}if(we.length>0){const{data:ge,error:ke}=await H.rpc("get_route_comment_counts",{route_ids:we});ke?console.error("[RoutesScreen] Error fetching comment counts via RPC:",ke.message):ge&&k(Be=>{const B=new Map(Be);return ge.forEach(M=>B.set(M.route_id,M.count)),B})}}catch(K){console.error("[RoutesScreen] Unexpected error fetching route data:",K),A(K.message||"An unexpected error occurred."),fe||(d([]),p(new Map),x(new Map),k(new Map),f([])),V(!1)}finally{_(!1),N(!1)}},[e,s,i,Y,W,C]);m.useEffect(()=>(D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{ee(0)},300),()=>{D.current&&clearTimeout(D.current)}),[i,ee]),m.useEffect(()=>{ee(0)},[e,s,Y,W,C,ee]);const ue=()=>{!S&&j&&ee($+1,!0)},pe=m.useMemo(()=>{const U=new Set(c.map(fe=>fe.grade).filter(Boolean));return Array.from(U).sort((fe,oe)=>{const K=id(fe),ce=id(oe);return K!==-1&&ce!==-1?K-ce:fe.localeCompare(oe)})},[c]),De=m.useMemo(()=>{let fe=c.map(oe=>{const K=h.get(oe.id),ce=v.get(oe.id)||{textBetaCount:0,videoBetaCount:0,averageRating:null,ratingCount:0},me=b.get(oe.id)||0;let we="unseen";return K!=null&&K.sent_at?we="sent":K!=null&&K.attempts&&K.attempts>0&&(we="attempted"),{...oe,status:we,textBetaCount:ce.textBetaCount,videoBetaCount:ce.videoBetaCount,averageRating:ce.averageRating,ratingCount:ce.ratingCount,hasComments:me>0,hasNotes:!!(K!=null&&K.notes)&&K.notes.trim().length>0,isOnWishlist:!!(K!=null&&K.wishlist)}});return ne!=="all"&&(fe=fe.filter(oe=>ne==="wishlist"?oe.isOnWishlist:oe.status===ne)),C==="rating_highest"?[...fe].sort((oe,K)=>{const ce=oe.averageRating??-1;return(K.averageRating??-1)-ce}):fe},[c,h,v,b,ne,C]);return!e&&!y&&c.length===0?a.jsx("div",{className:"p-4 pt-16 text-center text-brand-gray",children:"Please select a gym first."}):a.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:[a.jsxs("h1",{className:"text-xl font-bold text-center text-brand-green mb-4",children:[t," - Routes"]}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx("input",{ref:F,type:"text",placeholder:"Search routes by name, grade, location...",value:i,onChange:U=>o(U.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-gray-100"}),a.jsx(ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsxs("button",{onClick:()=>u(!l),className:"p-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-100 text-brand-gray","aria-label":"Filters",children:[" ",a.jsx(Xg,{size:20})," "]})]})]}),l&&a.jsxs("div",{className:"bg-white p-4 border-b border-gray-200 shadow-sm",children:[a.jsx("h3",{className:"text-sm font-semibold mb-2 text-brand-gray",children:"Filter & Sort"}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm",children:[a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:Y,onChange:U=>Z(U.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"",children:"All Locations"}),g.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]}),a.jsx($n,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:W,onChange:U=>J(U.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"",children:"All Grades"}),pe.map(U=>a.jsx("option",{value:U,children:U},U))]}),a.jsx($n,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:ne,onChange:U=>w(U.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"sent",children:"Sent"}),a.jsx("option",{value:"attempted",children:"Attempted"}),a.jsx("option",{value:"unseen",children:"Unseen"}),a.jsx("option",{value:"wishlist",children:"Wishlist"})]}),a.jsx($n,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:C,onChange:U=>I(U.target.value),className:"w-full appearance-none bg-gray-50 border border-gray-300 rounded p-2 pr-8 text-brand-gray hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-accent-blue",children:[a.jsx("option",{value:"date_newest",children:"Sort: Newest"}),a.jsx("option",{value:"grade_hardest",children:"Sort: Grade (Hardest)"}),a.jsx("option",{value:"grade_easiest",children:"Sort: Grade (Easiest)"}),a.jsx("option",{value:"rating_highest",children:"Sort: Avg Rating"})]}),a.jsx($n,{size:16,className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]})]}),a.jsx("main",{className:"flex-grow p-4 space-y-3 overflow-y-auto pb-20",children:y&&c.length===0?a.jsxs("div",{className:"flex justify-center items-center pt-10",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," ",a.jsx("p",{className:"text-brand-gray",children:"Loading routes..."})," "]}):P?a.jsx("p",{className:"text-center text-red-500 mt-8",children:P}):De.length>0?a.jsxs(a.Fragment,{children:[De.map(U=>a.jsx(Tv,{route:U,onClick:()=>r("routeDetail",{routeId:U.id})},U.id)),j&&a.jsx("button",{onClick:ue,disabled:S,className:"w-full mt-3 text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:S?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Routes"})]}):a.jsx("p",{className:"text-center text-gray-500 mt-8",children:i||Y||W||ne!=="all"?"No routes found matching your criteria.":"No active routes found for this gym yet."})})]})},wn={attempts:0,sentDate:null,rating:null,notes:"",wishlist:!1},Sa=5,ja=2,Rv="route-beta",Av=300,$v=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},od=(e,t,r)=>{var n;return r!=null&&r.display_name?r.display_name:t&&e===t.id?((n=t.user_metadata)==null?void 0:n.display_name)||"You":`User ${e.substring(0,6)}...`},ad=(e,t)=>{const r=t?`User ${t.substring(0,6)}`:"User",n=`https://ui-avatars.com/api/?name=${encodeURIComponent((e==null?void 0:e.display_name)||r)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||n},Ov=e=>{if(!e)return null;switch(e){case"start":return"Start Moves";case"crux":return"Crux Sequence";case"middle":return"Middle Section";case"topout":return"Top Out / Finish";default:return null}},zv=({currentUser:e,route:t,isLoading:r,error:n,onBack:s,onNavigate:i})=>{const[o,l]=m.useState(wn),[u,c]=m.useState(!1),[d,h]=m.useState(!1),[p,v]=m.useState(null),[x,b]=m.useState([]),[k,g]=m.useState(!1),[f,y]=m.useState(!1),[_,S]=m.useState(null),[N,P]=m.useState("text"),[A,$]=m.useState(0),[O,j]=m.useState(!0),[V,Y]=m.useState([]),[Z,W]=m.useState(!1),[J,ne]=m.useState(!1),[w,C]=m.useState(!1),[I,F]=m.useState(null),[E,T]=m.useState(""),[D,ee]=m.useState(0),[ue,pe]=m.useState(!0),[De,U]=m.useState({}),[fe,oe]=m.useState({}),K=m.useCallback(async()=>{if(!e||!t){l(wn);return}c(!0),v(null);try{const{data:L,error:re}=await H.from("user_route_progress").select("attempts, sent_at, rating, notes, wishlist").eq("user_id",e.id).eq("route_id",t.id).maybeSingle();re?(v("Failed to load your progress."),l(wn)):l(L?{attempts:L.attempts??0,sentDate:L.sent_at,rating:L.rating,notes:L.notes??"",wishlist:L.wishlist??!1}:wn)}catch{v("An unexpected error occurred."),l(wn)}finally{c(!1)}},[e,t]);m.useEffect(()=>{t&&e&&!r?K():(l(wn),c(!1),v(null))},[t,e,r,K]);const ce=m.useCallback(async L=>{if(!e||!t){v("Cannot save progress: User or Route missing.");return}if(t.removed_at){v("Cannot save progress: This route has been removed.");return}h(!0),v(null);const re={user_id:e.id,route_id:t.id,attempts:L.attempts??o.attempts,sent_at:L.sent_at!==void 0?L.sent_at:o.sentDate,rating:L.rating!==void 0?L.rating:o.rating,notes:L.notes??o.notes,wishlist:L.wishlist??o.wishlist};try{const{error:ve}=await H.from("user_route_progress").upsert(re,{onConflict:"user_id, route_id"});ve&&(v(`Failed to save progress: ${ve.message}`),await K())}catch{v("An unexpected error occurred."),await K()}finally{h(!1)}},[e,t,o,K]),me=m.useCallback(async(L=0,re=!1)=>{if(!t){Y([]),W(!1),ne(!1),F(null),pe(!1);return}re?ne(!0):(W(!0),Y([]),ee(0),pe(!0)),F(null);const ve=L*Sa,Me=ve+Sa-1;try{const{data:Ee,error:Ie,count:bt}=await H.from("route_comments").select("*, profile:profiles!user_id ( display_name, avatar_url )",{count:"exact"}).eq("route_id",t.id).order("created_at",{ascending:!0}).range(ve,Me);if(Ie)F("Failed to load comments."),re||Y([]),pe(!1);else if(Ee){const Tt=Ee.map(ir=>{var hn,pn;return{...ir,display_name:((hn=ir.profile)==null?void 0:hn.display_name)||void 0,avatar_url:((pn=ir.profile)==null?void 0:pn.avatar_url)||void 0}});Y(ir=>re?[...ir,...Tt]:Tt),ee(L),pe(Ee.length===Sa)}else re||Y([]),pe(!1)}catch{F("An unexpected error occurred."),re||Y([]),pe(!1)}finally{W(!1),ne(!1)}},[t]);m.useEffect(()=>{t&&!r?me(0):(Y([]),W(!1),F(null),pe(!1))},[t,r,me]);const we=m.useCallback(async(L=0,re=!1,ve)=>{if(!t){b([]),g(!1),y(!1),S(null),j(!1);return}re?y(!0):(g(!0),b([]),$(0),j(!0)),S(null);const Me=L*ja,Ee=Me+ja-1;try{const{data:Ie,error:bt}=await H.from("route_beta").select("*, profile:profiles ( display_name, avatar_url )").eq("route_id",t.id).eq("beta_type",ve).order("created_at",{ascending:!1}).range(Me,Ee);if(bt)S(`Failed to load ${ve} beta.`),re||b([]),j(!1);else if(Ie){const Tt=Ie.map(Le=>{var Gr,xr;return{...Le,display_name:((Gr=Le.profile)==null?void 0:Gr.display_name)||void 0,avatar_url:((xr=Le.profile)==null?void 0:xr.avatar_url)||void 0,signedUrl:void 0}}),ir=Tt.filter(Le=>Le.beta_type==="video"&&Le.content_url).map(async Le=>{var Gr;try{console.log("beta content url",Le.content_url);const xr=(Gr=Le.content_url)==null?void 0:Gr.split("/route-beta/")[1],{data:Bo,error:mn}=await H.storage.from(Rv).createSignedUrl(xr,Av);return mn?(console.error(`Error generating signed URL for ${Le.content_url}:`,mn),{id:Le.id,signedUrl:null}):{id:Le.id,signedUrl:Bo.signedUrl}}catch(xr){return console.error(`Unexpected error generating signed URL for ${Le.content_url}:`,xr),{id:Le.id,signedUrl:null}}}),hn=await Promise.all(ir),pn=new Map(hn.map(Le=>[Le.id,Le.signedUrl])),or=Tt.map(Le=>({...Le,signedUrl:pn.get(Le.id)||void 0}));b(Le=>re?[...Le,...or]:or),$(L),j(Ie.length===ja),(re&&e&&or.length>0||!re&&e&&or.length>0)&&ge(or)}else re||b([]),j(!1)}catch{S(`An unexpected error occurred while loading ${ve} beta.`),re||b([]),j(!1)}finally{g(!1),y(!1)}},[t,e]),ge=m.useCallback(async L=>{if(!e||L.length===0)return;const re=L.map(ve=>ve.id);try{const{data:ve,error:Me}=await H.from("route_beta_votes").select("beta_id, vote_value").eq("user_id",e.id).in("beta_id",re);Me?console.error("[fetchUserVotes] Error fetching user votes:",Me):ve&&U(Ee=>{const Ie={...Ee};return ve.forEach(bt=>{Ie[bt.beta_id]=bt.vote_value}),Ie})}catch(ve){console.error("[fetchUserVotes] Unexpected error fetching user votes:",ve)}},[e]);m.useEffect(()=>{t&&!r?we(0,!1,N):(b([]),g(!1),y(!1),S(null),j(!1),U({}))},[t,r,N,we]);const ke=async(L,re)=>{if(!e||t!=null&&t.removed_at)return;let Me=De[L]===re?0:re;oe(Ee=>({...Ee,[L]:!0}));try{const{data:Ee,error:Ie}=await H.rpc("handle_beta_vote",{beta_id_in:L,vote_value_in:Me});Ie?(console.error("[handleVote] Error calling handle_beta_vote RPC:",Ie),alert(`Error submitting vote: ${Ie.message}`)):(U(bt=>({...bt,[L]:Me})),b(bt=>bt.map(Tt=>Tt.id===L?{...Tt,upvotes:Ee??Tt.upvotes}:Tt)))}catch(Ee){console.error("[handleVote] Unexpected error handling vote:",Ee),alert("An unexpected error occurred while voting.")}finally{oe(Ee=>({...Ee,[L]:!1}))}},Be=()=>{if(t!=null&&t.removed_at)return;const L=o.attempts+1;l(re=>({...re,attempts:L})),ce({attempts:L})},B=async(L,re)=>{if(o.sentDate||!re||!L||re.removed_at)return;const ve=new Date().toISOString(),Me=o.attempts<1?1:o.attempts;l(bt=>({...bt,sentDate:ve,attempts:Me})),ce({sent_at:ve,attempts:Me});const Ee={route_name:re.name,route_grade:re.grade,attempts:Me,location_name:re.location_name},{error:Ie}=await H.from("activity_log").insert({user_id:L.id,gym_id:re.gym_id,route_id:re.id,activity_type:"log_send",details:Ee});Ie&&console.error("Error logging add_send activity:",Ie)},M=L=>{if(t!=null&&t.removed_at)return;const re=o.rating===L?null:L;l(ve=>({...ve,rating:re})),ce({rating:re})},te=()=>{if(t!=null&&t.removed_at)return;const L=!o.wishlist;l(re=>({...re,wishlist:L})),ce({wishlist:L})},X=L=>{t!=null&&t.removed_at||l(re=>({...re,notes:L.target.value}))},Q=()=>{t!=null&&t.removed_at||ce({notes:o.notes})},Ne=async L=>{if(L.preventDefault(),!e||!t||!E.trim()||t.removed_at)return;C(!0),F(null);const re=E.trim();try{const{data:ve,error:Me}=await H.from("route_comments").insert({route_id:t.id,user_id:e.id,comment_text:re}).select().single();if(Me)F(`Failed to post comment: ${Me.message}`);else if(ve){const Ee={route_name:t.name,route_grade:t.grade,comment_snippet:re.substring(0,50)+(re.length>50?"...":""),location_name:t.location_name},{error:Ie}=await H.from("activity_log").insert({user_id:e.id,gym_id:t.gym_id,route_id:t.id,activity_type:"add_comment",details:Ee});Ie&&console.error("Error logging add_comment activity:",Ie),T(""),await me(0)}}catch{F("An unexpected error occurred.")}finally{C(!1)}},q=L=>{L===(e==null?void 0:e.id)?i("profile"):i("publicProfile",{profileUserId:L})},xe=()=>{!J&&ue&&me(D+1,!0)},Te=()=>{!f&&O&&we(A+1,!0,N)},ft=L=>{P(L)};if(r)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue",size:48})," "]});if(n||!t)return a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4 text-center",children:[" ",a.jsx(yr,{size:48,className:"text-red-500 mb-4"})," ",a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Route"})," ",a.jsx("p",{className:"text-red-600 mb-6",children:n||"The requested route could not be found."})," ",a.jsxs("button",{onClick:s,className:"bg-accent-blue text-white px-4 py-2 rounded-md hover:bg-opacity-90 flex items-center gap-2",children:[" ",a.jsx(ln,{size:18})," Go Back "]})," "]});const{id:rt,name:wt,grade:Yt,grade_color:Xe,location_name:Dt,setter:Ut,date_set:be,description:Ve,image_url:ss,removed_at:fn}=t,is=Dt||"Unknown Location",_t=!!fn;return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsxs("button",{onClick:s,className:"mr-4 text-brand-gray hover:text-brand-green",children:[" ",a.jsx(ln,{size:24})," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("h1",{className:"text-xl font-bold text-brand-green truncate",children:wt}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 gap-x-3 flex-wrap",children:[a.jsx("span",{className:`font-semibold px-1.5 py-0.5 rounded text-white text-xs ${$v(Xe)}`,children:Yt}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Qn,{size:14})," ",is]})]})]}),a.jsx("button",{onClick:te,disabled:d||u||_t,className:`ml-4 p-1 rounded disabled:opacity-50 ${o.wishlist?"text-accent-yellow":"text-gray-400 hover:text-accent-yellow/80"}`,children:d&&o.wishlist!==void 0?a.jsx(ie,{size:24,className:"animate-spin"}):a.jsx(uo,{size:24,fill:o.wishlist?"currentColor":"none"})})]}),a.jsxs("main",{className:"p-4 space-y-6",children:[_t&&a.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow flex items-center gap-3",role:"alert",children:[a.jsx(zg,{size:20,className:"flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:"Route Removed"}),a.jsxs("p",{className:"text-sm",children:["This route was removed on ",new Date(fn).toLocaleDateString()," and is no longer on the wall. Progress logging and commenting are disabled."]})]})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[ss?a.jsx("img",{src:ss,alt:`Photo of ${wt}`,className:"w-full h-48 object-cover"}):a.jsxs("div",{className:"w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center text-brand-gray",children:[" ",a.jsx(Qn,{size:48})," "]}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2 gap-x-4 gap-y-1 flex-wrap",children:[Ut&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Lo,{size:14})," Set by ",Ut]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nh,{size:14})," Set on ",new Date(be).toLocaleDateString()]})]}),Ve&&a.jsx("p",{className:"text-sm text-brand-gray",children:Ve})]})]}),a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow relative",children:[(u||d)&&a.jsxs("div",{className:"absolute inset-0 bg-white/70 flex items-center justify-center z-10 rounded-lg",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue",size:24})," ",a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:u?"Loading Progress...":"Saving..."})," "]}),a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Your Progress"}),p&&a.jsx("p",{className:"text-red-500 text-sm mb-3 text-center",children:p}),a.jsxs("fieldset",{disabled:u||d||_t,className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[" ",a.jsxs("button",{onClick:Be,className:"flex-1 bg-orange-100 text-orange-600 hover:bg-orange-200 font-medium py-2 px-3 rounded text-sm text-center disabled:opacity-50 disabled:cursor-not-allowed",children:["Log Attempt (",o.attempts,")"]})," ",a.jsxs("button",{onClick:()=>B(e,t),disabled:!!o.sentDate||_t,className:`flex-1 font-medium py-2 px-3 rounded text-sm text-center ${o.sentDate?"bg-green-200 text-green-700 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"} disabled:opacity-50 disabled:cursor-not-allowed`,children:[" ",o.sentDate?`Sent ${new Date(o.sentDate).toLocaleDateString()}`:"Log Send"," "]})," "]}),a.jsxs("div",{children:[" ",a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-1",children:"Your Rating"})," ",a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(L=>a.jsx("button",{onClick:()=>M(L),children:a.jsx(Po,{size:24,className:L<=(o.rating||0)?"text-accent-yellow":"text-gray-300",fill:L<=(o.rating||0)?"currentColor":"none"})},L))})," "]}),a.jsxs("div",{children:[" ",a.jsx("label",{htmlFor:"personalNotes",className:"block text-sm font-medium text-brand-gray mb-1",children:"Private Notes"})," ",a.jsx("textarea",{id:"personalNotes",rows:3,value:o.notes,onChange:X,onBlur:Q,placeholder:"Add your personal beta, reminders, etc.",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})," "]})]})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[" ",a.jsx("h2",{className:"text-lg font-semibold text-brand-gray",children:"Community Beta"})," ",a.jsxs("button",{onClick:()=>i("addBeta",{routeId:rt}),disabled:_t,className:"bg-accent-blue text-white text-xs font-semibold px-3 py-1 rounded-full hover:bg-opacity-90 flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[" ",a.jsx(Lh,{size:14})," Add Beta "]})," "]}),a.jsxs("div",{className:"flex border-b",children:[a.jsxs("button",{onClick:()=>ft("text"),className:`flex-1 py-2 text-center text-sm font-medium ${N==="text"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Su,{size:16,className:"inline mr-1 mb-0.5"})," Tips"]}),a.jsxs("button",{onClick:()=>ft("video"),className:`flex-1 py-2 text-center text-sm font-medium ${N==="video"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Qs,{size:16,className:"inline mr-1 mb-0.5"})," Videos"]})]}),a.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[" ",k&&x.length===0?a.jsx("div",{className:"flex justify-center items-center py-4",children:a.jsx(ie,{className:"animate-spin text-accent-blue",size:24})}):_?a.jsx("p",{className:"text-red-500 text-sm text-center py-4",children:_}):a.jsxs(a.Fragment,{children:[x.length>0?x.map(L=>{const re=De[L.id],ve=fe[L.id],Me=L.user_id===(e==null?void 0:e.id),Ee=Ov(L.key_move);return a.jsxs("div",{className:"flex gap-3 border-b pb-3 last:border-b-0",children:[a.jsx("img",{src:ad(L,L.user_id),alt:"User avatar",className:"w-8 h-8 rounded-full flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("button",{onClick:()=>q(L.user_id),disabled:Me,className:`text-sm font-medium text-brand-gray ${Me?"cursor-default":"hover:underline hover:text-accent-blue cursor-pointer"}`,children:[" ",od(L.user_id,e,L)," "]}),L.beta_type==="text"&&a.jsx("p",{className:"text-sm text-gray-700 mt-1",children:L.text_content}),L.beta_type==="video"&&L.signedUrl&&a.jsxs("a",{href:L.signedUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline mt-1 block",children:["Watch Video ",a.jsx(Qs,{size:14,className:"inline ml-1"})]}),L.beta_type==="video"&&!L.signedUrl&&L.content_url&&a.jsx("span",{className:"text-sm text-red-500 mt-1 block",children:"Could not load video link."}),a.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mt-2 flex-wrap",children:[" ",a.jsx("span",{children:new Date(L.created_at).toLocaleDateString()}),Ee&&a.jsxs("span",{className:"flex items-center gap-1 bg-gray-200 text-brand-gray px-1.5 py-0.5 rounded",children:[a.jsx(Hg,{size:12})," ",Ee]}),a.jsxs("button",{onClick:()=>ke(L.id,1),disabled:!e||ve||_t,className:`flex items-center gap-1 hover:text-green-600 disabled:opacity-50 ${re===1?"text-green-600 font-semibold":"text-gray-500"}`,children:[" ",ve&&re!==-1?a.jsx(ie,{size:14,className:"animate-spin"}):a.jsx(ey,{size:14})," ",L.upvotes," "]})]})]})]},L.id)}):a.jsxs("p",{className:"text-sm text-center text-gray-500 py-4",children:["No ",N," beta available yet."]}),O&&a.jsx("button",{onClick:Te,disabled:f,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Beta"})]})]})]}),a.jsxs("section",{className:"bg-white p-4 rounded-lg shadow",children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray mb-3",children:"Discussion"}),Z&&V.length===0?a.jsx("div",{className:"flex justify-center items-center py-4",children:a.jsx(ie,{className:"animate-spin text-accent-blue",size:24})}):I?a.jsx("p",{className:"text-red-500 text-sm text-center py-4",children:I}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:[" ",V.length>0?V.map(L=>{const re=L.user_id===(e==null?void 0:e.id);return a.jsxs("div",{className:"flex gap-3 border-b pb-3 last:border-b-0",children:[a.jsx("img",{src:ad(L,L.user_id),alt:"User avatar",className:"w-8 h-8 rounded-full flex-shrink-0 mt-1"}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("p",{className:"text-sm",children:[a.jsxs("button",{onClick:()=>q(L.user_id),disabled:re,className:`font-medium text-brand-gray ${re?"cursor-default":"hover:underline hover:text-accent-blue cursor-pointer"}`,children:[" ",od(L.user_id,e,L)," "]}),a.jsx("span",{className:"text-xs text-gray-400 ml-1",children:new Date(L.created_at).toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})})]}),a.jsx("p",{className:"text-sm text-gray-700 mt-1",children:L.comment_text})]})]},L.id)}):a.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No comments yet. Start the discussion!"})]}),ue&&a.jsx("button",{onClick:xe,disabled:J,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:J?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More Comments"})]}),a.jsxs("form",{onSubmit:Ne,className:"flex gap-2 items-center pt-4 border-t mt-4",children:[a.jsx("input",{type:"text",value:E,onChange:L=>T(L.target.value),placeholder:e?_t?"Commenting disabled for removed routes":"Add a comment...":"Log in to comment",className:"flex-grow p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",disabled:!e||w||_t}),a.jsxs("button",{type:"submit",className:"bg-accent-blue text-white p-2 rounded-md hover:bg-opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e||!E.trim()||w||_t,children:[" ",w?a.jsx(ie,{size:20,className:"animate-spin"}):a.jsx(ju,{size:20})," "]})]})]})]})]})},Mv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},ld="route-beta",Iv=({currentUser:e,route:t,onBack:r,onSubmitSuccess:n})=>{const{name:s,grade:i,grade_color:o,id:l,gym_id:u}=t,[c,d]=m.useState("text"),[h,p]=m.useState(""),[v,x]=m.useState(null),[b,k]=m.useState(""),[g,f]=m.useState(!1),[y,_]=m.useState(null),S=$=>{if($.target.files&&$.target.files[0]){const O=$.target.files[0];if(c==="video"&&!["video/mp4","video/quicktime","video/webm"].includes(O.type)){_("Invalid file type. Please select a video file."),x(null),$.target.value="";return}if(O.size>50*1024*1024){_("File size exceeds 50MB limit."),x(null),$.target.value="";return}_(null),x(O)}else x(null)},N=async $=>{if(!e)return;const{error:O}=await H.from("activity_log").insert({user_id:e.id,gym_id:u,route_id:l,activity_type:"add_beta",details:$});O?console.error("Error logging add_beta activity:",O):console.log("add_beta activity logged successfully.")},P=async $=>{if($.preventDefault(),!e){_("You must be logged in to submit beta.");return}if(f(!0),_(null),c==="text"&&!h.trim()){_("Please enter some text for the tip."),f(!1);return}if(c==="video"&&!v){_("Please select a video file to upload."),f(!1);return}try{let O={route_id:l,user_id:e.id,beta_type:c,key_move:b||null},j=null;if(c==="video"&&v){const Z=v.name.split(".").pop(),W=`${e.id}/${l}/${Date.now()}_${v.name.replace(/[^a-zA-Z0-9.]/g,"_")}.${Z}`,{error:J}=await H.storage.from(ld).upload(W,v);if(J)throw new Error(`Failed to upload video: ${J.message}`);const{data:ne}=H.storage.from(ld).getPublicUrl(W);if(!(ne!=null&&ne.publicUrl))throw new Error("Failed to get public URL for the uploaded video.");j=ne.publicUrl,O.content_url=j,O.text_content=null}else c==="text"&&(O.text_content=h.trim(),O.content_url=null);const{error:V}=await H.from("route_beta").insert(O);if(V)throw new Error(`Failed to save beta information: ${V.message}`);await N({route_name:s,route_grade:i,beta_type:c}),console.log("Beta submitted successfully!"),n()}catch(O){console.error("Error during beta submission:",O),_(O.message||"An unexpected error occurred during submission.")}finally{f(!1)}},A=()=>{switch(c){case"text":return a.jsx("textarea",{rows:6,value:h,onChange:$=>p($.target.value),placeholder:"Share your beta, sequence tips, or insights...",className:"w-full p-3 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue",required:!0});case"video":return a.jsxs("div",{className:`w-full p-4 border-2 border-dashed rounded-lg text-center cursor-pointer ${y&&!v?"border-red-500 bg-red-50":"border-gray-300 bg-gray-50 hover:border-accent-blue"}`,children:[a.jsx("input",{type:"file",id:"fileUpload",accept:"video/*",onChange:S,className:"hidden",required:!v}),a.jsxs("label",{htmlFor:"fileUpload",className:"cursor-pointer",children:[a.jsx(ry,{size:40,className:"mx-auto text-gray-400 mb-2"}),v?a.jsxs("div",{children:[" ",a.jsx("p",{className:"text-sm font-medium text-brand-gray",children:v.name})," ",a.jsxs("p",{className:"text-xs text-gray-500",children:[(v.size/1024/1024).toFixed(2)," MB"]})," ",a.jsx("span",{className:"text-accent-blue text-sm underline mt-1 block",children:"Change file"})," "]}):a.jsxs("p",{className:"text-sm text-brand-gray",children:[" Click to upload a video ",a.jsx("span",{className:"text-accent-blue font-medium",children:"(Max 50MB)"})," "]})]})]});default:return null}};return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsxs("button",{onClick:r,className:"mr-4 text-brand-gray hover:text-brand-green",children:[" ",a.jsx(ln,{size:24})," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("h1",{className:"text-xl font-bold text-brand-green truncate",children:"Add Beta For:"}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 gap-x-2",children:[" ",a.jsx("span",{className:`font-semibold px-1.5 py-0.5 rounded text-white text-xs ${Mv(o)}`,children:i})," ",a.jsx("span",{className:"truncate",children:s})," "]})]})]}),a.jsxs("form",{onSubmit:P,className:"p-4 space-y-5",children:[a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:"Beta Type"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:["text","video"].map($=>{const O=$==="text"?Su:Qs,j=$.charAt(0).toUpperCase()+$.slice(1);return a.jsxs("button",{type:"button",onClick:()=>{d($),x(null),p(""),_(null)},className:`flex flex-col items-center justify-center p-3 border rounded-lg transition-colors ${c===$?"bg-accent-blue/10 border-accent-blue text-accent-blue ring-1 ring-accent-blue":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(O,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs font-medium",children:j})]},$)})})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:c==="text"?"Your Tip":"Upload Video"}),A()]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"keyMove",className:"block text-sm font-medium text-brand-gray mb-1",children:"Applies To (Optional)"}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{id:"keyMove",value:b,onChange:$=>k($.target.value),className:"w-full appearance-none bg-white border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue pr-8",children:[a.jsx("option",{value:"",children:"General / Whole Route"}),a.jsx("option",{value:"start",children:"Start Moves"}),a.jsx("option",{value:"crux",children:"Crux Sequence"}),a.jsx("option",{value:"middle",children:"Middle Section"}),a.jsx("option",{value:"topout",children:"Top Out / Finish"})]}),a.jsx("svg",{className:"w-4 h-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),y&&a.jsx("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded border border-red-300",children:y}),a.jsx("button",{type:"submit",disabled:g||!e,className:"w-full bg-brand-green hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"})," Submitting... "]}):"Submit Beta"}),!e&&a.jsx("p",{className:"text-xs text-center text-red-600 mt-2",children:"You must be logged in to submit beta."})]})]})},Fv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Dv=({currentUser:e,activeGymId:t,availableRoutes:r,onBack:n,onSubmitSuccess:s})=>{const[i,o]=m.useState(""),[l,u]=m.useState("send"),[c,d]=m.useState(1),[h,p]=m.useState(new Date().toISOString().split("T")[0]),[v,x]=m.useState(null),[b,k]=m.useState(""),[g,f]=m.useState(!1),[y,_]=m.useState(null),[S,N]=m.useState(""),[P,A]=m.useState(!1),[$,O]=m.useState(null),[j,V]=m.useState(!1),[Y,Z]=m.useState(null),W=m.useMemo(()=>r.filter(E=>!E.removed_at),[r]),J=m.useMemo(()=>W.find(E=>E.id===i),[i,W]),ne=m.useMemo(()=>S?W.filter(E=>{var T,D,ee;return(((T=E.name)==null?void 0:T.toLowerCase())||"").includes(S.toLowerCase())||(((D=E.grade)==null?void 0:D.toLowerCase())||"").includes(S.toLowerCase())||(((ee=E.location_name)==null?void 0:ee.toLowerCase())||"").includes(S.toLowerCase())}):W,[S,W]),w=m.useCallback(async E=>{if(!e||!E){O(null),V(!1),Z(null);return}V(!0),Z(null);try{const{data:T,error:D}=await H.from("user_route_progress").select("attempts, sent_at, rating, notes, wishlist").eq("user_id",e.id).eq("route_id",E).maybeSingle();if(D)throw new Error(`Failed to fetch existing progress: ${D.message}`);O(T)}catch(T){console.error("Error fetching existing progress:",T),Z(T.message||"Could not load existing progress."),O(null)}finally{V(!1)}},[e]);m.useEffect(()=>{$?(d($.attempts??1),x($.rating??null),k($.notes??""),$.sent_at?(u("send"),p(new Date($.sent_at).toISOString().split("T")[0])):(u("send"),p(new Date().toISOString().split("T")[0]))):(u("send"),d(1),p(new Date().toISOString().split("T")[0]),x(null),k(""))},[$]);const C=E=>{o(E);const T=W.find(D=>D.id===E);N(T?`${T.name} (${T.grade})`:""),A(!1),w(E)},I=m.useCallback(async(E,T,D)=>{if(!e)return;const{error:ee}=await H.from("activity_log").insert({user_id:e.id,gym_id:T.gym_id,route_id:T.id,activity_type:E,details:D});ee?console.error(`Error logging ${E} activity:`,ee):console.log(`${E} activity logged successfully.`)},[e]),F=async E=>{if(E.preventDefault(),_(null),!e){_("You must be logged in to log climbs.");return}if(!i||!J){_("Please select a route.");return}if(J.removed_at){_("This route has been removed and cannot be logged.");return}f(!0);try{let T=!1,D=1;const ee=$??(await H.from("user_route_progress").select("attempts, sent_at, wishlist").eq("user_id",e.id).eq("route_id",i).maybeSingle()).data,ue=(ee==null?void 0:ee.attempts)??0,pe=!!(ee!=null&&ee.sent_at),De=(ee==null?void 0:ee.wishlist)??!1;let U={user_id:e.id,route_id:i,rating:v,notes:b.trim()||null,wishlist:De};l==="send"?(D=Math.max(1,c),U={...U,attempts:D,sent_at:new Date(h).toISOString()}):(D=ue+1,U={...U,attempts:D,...pe&&{sent_at:ee.sent_at}});const{error:fe}=await H.from("user_route_progress").upsert(U,{onConflict:"user_id, route_id"});if(fe)throw new Error(`Failed to save log: ${fe.message}`);if(T=!0,T){const oe={route_name:J.name,route_grade:J.grade,route_grade_color:J.grade_color,location_name:J.location_name,...l==="send"&&{attempts:D}};await I(l==="send"?"log_send":"log_attempt",J,oe),console.log("Log submitted successfully!"),s()}}catch(T){console.error("Error during log submission:",T),_(T.message||"An unexpected error occurred.")}finally{f(!1)}};return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-10",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsx("button",{onClick:n,className:"mr-4 text-brand-gray hover:text-brand-green",children:a.jsx(ln,{size:24})}),a.jsx("h1",{className:"text-xl font-bold text-brand-green",children:"Log Climb"})]}),a.jsxs("form",{onSubmit:F,className:"p-4 space-y-5",children:[a.jsxs("section",{children:[a.jsx("label",{htmlFor:"routeSearch",className:"block text-sm font-medium text-brand-gray mb-1",children:"Route"}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md bg-white",children:[a.jsx(ri,{size:18,className:"text-gray-400 mx-2 flex-shrink-0"}),a.jsx("input",{type:"text",id:"routeSearch",placeholder:"Search or select active route...",value:S,onChange:E=>{N(E.target.value),A(!0),i&&(o(""),O(null),u("send"),d(1),p(new Date().toISOString().split("T")[0]),x(null),k(""))},onFocus:()=>A(!0),onBlur:()=>setTimeout(()=>A(!1),150),className:"w-full py-2 pr-8 border-none focus:ring-0 text-sm",autoComplete:"off"}),a.jsx($n,{size:16,className:`absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 transition-transform ${P?"rotate-180":""}`})]}),P&&a.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 max-h-48 overflow-y-auto bg-white border border-gray-300 rounded-md shadow-lg z-20",children:ne.length>0?ne.map(E=>a.jsxs("button",{type:"button",onClick:()=>C(E.id),className:"block w-full text-left px-3 py-2 text-sm hover:bg-gray-100 truncate",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${Fv(E.grade_color)}`}),E.name," (",E.grade,") - ",E.location_name||"Unknown Location"]},E.id)):a.jsx("p",{className:"px-3 py-2 text-sm text-gray-500",children:"No active routes found."})})]}),J&&!P&&a.jsxs("div",{className:"mt-1 text-xs text-gray-500 pl-2",children:["Selected: ",J.name," (",J.grade,") - ",J.location_name||"Unknown Location",j&&a.jsx("span",{className:"ml-2 italic",children:"(Loading progress...)"}),Y&&a.jsxs("span",{className:"ml-2 text-red-500 italic",children:["(",Y,")"]})]})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-2",children:"Log Type"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("button",{type:"button",onClick:()=>u("send"),disabled:j,className:`flex items-center justify-center p-3 border rounded-lg transition-colors disabled:opacity-50 ${l==="send"?"bg-green-100 border-green-400 text-green-700 ring-1 ring-green-400":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Dg,{size:20,className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Send"})]}),a.jsxs("button",{type:"button",onClick:()=>u("attempt"),disabled:j,className:`flex items-center justify-center p-3 border rounded-lg transition-colors disabled:opacity-50 ${l==="attempt"?"bg-orange-100 border-orange-400 text-orange-700 ring-1 ring-orange-400":"bg-white border-gray-300 text-brand-gray hover:bg-gray-50"}`,children:[a.jsx(Co,{size:20,className:"mr-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Attempt"})]})]})]}),l==="send"&&a.jsxs("section",{children:[a.jsx("label",{htmlFor:"attempts",className:"block text-sm font-medium text-brand-gray mb-1",children:"Attempts for Send"}),a.jsx("input",{type:"number",id:"attempts",value:c,onChange:E=>d(Math.max(1,parseInt(E.target.value)||1)),min:"1",disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-brand-gray mb-1",children:"Date"}),a.jsx("input",{type:"date",id:"date",value:h,onChange:E=>p(E.target.value),max:new Date().toISOString().split("T")[0],disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),a.jsxs("section",{children:[a.jsx("label",{className:"block text-sm font-medium text-brand-gray mb-1",children:"Rating / Feel (Optional)"}),a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(E=>a.jsx("button",{type:"button",onClick:()=>x(v===E?null:E),disabled:j,children:a.jsx(Po,{size:28,className:E<=(v||0)?"text-accent-yellow":"text-gray-300",fill:E<=(v||0)?"currentColor":"none"})},E))}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How did it feel for the grade?"})]}),a.jsxs("section",{children:[a.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-brand-gray mb-1",children:"Notes (Private)"}),a.jsx("textarea",{id:"notes",rows:4,value:b,onChange:E=>k(E.target.value),placeholder:"Any thoughts on the climb, conditions, etc.?",disabled:j,className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100"})]}),y&&a.jsx("p",{className:"text-red-500 text-sm text-center bg-red-100 p-2 rounded border border-red-300",children:y}),a.jsx("button",{type:"submit",disabled:g||j||!i||!e,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[a.jsx(ie,{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white"}),"Saving..."]}):"Save Log"}),!e&&a.jsx("p",{className:"text-xs text-center text-red-600 mt-2",children:"You must be logged in to log climbs."})]})]})},Uv=e=>{const t=(e==null?void 0:e.display_name)||"User",r=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||r},Na=15,ip=({userId:e,dialogType:t,currentUser:r,onClose:n,onNavigate:s})=>{const[i,o]=m.useState([]),[l,u]=m.useState(!0),[c,d]=m.useState(!1),[h,p]=m.useState(null),[v,x]=m.useState(0),[b,k]=m.useState(!0),[g,f]=m.useState(new Map),[y,_]=m.useState(new Map),S=m.useCallback(async(j=0,V=!1)=>{V?d(!0):(u(!0),o([]),x(0),k(!0)),p(null);const Y=j*Na,Z=Y+Na-1;try{let W;t==="followers"?W=H.from("user_follows").select("follower:profiles!follower_id(*)").eq("following_id",e):W=H.from("user_follows").select("following:profiles!following_id(*)").eq("follower_id",e);const{data:J,error:ne}=await W.order("created_at",{ascending:!1}).range(Y,Z);if(ne)throw new Error(`Failed to load ${t}: ${ne.message}`);if(J){const w=J.map(C=>t==="followers"?C.follower:C.following).filter(Boolean);o(C=>V?[...C,...w]:w),x(j),k(w.length===Na),r&&w.length>0&&N(w.map(C=>C.user_id))}else V||o([]),k(!1)}catch(W){console.error(`Error fetching ${t}:`,W),p(W.message||"An unexpected error occurred."),V||o([]),k(!1)}finally{u(!1),d(!1)}},[e,t,r]),N=m.useCallback(async j=>{if(!(!r||j.length===0))try{const{data:V,error:Y}=await H.from("user_follows").select("following_id").eq("follower_id",r.id).in("following_id",j);if(Y){console.error("Error fetching follow statuses for list:",Y);return}const Z=new Map;j.forEach(W=>{const J=(V==null?void 0:V.some(ne=>ne.following_id===W))??!1;Z.set(W,J)}),f(W=>{const J=new Map(W);return Z.forEach((ne,w)=>J.set(w,ne)),J})}catch(V){console.error("Unexpected error fetching follow statuses for list:",V)}},[r]);m.useEffect(()=>{S(0)},[S]);const P=async(j,V)=>{if(!r||r.id===j||y.get(j))return;_(Z=>new Map(Z).set(j,!0));const Y=g.get(j)||!1;try{Y?(await Do(r.id,j),f(Z=>new Map(Z).set(j,!1))):(await Fo(r.id,j),f(Z=>new Map(Z).set(j,!0)))}catch(Z){console.error("Error updating follow status from dialog:",Z);const W=await Uo(r.id,j);f(J=>new Map(J).set(j,W))}finally{_(Z=>new Map(Z).set(j,!1))}},A=()=>{!c&&b&&S(v+1,!0)},$=j=>{n(),s(j===(r==null?void 0:r.id)?"profile":"publicProfile",{profileUserId:j})},O=t==="followers"?"Followers":"Following";return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold text-brand-gray",children:O}),a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Nu,{size:24})})]}),a.jsx("div",{className:"flex-grow overflow-y-auto p-4",children:l&&i.length===0?a.jsx("div",{className:"flex justify-center items-center py-6",children:a.jsx(ie,{className:"animate-spin text-accent-blue",size:24})}):h?a.jsxs("p",{className:"text-center text-red-500 py-6 flex items-center justify-center gap-2",children:[a.jsx(yr,{size:18})," ",h]}):i.length>0?a.jsx("div",{className:"space-y-3",children:i.map(j=>{const V=j.user_id===(r==null?void 0:r.id),Y=g.get(j.user_id)||!1,Z=y.get(j.user_id)||!1;return a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("button",{onClick:()=>$(j.user_id),className:"flex items-center gap-3 flex-grow hover:opacity-80",children:[a.jsx("img",{src:Uv(j),alt:j.display_name,className:"w-10 h-10 rounded-full object-cover bg-gray-300"}),a.jsx("div",{children:a.jsx("p",{className:"font-medium text-brand-gray text-sm",children:j.display_name})})]}),r&&!V&&a.jsx("button",{onClick:()=>P(j.user_id,j.display_name),disabled:Z,className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors duration-200 flex items-center gap-1 disabled:opacity-60 ${Y?"bg-gray-200 text-brand-gray hover:bg-gray-300":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:Z?a.jsx(ie,{size:14,className:"animate-spin"}):Y?a.jsxs(a.Fragment,{children:[a.jsx(To,{size:14})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ni,{size:14})," Follow"]})})]},j.user_id)})}):a.jsx("p",{className:"text-center text-gray-500 py-6",children:t==="followers"?"No followers yet.":"Not following anyone yet."})}),b&&a.jsx("div",{className:"p-4 border-t text-center",children:a.jsx("button",{onClick:A,disabled:c,className:"text-sm text-accent-blue hover:underline disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center w-full",children:c?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Load More"})})]})})},ud=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Bv=e=>{if(e&&e.toUpperCase().startsWith("V")){const r=e.substring(1).split("-"),n=parseInt(r[r.length-1],10);return isNaN(n)?-1:n}return-1},Ea=10,Ca=10,cd="avatars",Vv=({currentUser:e,viewingProfileId:t,onNavigate:r,getGymNameById:n})=>{const[s,i]=m.useState(null),[o,l]=m.useState(!0),[u,c]=m.useState(null),[d,h]=m.useState("logbook"),[p,v]=m.useState(!1),[x,b]=m.useState(""),[k,g]=m.useState(null),[f,y]=m.useState(!1),[_,S]=m.useState(null),[N,P]=m.useState(!1),[A,$]=m.useState(null),O=m.useRef(null),[j,V]=m.useState([]),[Y,Z]=m.useState(!0),[W,J]=m.useState(!1),[ne,w]=m.useState(null),[C,I]=m.useState(0),[F,E]=m.useState(!0),[T,D]=m.useState([]),[ee,ue]=m.useState(!0),[pe,De]=m.useState(!1),[U,fe]=m.useState(null),[oe,K]=m.useState(0),[ce,me]=m.useState(!0),[we,ge]=m.useState(null),[ke,Be]=m.useState(!0),[B,M]=m.useState(null),[te,X]=m.useState(!1),[Q,Ne]=m.useState(!0),[q,xe]=m.useState(!1),[Te,ft]=m.useState({followers:0,following:0}),[rt,wt]=m.useState(!0),[Yt,Xe]=m.useState(!1),[Dt,Ut]=m.useState("followers"),be=t||(e==null?void 0:e.id),Ve=!t||t===(e==null?void 0:e.id),ss=m.useCallback(async()=>{if(!be){i(null),l(!1),c("No user ID provided.");return}l(!0),c(null);try{const{data:z,error:ae}=await H.from("profiles").select("*").eq("user_id",be).single();ae?(console.error("Error fetching profile data:",ae),c(ae.code==="PGRST116"?"Profile not found.":"Failed to load profile."),i(null)):(i(z),b((z==null?void 0:z.display_name)||""))}catch(z){console.error("Unexpected error fetching profile:",z),c(z.message||"An unexpected error occurred."),i(null)}finally{l(!1)}},[be]),fn=m.useCallback(async()=>{if(Ve||!e||!be){X(!1),Ne(!1);return}Ne(!0);try{const z=await Uo(e.id,be);X(z)}catch(z){console.error("Error checking follow status:",z)}finally{Ne(!1)}},[e,be,Ve]),is=m.useCallback(async()=>{if(!be){ft({followers:0,following:0}),wt(!1);return}wt(!0);try{const z=await np(be);ft({followers:z.followers,following:z.following})}catch(z){console.error("Error fetching follow counts:",z)}finally{wt(!1)}},[be]),_t=m.useCallback(async(z=0,ae=!1)=>{if(!be){V([]),Z(!1),J(!1),w(null),E(!1);return}ae?J(!0):(Z(!0),V([]),I(0),E(!0)),w(null);const Ae=z*Ea,at=Ae+Ea-1;try{const{data:He,error:Bt}=await H.from("user_route_progress").select(`
              attempts, sent_at, rating, notes, wishlist, updated_at,
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",be).or("sent_at.not.is.null,attempts.gt.0").order("updated_at",{ascending:!1}).range(Ae,at);if(Bt)console.error("Error fetching logbook:",Bt),w("Failed to load climb log."),ae||V([]),E(!1);else if(He){const Lt=He.map(Ge=>{const Rt=Ge.route,Xt=Rt==null?void 0:Rt.location_name;return{...Rt,location_name:(Xt==null?void 0:Xt.name)||null,user_progress_attempts:Ge.attempts,user_progress_sent_at:Ge.sent_at,user_progress_rating:Ge.rating,user_progress_notes:Ge.notes,user_progress_wishlist:Ge.wishlist,user_progress_updated_at:Ge.updated_at}});V(Ge=>ae?[...Ge,...Lt]:Lt),I(z),E(He.length===Ea)}else ae||V([]),E(!1)}catch(He){console.error("Unexpected error fetching logbook:",He),w(He.message||"An unexpected error occurred."),ae||V([]),E(!1)}finally{Z(!1),J(!1)}},[be]),L=m.useCallback(async(z=0,ae=!1)=>{if(!be){D([]),ue(!1),De(!1),fe(null),me(!1);return}ae?De(!0):(ue(!0),D([]),K(0),me(!0)),fe(null);const Ae=z*Ca,at=Ae+Ca-1;try{const{data:He,error:Bt}=await H.from("user_route_progress").select(`
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",be).eq("wishlist",!0).is("route.removed_at",null).order("created_at",{referencedTable:"routes",ascending:!1}).range(Ae,at);if(Bt)console.error("Error fetching wishlist:",Bt),fe("Failed to load wishlist."),ae||D([]),me(!1);else if(He){const Lt=He.map(Ge=>{const Rt=Ge.route,Xt=Rt==null?void 0:Rt.location_name;return{...Rt,location_name:(Xt==null?void 0:Xt.name)||null}});D(Ge=>ae?[...Ge,...Lt]:Lt),K(z),me(He.length===Ca)}else ae||D([]),me(!1)}catch(He){console.error("Unexpected error fetching wishlist:",He),fe(He.message||"An unexpected error occurred."),ae||D([]),me(!1)}finally{ue(!1),De(!1)}},[be]),re=m.useCallback(async()=>{if(!be){ge(null),Be(!1),M(null);return}Be(!0),M(null);try{const{data:z,error:ae}=await H.from("user_route_progress").select(" route_id, route:routes ( grade ) ").eq("user_id",be).not("sent_at","is",null);if(ae)throw console.error("Error fetching stats data:",ae),new Error("Failed to load data for stats calculation.");if(z){const Ae=z.length,at=new Set(z.map(Lt=>Lt.route_id)).size;let He=null,Bt=-1;z.forEach(Lt=>{var Rt;const Ge=(Rt=Lt.route)==null?void 0:Rt.grade;if(Ge){const Xt=Bv(Ge);Xt>Bt&&(Bt=Xt,He=Ge)}}),ge({totalSends:Ae,uniqueRoutes:at,highestGrade:He})}else ge({totalSends:0,uniqueRoutes:0,highestGrade:null})}catch(z){console.error("Unexpected error fetching stats:",z),M(z.message||"An unexpected error occurred while calculating stats."),ge(null)}finally{Be(!1)}},[be]);m.useEffect(()=>{l(!0),Z(!0),ue(!0),Be(!0),Ne(!0),wt(!0),c(null),w(null),fe(null),M(null),I(0),E(!0),K(0),me(!0),S(null),P(!1),$(null),Xe(!1),ss(),fn(),is(),_t(0),L(0),re()},[be,ss,fn,is,_t,L,re]);const ve=()=>{g(null),b((s==null?void 0:s.display_name)||""),v(!0)},Me=()=>{v(!1),g(null)},Ee=async()=>{if(!e||!Ve)return;const z=x.trim();if(!z){g("Display name cannot be empty.");return}if(z===(s==null?void 0:s.display_name)){v(!1);return}y(!0),g(null);try{const{error:ae}=await H.from("profiles").update({display_name:z}).eq("user_id",e.id);if(ae)throw ae;const{error:Ae}=await H.auth.updateUser({data:{display_name:z}});if(Ae)throw console.error("Auth metadata update failed after profile update:",Ae),new Error(`Auth update failed: ${Ae.message}. Profile might be updated.`);console.log("Profile and auth metadata updated successfully."),i(at=>at?{...at,display_name:z}:null),v(!1)}catch(ae){console.error("Error saving display name:",ae),g(`Failed to update name: ${ae.message}`)}finally{y(!1)}},Ie=()=>{var z;Ve&&!N&&((z=O.current)==null||z.click())},bt=z=>{if(z.target.files&&z.target.files[0]){const ae=z.target.files[0],Ae=["image/jpeg","image/png","image/gif"],at=5*1024*1024;if(!Ae.includes(ae.type)){$("Invalid file type. Please select a JPG, PNG, or GIF."),S(null);return}if(ae.size>at){$("File size exceeds 5MB limit."),S(null);return}$(null),S(ae),Tt(ae)}z.target&&(z.target.value="")},Tt=async z=>{if(!(!z||!e||!Ve)){P(!0),$(null);try{const ae=`${e.id}`,{error:Ae}=await H.storage.from(cd).upload(ae,z,{cacheControl:"3600",upsert:!0});if(Ae)throw new Error(`Failed to upload avatar: ${Ae.message}`);const{data:at}=H.storage.from(cd).getPublicUrl(ae);if(!(at!=null&&at.publicUrl))throw new Error("Failed to get public URL for the uploaded avatar.");const He=`${at.publicUrl}?t=${new Date().getTime()}`,{error:Bt}=await H.from("profiles").update({avatar_url:He}).eq("user_id",e.id);if(Bt)throw new Error(`Failed to update profile with new avatar URL: ${Bt.message}`);const{error:Lt}=await H.auth.updateUser({data:{avatar_url:He}});Lt&&console.error("Failed to update auth user metadata with avatar URL:",Lt),i(Ge=>Ge?{...Ge,avatar_url:He}:null),S(null),console.log("Avatar uploaded and profile updated successfully!")}catch(ae){console.error("Error uploading avatar:",ae),$(ae.message||"An unexpected error occurred during upload.")}finally{P(!1)}}},ir=async()=>{if(!(!e||!be||Ve||q)){xe(!0);try{if(te)await Do(e.id,be),X(!1),ft(z=>({...z,followers:Math.max(0,z.followers-1)}));else{await Fo(e.id,be),X(!0),ft(Ae=>({...Ae,followers:Ae.followers+1}));const z={followed_user_id:be,followed_user_name:(s==null?void 0:s.display_name)||"User"},{error:ae}=await H.from("activity_log").insert({user_id:e.id,gym_id:s==null?void 0:s.current_gym_id,activity_type:"follow_user",details:z});ae&&console.error("Error logging follow activity:",ae)}}catch(z){console.error("Error updating follow status:",z),await fn(),await is()}finally{xe(!1)}}},hn=()=>{!W&&F&&_t(C+1,!0)},pn=()=>{!pe&&ce&&L(oe+1,!0)},or=z=>{be&&(Ut(z),Xe(!0))},Le=()=>{Xe(!1)},Gr=z=>{const ae=z.location_name||"Unknown Location",Ae=!!z.removed_at;return a.jsxs("div",{onClick:()=>r("routeDetail",{routeId:z.id}),className:`flex items-center gap-3 p-3 border-b last:border-b-0 ${Ae?"opacity-60 bg-gray-50":"hover:bg-gray-50 cursor-pointer"}`,children:[a.jsxs("div",{className:`w-8 h-8 ${ud(z.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",z.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:`font-medium text-brand-gray truncate ${Ae?"line-through":""}`,children:z.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[" ",ae," - Logged: ",new Date(z.user_progress_updated_at).toLocaleDateString()," ",Ae&&"(Removed)"," "]})]}),z.user_progress_sent_at?a.jsx(ts,{size:18,className:"text-green-500 flex-shrink-0",title:`Sent (${z.user_progress_attempts} attempts)`}):z.user_progress_attempts>0?a.jsx(Co,{size:18,className:"text-orange-400 flex-shrink-0",title:`Attempted (${z.user_progress_attempts} attempts)`}):null]},z.id)},xr=z=>{const ae=z.location_name||"Unknown Location";return z.removed_at?null:a.jsxs("div",{onClick:()=>r("routeDetail",{routeId:z.id}),className:"flex items-center gap-3 p-3 border-b last:border-b-0 hover:bg-gray-50 cursor-pointer",children:[a.jsxs("div",{className:`w-8 h-8 ${ud(z.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",z.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:"font-medium text-brand-gray truncate",children:z.name}),a.jsx("p",{className:"text-xs text-gray-500",children:ae})]}),a.jsx(uo,{size:18,className:"text-accent-yellow flex-shrink-0"})]},z.id)},Bo=()=>ke?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):B?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(yr,{size:20,className:"inline mr-1 mb-0.5"})," ",B," "]}):we?a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-blue/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Total Sends"})," ",a.jsx("span",{className:"font-bold text-accent-blue",children:we.totalSends})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-purple/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Unique Routes Climbed"})," ",a.jsx("span",{className:"font-bold text-accent-purple",children:we.uniqueRoutes})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-red/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Highest Grade Sent"})," ",a.jsx("span",{className:"font-bold text-accent-red",children:we.highestGrade||"N/A"})," "]})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No stats available yet."});if(u&&!o)return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 text-center",children:[a.jsx(yr,{size:48,className:"text-red-500 mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Profile"}),a.jsx("p",{className:"text-red-600 mb-6",children:u})]});const mn=o?"Loading...":(s==null?void 0:s.display_name)||"Climber",op=o?"":(s==null?void 0:s.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(mn)}&background=random&color=fff`,Ru=o?[]:(s==null?void 0:s.selected_gym_ids)||[];return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[a.jsxs("header",{className:"bg-gradient-to-r from-brand-green to-brand-gray p-4 pt-8 pb-20 text-white relative",children:[!Ve&&a.jsx("button",{onClick:()=>r("discover"),className:"absolute top-4 left-4 text-white/80 hover:text-white z-10",children:a.jsx(ln,{size:24})}),Ve&&a.jsx("div",{className:"absolute top-4 right-4 flex gap-2 z-10",children:a.jsxs("button",{onClick:()=>r("settings"),className:"text-white/80 hover:text-white",children:[" ",a.jsx(Yg,{size:20})," "]})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-0",children:[a.jsxs("div",{className:"relative group",children:[o?a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-white shadow-lg bg-gray-300 animate-pulse"}):a.jsx("img",{src:op,alt:mn,className:`w-20 h-20 rounded-full border-4 border-white shadow-lg object-cover bg-gray-300 ${Ve?"cursor-pointer":""}`,onClick:Ie}),Ve&&!N&&a.jsx("button",{onClick:Ie,className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-200","aria-label":"Change avatar",children:a.jsx(Ig,{size:24,className:"text-white"})}),N&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/70 rounded-full",children:a.jsx(ie,{size:24,className:"text-white animate-spin"})}),Ve&&a.jsx("input",{type:"file",ref:O,onChange:bt,accept:"image/png, image/jpeg, image/gif",className:"hidden"})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[o?a.jsx("div",{className:"h-8 bg-white/30 rounded w-3/4 animate-pulse mb-1"}):p&&Ve?a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:x,onChange:z=>b(z.target.value),className:"text-2xl font-bold bg-transparent border-b-2 border-white/50 focus:border-white outline-none text-white w-full pr-16",autoFocus:!0,maxLength:50,disabled:f}),a.jsxs("div",{className:"absolute top-0 right-0 flex gap-1 items-center h-full",children:[a.jsxs("button",{onClick:Ee,disabled:f,className:"text-green-300 hover:text-white disabled:opacity-50 p-1",children:[" ",f?a.jsx(ie,{size:20,className:"animate-spin"}):a.jsx(Jg,{size:20})," "]}),a.jsxs("button",{onClick:Me,disabled:f,className:"text-red-300 hover:text-white disabled:opacity-50 p-1",children:[" ",a.jsx(sy,{size:20})," "]})]}),k&&a.jsx("p",{className:"text-red-300 text-xs mt-1 absolute -bottom-5",children:k})]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-2xl font-bold truncate",children:mn}),Ve&&a.jsxs("button",{onClick:ve,className:"text-white/70 hover:text-white flex-shrink-0",children:[" ",a.jsx(Wg,{size:18})," "]})]}),A&&Ve&&a.jsx("p",{className:"text-red-300 text-xs mt-1",children:A}),o?a.jsx("div",{className:"h-4 bg-white/30 rounded w-1/2 animate-pulse mt-1"}):a.jsxs("div",{className:"text-sm opacity-90 mt-1 flex items-start gap-1",children:[a.jsx(Qn,{size:14,className:"mt-0.5 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:[" ",Ru.length>0?Ru.map(z=>n(z)).join(", "):"No gyms selected"," "]})]}),a.jsx("div",{className:"text-sm opacity-90 mt-2 flex items-center gap-4",children:rt?a.jsx(ie,{size:14,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>or("followers"),className:"hover:underline disabled:opacity-70",disabled:o||Te.followers===0,children:[a.jsx("strong",{className:"font-bold",children:Te.followers})," Followers"]}),a.jsxs("button",{onClick:()=>or("following"),className:"hover:underline disabled:opacity-70",disabled:o||Te.following===0,children:[a.jsx("strong",{className:"font-bold",children:Te.following})," Following"]})]})})]})]}),!Ve&&e&&a.jsx("div",{className:"absolute bottom-4 right-4 z-10",children:a.jsx("button",{onClick:ir,disabled:Q||q||o,className:`px-4 py-1.5 rounded-full text-sm font-semibold transition-colors duration-200 flex items-center gap-1.5 disabled:opacity-60 ${te?"bg-white text-brand-green hover:bg-gray-200":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:Q||q?a.jsx(ie,{size:16,className:"animate-spin"}):te?a.jsxs(a.Fragment,{children:[a.jsx(To,{size:16})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ni,{size:16})," Follow"]})})})]}),a.jsxs("main",{className:"p-4 -mt-12 relative z-0",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow mb-4 flex",children:[a.jsxs("button",{onClick:()=>h("logbook"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="logbook"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(Ch,{size:16})," Logbook "]}),Ve&&a.jsxs("button",{onClick:()=>h("wishlist"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="wishlist"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(uo,{size:16})," Wishlist "]}),a.jsxs("button",{onClick:()=>h("stats"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${d==="stats"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(jh,{size:16})," Stats "]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow min-h-[200px]",children:[d==="logbook"&&a.jsx("div",{children:Y&&j.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading logbook... "]}):ne?a.jsx("p",{className:"text-center text-red-500 p-6",children:ne}):j.length>0?a.jsxs(a.Fragment,{children:[j.map(Gr),F&&a.jsx("button",{onClick:hn,disabled:W,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:W?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No climbs logged yet."})}),d==="wishlist"&&Ve&&a.jsx("div",{children:ee&&T.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading wishlist... "]}):U?a.jsx("p",{className:"text-center text-red-500 p-6",children:U}):T.length>0?a.jsxs(a.Fragment,{children:[T.map(xr),ce&&a.jsx("button",{onClick:pn,disabled:pe,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:pe?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"Your wishlist is empty."})}),d==="stats"&&Bo()]})]}),Yt&&be&&a.jsx(ip,{userId:be,dialogType:Dt,currentUser:e,onClose:Le,onNavigate:r})]})},Hv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Gv=e=>{if(e&&e.toUpperCase().startsWith("V")){const r=e.substring(1).split("-"),n=parseInt(r[r.length-1],10);return isNaN(n)?-1:n}return-1},Pa=10,qv=({currentUser:e,viewingProfileId:t,onNavigate:r,getGymNameById:n,onBack:s})=>{const[i,o]=m.useState(null),[l,u]=m.useState(!0),[c,d]=m.useState(null),[h,p]=m.useState("logbook"),[v,x]=m.useState([]),[b,k]=m.useState(!0),[g,f]=m.useState(!1),[y,_]=m.useState(null),[S,N]=m.useState(0),[P,A]=m.useState(!0),[$,O]=m.useState(null),[j,V]=m.useState(!0),[Y,Z]=m.useState(null),[W,J]=m.useState(!1),[ne,w]=m.useState(!0),[C,I]=m.useState(!1),[F,E]=m.useState({followers:0,following:0}),[T,D]=m.useState(!0),[ee,ue]=m.useState(!1),[pe,De]=m.useState("followers"),U=t,fe=m.useCallback(async()=>{if(!U){o(null),u(!1),d("No user ID provided."),x([]),O(null),E({followers:0,following:0});return}u(!0),d(null);try{const{data:q,error:xe}=await H.from("profiles").select("*").eq("user_id",U).single();xe?(console.error("Error fetching public profile data:",xe),d(xe.code==="PGRST116"?"Profile not found.":"Failed to load profile."),o(null)):o(q)}catch(q){console.error("Unexpected error fetching public profile:",q),d(q.message||"An unexpected error occurred."),o(null)}finally{u(!1)}},[U]),oe=m.useCallback(async()=>{if(!e||!U||e.id===U){J(!1),w(!1);return}w(!0);try{const q=await Uo(e.id,U);J(q)}catch(q){console.error("Error checking follow status:",q)}finally{w(!1)}},[e,U]),K=m.useCallback(async()=>{if(!U){E({followers:0,following:0}),D(!1);return}D(!0);try{const q=await np(U);E({followers:q.followers,following:q.following})}catch(q){console.error("Error fetching follow counts:",q)}finally{D(!1)}},[U]),ce=m.useCallback(async(q=0,xe=!1)=>{if(!U){x([]),k(!1),f(!1),_(null),A(!1);return}xe?f(!0):(k(!0),x([]),N(0),A(!0)),_(null);const Te=q*Pa,ft=Te+Pa-1;try{const{data:rt,error:wt}=await H.from("user_route_progress").select(`
              attempts, sent_at, rating, updated_at,
              route:routes!inner(
                id, gym_id, name, grade, grade_color, date_set, location_id, removed_at,
                location_name:locations ( name )
              )
            `).eq("user_id",U).not("sent_at","is",null).order("sent_at",{ascending:!1}).range(Te,ft);if(wt)console.error("Error fetching public logbook:",wt),_("Failed to load climb log."),xe||x([]),A(!1);else if(rt){const Yt=rt.map(Xe=>{const Dt=Xe.route,Ut=Dt==null?void 0:Dt.location_name;return{...Dt,location_name:(Ut==null?void 0:Ut.name)||null,user_progress_attempts:Xe.attempts,user_progress_sent_at:Xe.sent_at,user_progress_rating:Xe.rating,user_progress_notes:null,user_progress_wishlist:!1,user_progress_updated_at:Xe.updated_at}});x(Xe=>xe?[...Xe,...Yt]:Yt),N(q),A(rt.length===Pa)}else xe||x([]),A(!1)}catch(rt){console.error("Unexpected error fetching public logbook:",rt),_(rt.message||"An unexpected error occurred."),xe||x([]),A(!1)}finally{k(!1),f(!1)}},[U]),me=m.useCallback(async()=>{if(!U){O(null),V(!1),Z(null);return}V(!0),Z(null);try{const{data:q,error:xe}=await H.from("user_route_progress").select(" route_id, route:routes ( grade ) ").eq("user_id",U).not("sent_at","is",null);if(xe)throw console.error("Error fetching public stats data:",xe),new Error("Failed to load data for stats calculation.");if(q){const Te=q.length,ft=new Set(q.map(Yt=>Yt.route_id)).size;let rt=null,wt=-1;q.forEach(Yt=>{var Dt;const Xe=(Dt=Yt.route)==null?void 0:Dt.grade;if(Xe){const Ut=Gv(Xe);Ut>wt&&(wt=Ut,rt=Xe)}}),O({totalSends:Te,uniqueRoutes:ft,highestGrade:rt})}else O({totalSends:0,uniqueRoutes:0,highestGrade:null})}catch(q){console.error("Unexpected error fetching public stats:",q),Z(q.message||"An unexpected error occurred while calculating stats."),O(null)}finally{V(!1)}},[U]);m.useEffect(()=>{u(!0),k(!0),V(!0),w(!0),D(!0),d(null),_(null),Z(null),N(0),A(!0),ue(!1),fe(),oe(),K(),ce(0),me()},[U,fe,oe,K,ce,me]);const we=async()=>{if(!(!e||!U||e.id===U||C)){I(!0);try{if(W)await Do(e.id,U),J(!1),E(q=>({...q,followers:Math.max(0,q.followers-1)}));else{await Fo(e.id,U),J(!0),E(Te=>({...Te,followers:Te.followers+1}));const q={followed_user_id:U,followed_user_name:(i==null?void 0:i.display_name)||"User"},{error:xe}=await H.from("activity_log").insert({user_id:e.id,gym_id:i==null?void 0:i.current_gym_id,activity_type:"follow_user",details:q});xe&&console.error("Error logging follow activity:",xe)}}catch(q){console.error("Error updating follow status:",q),await oe(),await K()}finally{I(!1)}}},ge=()=>{!g&&P&&ce(S+1,!0)},ke=q=>{U&&(De(q),ue(!0))},Be=()=>{ue(!1)},B=q=>{const xe=q.location_name||"Unknown Location",Te=!!q.removed_at;return a.jsxs("div",{onClick:()=>r("routeDetail",{routeId:q.id}),className:`flex items-center gap-3 p-3 border-b last:border-b-0 ${Te?"opacity-60 bg-gray-50":"hover:bg-gray-50 cursor-pointer"}`,children:[a.jsxs("div",{className:`w-8 h-8 ${Hv(q.grade_color)} rounded-full flex items-center justify-center text-white font-bold text-xs flex-shrink-0`,children:[" ",q.grade," "]}),a.jsxs("div",{className:"flex-grow overflow-hidden",children:[a.jsx("p",{className:`font-medium text-brand-gray truncate ${Te?"line-through":""}`,children:q.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[" ",xe," - Sent: ",q.user_progress_sent_at?new Date(q.user_progress_sent_at).toLocaleDateString():"N/A"," ",Te&&"(Removed)"," "]})]}),a.jsx(ts,{size:18,className:"text-green-500 flex-shrink-0",title:`Sent (${q.user_progress_attempts} attempts)`})]},q.id)},M=()=>j?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading stats... "]}):Y?a.jsxs("div",{className:"p-6 text-center text-red-500",children:[" ",a.jsx(yr,{size:20,className:"inline mr-1 mb-0.5"})," ",Y," "]}):$?a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-blue/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Total Sends"})," ",a.jsx("span",{className:"font-bold text-accent-blue",children:$.totalSends})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-purple/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Unique Routes Climbed"})," ",a.jsx("span",{className:"font-bold text-accent-purple",children:$.uniqueRoutes})," "]}),a.jsxs("div",{className:"flex justify-between items-center p-3 bg-accent-red/10 rounded-lg",children:[" ",a.jsx("span",{className:"text-sm font-medium text-brand-gray",children:"Highest Grade Sent"})," ",a.jsx("span",{className:"font-bold text-accent-red",children:$.highestGrade||"N/A"})," "]})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No stats available yet."});if(c)return a.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4 text-center",children:[a.jsx(yr,{size:48,className:"text-red-500 mb-4"}),a.jsx("h2",{className:"text-xl font-semibold text-brand-gray mb-2",children:"Error Loading Profile"}),a.jsx("p",{className:"text-red-600 mb-6",children:c}),a.jsx("button",{onClick:s,className:"mt-4 text-sm text-accent-blue underline",children:"Go Back"})]});const te=l?"Loading...":(i==null?void 0:i.display_name)||"Climber",X=l?"":(i==null?void 0:i.avatar_url)||`https://ui-avatars.com/api/?name=${encodeURIComponent(te)}&background=random&color=fff`,Q=l?[]:(i==null?void 0:i.selected_gym_ids)||[],Ne=(e==null?void 0:e.id)===U;return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[a.jsxs("header",{className:"bg-gradient-to-r from-brand-green to-brand-gray p-4 pt-8 pb-20 text-white relative",children:[a.jsx("button",{onClick:s,className:"absolute top-4 left-4 text-white/80 hover:text-white z-10",children:a.jsx(ln,{size:24})}),a.jsxs("div",{className:"flex items-center gap-4 relative z-0",children:[l?a.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-white shadow-lg bg-gray-300 animate-pulse"}):a.jsx("img",{src:X,alt:te,className:"w-20 h-20 rounded-full border-4 border-white shadow-lg object-cover bg-gray-300"}),a.jsxs("div",{className:"flex-grow min-w-0",children:[l?a.jsx("div",{className:"h-8 bg-white/30 rounded w-3/4 animate-pulse mb-1"}):a.jsx("h1",{className:"text-2xl font-bold truncate",children:te}),l?a.jsx("div",{className:"h-4 bg-white/30 rounded w-1/2 animate-pulse mt-1"}):a.jsxs("div",{className:"text-sm opacity-90 mt-1 flex items-start gap-1",children:[a.jsx(Qn,{size:14,className:"mt-0.5 flex-shrink-0"}),a.jsxs("span",{className:"truncate",children:[" ",Q.length>0?Q.map(q=>n(q)).join(", "):"No gyms selected"," "]})]}),a.jsx("div",{className:"text-sm opacity-90 mt-2 flex items-center gap-4",children:T?a.jsx(ie,{size:14,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>ke("followers"),className:"hover:underline disabled:opacity-70",disabled:l||F.followers===0,children:[a.jsx("strong",{className:"font-bold",children:F.followers})," Followers"]}),a.jsxs("button",{onClick:()=>ke("following"),className:"hover:underline disabled:opacity-70",disabled:l||F.following===0,children:[a.jsx("strong",{className:"font-bold",children:F.following})," Following"]})]})})]})]}),e&&!Ne&&a.jsx("div",{className:"absolute bottom-4 right-4 z-10",children:a.jsx("button",{onClick:we,disabled:ne||C||l,className:`px-4 py-1.5 rounded-full text-sm font-semibold transition-colors duration-200 flex items-center gap-1.5 disabled:opacity-60 ${W?"bg-white text-brand-green hover:bg-gray-200":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:ne||C?a.jsx(ie,{size:16,className:"animate-spin"}):W?a.jsxs(a.Fragment,{children:[a.jsx(To,{size:16})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ni,{size:16})," Follow"]})})})]}),a.jsxs("main",{className:"p-4 -mt-12 relative z-0",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow mb-4 flex",children:[a.jsxs("button",{onClick:()=>p("logbook"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${h==="logbook"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(Ch,{size:16})," Logbook "]}),a.jsxs("button",{onClick:()=>p("stats"),className:`flex-1 py-3 text-center text-sm font-medium flex items-center justify-center gap-1 ${h==="stats"?"text-accent-blue border-b-2 border-accent-blue":"text-brand-gray hover:bg-gray-50 rounded-t-lg"}`,children:[" ",a.jsx(jh,{size:16})," Stats "]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow min-h-[200px]",children:[h==="logbook"&&a.jsx("div",{children:b&&v.length===0?a.jsxs("div",{className:"flex justify-center items-center p-6",children:[" ",a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24})," Loading logbook... "]}):y?a.jsx("p",{className:"text-center text-red-500 p-6",children:y}):v.length>0?a.jsxs(a.Fragment,{children:[v.map(B),P&&a.jsx("button",{onClick:ge,disabled:g,className:"w-full text-center text-sm text-accent-blue hover:underline font-medium py-3 border-t disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?a.jsxs(a.Fragment,{children:[" ",a.jsx(ie,{className:"animate-spin mr-2",size:16})," Loading... "]}):"Show More"})]}):a.jsx("p",{className:"text-center text-gray-500 p-6",children:"No public climbs logged yet."})}),h==="stats"&&M()]})]}),ee&&U&&a.jsx(ip,{userId:U,dialogType:pe,currentUser:e,onClose:Be,onNavigate:r})]})},Wv=e=>{const t=(e==null?void 0:e.display_name)||"User",r=`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=random&color=fff`;return(e==null?void 0:e.avatar_url)||r},Kv=e=>{if(!e)return"bg-gray-400";const t={"accent-red":"bg-accent-red","accent-blue":"bg-accent-blue","accent-yellow":"bg-accent-yellow","brand-green":"bg-brand-green","accent-purple":"bg-accent-purple","brand-gray":"bg-brand-gray","brand-brown":"bg-brand-brown"};return t[e]||t[e.replace("_","-")]||"bg-gray-400"},Qv=({currentUser:e,activeGymId:t,onNavigate:r})=>{const[n,s]=m.useState(""),[i,o]=m.useState([]),[l,u]=m.useState(!1),[c,d]=m.useState(null),[h,p]=m.useState([]),[v,x]=m.useState(!1),[b,k]=m.useState(null),[g,f]=m.useState(new Map),[y,_]=m.useState(new Map),[S,N]=m.useState([]),[P,A]=m.useState(!1),[$,O]=m.useState(null),j=m.useRef(null),V=m.useCallback(async()=>{A(!0),O(null);try{const{data:w,error:C}=await H.from("routes").select("*, gym:gyms ( name )").is("removed_at",null).order("created_at",{ascending:!1}).limit(3);if(C)throw new Error(`Failed to fetch trending routes: ${C.message}`);if(w){const I=w.map(F=>{var E;return{...F,gym_name:((E=F.gym)==null?void 0:E.name)||"Unknown Gym"}});N(I)}else N([])}catch(w){console.error("Error fetching trending routes:",w),O(w.message||"An unexpected error occurred."),N([])}finally{A(!1)}},[]);m.useEffect(()=>{V()},[V]);const Y=m.useCallback(async w=>{if(!e||w.length===0){f(new Map);return}try{const{data:C,error:I}=await H.from("user_follows").select("following_id").eq("follower_id",e.id).in("following_id",w);if(I){console.error("Error fetching follow statuses:",I),f(new Map);return}const F=new Map;w.forEach(E=>{const T=(C==null?void 0:C.some(D=>D.following_id===E))??!1;F.set(E,T)}),f(E=>{const T=new Map(E);return F.forEach((D,ee)=>T.set(ee,D)),T})}catch(C){console.error("Unexpected error fetching follow statuses:",C),f(new Map)}},[e]),Z=m.useCallback(async()=>{if(!e||!t){p([]),x(!1),k(null);return}x(!0),k(null);try{const{data:w,error:C}=await H.rpc("get_suggested_climbers",{user_id_in:e.id,gym_id_in:t,limit_in:5});if(C)throw new Error(`Failed to fetch suggestions: ${C.message}`);const I=w||[];p(I),I.length>0&&Y(I.map(F=>F.user_id))}catch(w){console.error("Error fetching suggested climbers:",w),k(w.message||"An unexpected error occurred."),p([])}finally{x(!1)}},[e,t,Y]);m.useEffect(()=>{n.trim()?(p([]),x(!1),k(null)):Z()},[Z,t,n]);const W=m.useCallback(async w=>{if(!w.trim()||!e){o([]),u(!1),d(null);return}u(!0),d(null),p([]),x(!1),k(null);try{const{data:C,error:I}=await H.from("profiles").select("*").ilike("display_name",`%${w.trim()}%`).neq("user_id",e.id).limit(10);if(I)throw new Error(`Failed to search climbers: ${I.message}`);const F=C||[];o(F),F.length>0&&Y(F.map(E=>E.user_id))}catch(C){console.error("Error searching climbers:",C),d(C.message||"An unexpected error occurred."),o([])}finally{u(!1)}},[e,Y]);m.useEffect(()=>(j.current&&clearTimeout(j.current),n.trim()?j.current=setTimeout(()=>W(n),300):(o([]),u(!1),d(null),Z()),()=>{j.current&&clearTimeout(j.current)}),[n,W,Z]);const J=async(w,C)=>{if(!e||y.get(w))return;_(F=>new Map(F).set(w,!0));const I=g.get(w)||!1;try{if(I)await Do(e.id,w),f(F=>new Map(F).set(w,!1));else{await Fo(e.id,w),f(T=>new Map(T).set(w,!0));const F={followed_user_id:w,followed_user_name:C},{error:E}=await H.from("activity_log").insert({user_id:e.id,gym_id:t,activity_type:"follow_user",details:F});E&&console.error("Error logging follow activity:",E)}}catch(F){console.error("Error updating follow status:",F);const E=await Uo(e.id,w);f(T=>new Map(T).set(w,E))}finally{_(F=>new Map(F).set(w,!1))}},ne=w=>{const C=g.get(w.user_id)||!1,I=y.get(w.user_id)||!1;return a.jsxs("div",{className:"flex items-center justify-between gap-3 p-2 border-b last:border-b-0",children:[a.jsxs("button",{onClick:()=>r("publicProfile",{profileUserId:w.user_id}),className:"flex items-center gap-3 flex-grow hover:opacity-80",children:[a.jsx("img",{src:Wv(w),alt:w.display_name,className:"w-10 h-10 rounded-full object-cover bg-gray-300"}),a.jsx("div",{children:a.jsx("p",{className:"font-medium text-brand-gray text-sm",children:w.display_name})})]}),a.jsx("button",{onClick:()=>J(w.user_id,w.display_name),disabled:I||!e,className:`px-3 py-1 rounded-full text-xs font-semibold transition-colors duration-200 flex items-center gap-1 disabled:opacity-60 ${C?"bg-gray-200 text-brand-gray hover:bg-gray-300":"bg-accent-blue text-white hover:bg-opacity-90"}`,children:I?a.jsx(ie,{size:14,className:"animate-spin"}):C?a.jsxs(a.Fragment,{children:[a.jsx(To,{size:14})," Following"]}):a.jsxs(a.Fragment,{children:[a.jsx(ni,{size:14})," Follow"]})})]},w.user_id)};return a.jsxs("div",{className:"min-h-screen bg-gray-100 pb-16",children:[" ",a.jsx("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10",children:a.jsxs("h1",{className:"text-xl font-bold text-center text-brand-green flex items-center justify-center gap-2",children:[a.jsx(Eh,{size:24,className:"text-accent-blue"})," Discover"]})}),a.jsxs("main",{className:"p-4 space-y-6",children:[a.jsxs("section",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3 flex items-center gap-2",children:[a.jsx(ty,{size:20})," Community Highlights"]}),P?a.jsxs("div",{className:"flex justify-center items-center p-6 bg-white rounded-lg shadow",children:[a.jsx(ie,{className:"animate-spin text-accent-blue mr-2",size:24}),a.jsx("p",{className:"text-brand-gray",children:"Loading highlights..."})]}):$?a.jsx("p",{className:"text-center text-red-500 p-6 bg-white rounded-lg shadow",children:$}):S.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(w=>a.jsxs("div",{onClick:()=>r("routeDetail",{routeId:w.id}),className:"bg-white rounded-lg shadow overflow-hidden cursor-pointer hover:shadow-md transition-shadow",children:[w.image_url?a.jsx("img",{src:w.image_url,alt:w.name,className:"w-full h-32 object-cover"}):a.jsx("div",{className:`w-full h-32 ${Kv(w.grade_color)} flex items-center justify-center text-white font-bold text-2xl`,children:w.grade}),a.jsxs("div",{className:"p-3",children:[a.jsxs("p",{className:"font-semibold text-brand-gray truncate",children:[w.name," (",w.grade,")"]}),a.jsx("p",{className:"text-xs text-gray-500 truncate",children:w.gym_name})]})]},w.id))}):a.jsx("p",{className:"text-center text-gray-500 p-6 bg-white rounded-lg shadow",children:"No trending routes found right now."})]}),a.jsxs("section",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-brand-gray mb-3 flex items-center gap-2",children:[a.jsx(ny,{size:20})," Connect with Climbers"]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx("input",{type:"text",placeholder:"Search climbers by display name...",value:n,onChange:w=>s(w.target.value),className:"w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent-blue bg-white",disabled:!e}),a.jsx(ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow space-y-3",children:[l&&a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(ie,{className:"animate-spin text-accent-blue",size:24}),a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:"Searching..."})]}),v&&!n.trim()&&a.jsxs("div",{className:"flex justify-center items-center py-4",children:[a.jsx(ie,{className:"animate-spin text-accent-blue",size:24}),a.jsx("span",{className:"ml-2 text-sm text-brand-gray",children:"Loading suggestions..."})]}),c&&a.jsxs("p",{className:"text-center text-red-500 text-sm py-4 flex items-center justify-center gap-2",children:[a.jsx(yr,{size:18})," ",c]}),b&&!n.trim()&&!v&&a.jsxs("p",{className:"text-center text-red-500 text-sm py-4 flex items-center justify-center gap-2",children:[a.jsx(yr,{size:18})," ",b]}),!l&&!c&&n.trim()&&i.length>0&&i.map(ne),!l&&!c&&n.trim()&&i.length===0&&a.jsxs("p",{className:"text-center text-gray-500 text-sm py-4",children:['No climbers found matching "',n,'".']}),!n.trim()&&!v&&!b&&h.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-xs font-semibold text-brand-gray uppercase tracking-wide flex items-center gap-1.5 mb-1",children:[a.jsx(Po,{size:14,className:"text-accent-yellow"})," Suggestions for You"]}),h.map(ne)]}),!n.trim()&&!v&&!b&&h.length===0&&a.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"No suggestions found for your current gym right now."}),!e&&a.jsx("p",{className:"text-center text-gray-500 text-sm py-4",children:"Log in to connect with climbers."})]})]})]})]})},Jv=({title:e,feedbackType:t,onClose:r,currentUser:n})=>{const[s,i]=m.useState(""),[o,l]=m.useState(!1),[u,c]=m.useState(null),[d,h]=m.useState(!1),p=async v=>{if(v.preventDefault(),!s.trim()||!n){c(n?"Message cannot be empty.":"You must be logged in to send feedback.");return}l(!0),c(null),h(!1);try{await sp(t,s),h(!0),i(""),setTimeout(r,2e3)}catch(x){c(x.message||"An unexpected error occurred.")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-brand-gray",children:e}),a.jsx("button",{onClick:r,disabled:o,className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",children:a.jsx(Nu,{size:24})})]}),a.jsx("form",{onSubmit:p,className:"p-4 space-y-4",children:d?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(ts,{className:"mx-auto text-green-500 mb-2",size:40}),a.jsx("p",{className:"text-brand-gray font-medium",children:"Feedback Sent!"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for your input."})]}):a.jsxs(a.Fragment,{children:[a.jsx("textarea",{rows:5,value:s,onChange:v=>i(v.target.value),placeholder:"Enter your message here...",className:"w-full p-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-1 focus:ring-accent-blue disabled:bg-gray-100",required:!0,disabled:o||!n}),u&&a.jsx("p",{className:"text-red-500 text-sm text-center",children:u}),!n&&a.jsx("p",{className:"text-yellow-600 text-sm text-center bg-yellow-50 p-2 rounded border border-yellow-200",children:"You must be logged in to send feedback."}),a.jsx("button",{type:"submit",disabled:o||!s.trim()||!n,className:"w-full bg-accent-blue hover:bg-opacity-90 text-white font-bold py-2 px-4 rounded-md transition duration-300 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx(ie,{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ju,{size:18}),a.jsx("span",{children:"Send Feedback"})]})})]})})]})})},Yv=({currentUser:e,userMetadata:t,onNavigate:r,onLogout:n,onNavigateToGymSelection:s,onBack:i})=>{const[o,l]=m.useState(!1),[u,c]=m.useState(!1),d=async()=>{l(!0),await n()},h=({icon:p,label:v,onClick:x,isButton:b=!0,isDestructive:k=!1})=>a.jsxs("button",{onClick:x,disabled:!b||o,className:`flex items-center justify-between w-full p-4 text-left ${b?"hover:bg-gray-50 active:bg-gray-100":""} ${k?"text-red-600":"text-brand-gray"} disabled:opacity-50`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(p,{size:20,className:k?"text-red-500":"text-brand-gray"}),a.jsx("span",{className:"text-sm font-medium",children:v})]}),b&&!k&&a.jsx(Ug,{size:18,className:"text-gray-400"}),b&&k&&o&&a.jsx(ie,{size:18,className:"animate-spin"})]});return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("header",{className:"bg-white shadow-sm p-4 sticky top-0 z-10 flex items-center",children:[a.jsx("button",{onClick:i,className:"mr-4 text-brand-gray hover:text-brand-green",children:a.jsx(ln,{size:24})}),a.jsx("h1",{className:"text-xl font-bold text-brand-green",children:"Settings"})]}),a.jsxs("main",{className:"p-4 space-y-6 pb-10",children:[" ",a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Account"}),a.jsx(h,{icon:qg,label:"Logout",onClick:d,isDestructive:!0})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Gyms"}),a.jsx(h,{icon:Mg,label:"Manage My Gyms",onClick:s})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"Support"}),a.jsx(h,{icon:Ph,label:"Contact Us",onClick:()=>c(!0)})]}),a.jsxs("section",{className:"bg-white rounded-lg shadow overflow-hidden",children:[a.jsx("h2",{className:"text-xs font-semibold uppercase text-gray-500 px-4 pt-3 pb-1",children:"About"}),a.jsx(h,{icon:Vg,label:"App Version",isButton:!1}),a.jsxs("div",{className:"px-4 pb-3",children:[a.jsx("p",{className:"text-sm text-brand-gray ml-[32px]",children:"1.0.0 (Alpha)"})," "]})]})]}),u&&a.jsx(Jv,{title:"Contact Us",feedbackType:"contact",onClose:()=>c(!1),currentUser:e})]})},Xv=({currentView:e,onNavigate:t})=>{const r=[{name:"dashboard",label:"Home",icon:Bg},{name:"routes",label:"Routes",icon:Rh},{name:"log",label:"Log Climb",icon:Qg,isCenter:!0},{name:"discover",label:"Discover",icon:Eh},{name:"profile",label:"Profile",icon:Lo}];return a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_5px_rgba(0,0,0,0.1)] flex justify-around items-center h-16 z-20",children:r.map(n=>{const s=e===n.name,i=n.icon;return a.jsxs("button",{onClick:()=>t(n.name),className:`flex flex-col items-center justify-center flex-grow text-center px-2 transition-colors duration-200 ${s?"text-accent-blue":"text-brand-gray hover:text-accent-blue/80"} ${n.isCenter?"-mt-4":""}`,children:[a.jsx("div",{className:`${n.isCenter?"bg-accent-blue text-white rounded-full p-3 shadow-lg mb-1":""}`,children:a.jsx(i,{size:n.isCenter?28:24,strokeWidth:s?2.5:2})}),!n.isCenter&&a.jsx("span",{className:`text-xs mt-1 ${s?"font-semibold":""}`,children:n.label})]},n.name)})})};function Zv(){const[e,t]=m.useState("welcome"),[r,n]=m.useState("onboarding"),[s,i]=m.useState("dashboard"),[o,l]=m.useState([]),[u,c]=m.useState(null),[d,h]=m.useState(null),[p,v]=m.useState(null),[x,b]=m.useState(!1),[k,g]=m.useState(null),[f,y]=m.useState(null),[_,S]=m.useState(new Map),[N,P]=m.useState(!0),[A,$]=m.useState(!1),[O,j]=m.useState(!1),[V,Y]=m.useState(void 0),[Z,W]=m.useState(void 0),[J,ne]=m.useState(!1),[w,C]=m.useState(null),[I,F]=m.useState([]),[E,T]=m.useState(!1),D=m.useCallback(B=>{var M;return B?((M=_.get(B))==null?void 0:M.name)||"Loading Gym...":"Unknown Gym"},[_]);m.useEffect(()=>{(async()=>{const M=new Set;o.forEach(X=>M.add(X)),u&&M.add(u),f!=null&&f.selected_gym_ids&&f.selected_gym_ids.forEach(X=>M.add(X));const te=Array.from(M).filter(Boolean);if(te.length===0){S(new Map);return}j(!0);try{const{data:X,error:Q}=await H.from("gyms").select("id, name, city, state, country").in("id",te);if(Q)console.error("[Gym Details Effect] Error fetching gym details:",Q),S(new Map);else if(X){const Ne=new Map;X.forEach(q=>Ne.set(q.id,q)),S(Ne)}}catch(X){console.error("[Gym Details Effect] Unexpected error fetching gym details:",X),S(new Map)}finally{j(!1)}})()},[u,o,f]);const ee=m.useCallback(async B=>{console.log("[fetchUserMetadata] Fetching metadata for logged-in user:",B),$(!0);let M=null;try{const{data:te,error:X}=await H.from("profiles").select("*").eq("user_id",B).single();if(X&&X.code!=="PGRST116")console.error("[fetchUserMetadata] Error fetching user metadata:",X.message),y(null),l([]),c(null);else if(te){console.log("[fetchUserMetadata] User metadata fetched successfully:",te),y(te),M=te;const Q=te.selected_gym_ids||[],Ne=te.current_gym_id||null;l(Q);const q=Ne||(Q.length>0?Q[0]:null);c(q),Q.length>0?(t("complete"),n(xe=>xe==="onboarding"?"dashboard":xe)):(t("gymSelection"),n("onboarding"))}else console.log("[fetchUserMetadata] No user metadata found for user:",B),y(null),l([]),c(null),t("gymSelection"),n("onboarding")}catch(te){console.error("[fetchUserMetadata] Unexpected error during fetch:",te),y(null),l([]),c(null),t("gymSelection"),n("onboarding")}finally{$(!1)}return M},[]);m.useEffect(()=>{let B=!0;P(!0);const M=()=>{B&&(b(!1),g(null),y(null),l([]),c(null),h(null),v(null),S(new Map),n("onboarding"),t("auth"),i("dashboard"),$(!1),j(!1),W(void 0),ne(!1),C(null),Y(void 0),F([]),T(!1))};H.auth.getSession().then(({data:{session:X}})=>{B&&(g((X==null?void 0:X.user)??null),b(!!(X!=null&&X.user)),X!=null&&X.user||M(),P(!1))}).catch(X=>{console.error("[Auth Effect] Error getting initial session:",X),B&&(M(),P(!1))});const{data:te}=H.auth.onAuthStateChange((X,Q)=>{var Te;if(!B)return;const Ne=k==null?void 0:k.id,q=((Te=Q==null?void 0:Q.user)==null?void 0:Te.id)!==Ne,xe=!(Q!=null&&Q.user)&&!!Ne;(q||xe)&&(g((Q==null?void 0:Q.user)??null),b(!!(Q!=null&&Q.user)),Q!=null&&Q.user?($(!0),W(void 0),ne(!1),C(null),Y(void 0),F([]),T(!1),v(null)):M())});return()=>{B=!1,te==null||te.subscription.unsubscribe()}},[]),m.useEffect(()=>(k&&!N?ee(k.id).catch(B=>{console.error("[Data Fetch Effect] Error during metadata fetch:",B)}):k||$(!1),()=>{}),[k,ee,N]),m.useEffect(()=>{(async()=>{var M;if(r!=="routeDetail"&&r!=="addBeta"||!d){J||(W(void 0),C(null));return}console.log(`[Route Detail Effect] Fetching details for route ID: ${d} (View: ${r})`),ne(!0),C(null),W(void 0);try{const{data:te,error:X}=await H.from("routes").select("*, location_name:locations ( name )").eq("id",d).single();if(X)console.error("[Route Detail Effect] Error fetching route details:",X),C(X.code==="PGRST116"?"Route not found.":`Failed to load route details: ${X.message}`),W(null);else if(te){const Q={...te,location_name:((M=te.location_name)==null?void 0:M.name)||null};console.log("[Route Detail Effect] Route details fetched successfully:",Q),W(Q)}else console.warn("[Route Detail Effect] Route not found in DB (ID:",d,")"),C("Route not found."),W(null)}catch(te){console.error("[Route Detail Effect] Unexpected error fetching route details:",te),C("An unexpected error occurred while fetching route details."),W(null)}finally{ne(!1)}})()},[d,r]),m.useEffect(()=>{(async()=>{if(!u||r!=="log"){F([]),T(!1);return}T(!0);try{const{data:M,error:te}=await H.from("routes").select("id, gym_id, name, grade, grade_color, date_set, location_id, removed_at, location_name:locations ( name )").eq("gym_id",u).is("removed_at",null).order("name",{ascending:!0});if(te)console.error("[Active Gym Routes Effect] Error fetching routes:",te),F([]);else{const X=M.map(Q=>{var Ne;return{...Q,location_name:((Ne=Q.location_name)==null?void 0:Ne.name)||null}});F(X)}}catch(M){console.error("[Active Gym Routes Effect] Unexpected error:",M),F([])}finally{T(!1)}})()},[u,r]),m.useEffect(()=>{["log","settings","addBeta","publicProfile","profile"].includes(r)||i(r)},[r]);const ue=(B,M)=>{console.log(`Navigating to: ${B}`,M),B!=="routes"&&!(M!=null&&M.searchTerm)&&Y(void 0),B!=="profile"&&B!=="publicProfile"&&!(M!=null&&M.profileUserId)&&v(null),M!=null&&M.routeId&&(B==="routeDetail"||B==="addBeta")&&h(M.routeId),M!=null&&M.searchTerm&&B==="routes"&&Y(M.searchTerm),M!=null&&M.profileUserId&&(B==="profile"||B==="publicProfile")&&v(M.profileUserId),n(B)},pe=()=>{c(null),n("onboarding"),t("gymSelection")},De=async(B,M,te)=>{$(!0);try{const{error:X}=await H.from("profiles").upsert({user_id:B,selected_gym_ids:M,current_gym_id:te},{onConflict:"user_id"});X?(console.error("Error saving selected gyms (upsert):",X),alert(`Error saving gym selection: ${X.message}`),await ee(B)):(l(M),c(te),y(Q=>{var Ne;return Q?{...Q,selected_gym_ids:M,current_gym_id:te}:{user_id:B,display_name:((Ne=k==null?void 0:k.user_metadata)==null?void 0:Ne.display_name)||"Climber",selected_gym_ids:M,current_gym_id:te,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}),t("complete"),n("dashboard"))}catch(X){console.error("Unexpected error persisting gym selection:",X),alert("An unexpected error occurred while saving your gym selection."),k&&await ee(k.id)}finally{$(!1)}},U=async B=>{if(console.log(`Gym selection complete. Selected gyms: ${B.join(", ")}`),B.length>0&&k){const M=B[0],te=u&&B.includes(u)?u:M;await De(k.id,B,te)}else k?alert("Please select at least one gym."):(alert("Error: User session not found. Please try logging in again."),ge())},fe=B=>{l(B)},oe=()=>{$(!0)},K=async B=>{if(k&&B!==u){const M=u;c(B),n("dashboard"),h(null),$(!0);try{const{error:te}=await H.from("profiles").update({current_gym_id:B}).eq("user_id",k.id);te?(console.error("Error updating current gym:",te),c(M),alert(`Failed to switch gym: ${te.message}`)):y(X=>X?{...X,current_gym_id:B}:null)}catch(te){console.error("Unexpected error switching gym:",te),c(M),alert("An unexpected error occurred while switching gyms.")}finally{$(!1)}}},ce=()=>{console.log(`HandleBack called. Current view: ${r}, Previous view: ${s}`),r==="routeDetail"||r==="addBeta"?(n("routes"),h(null)):r==="routes"?(n("dashboard"),Y(void 0)):r==="log"||r==="settings"||r==="profile"||r==="publicProfile"?(n(s),(r==="profile"||r==="publicProfile")&&v(null)):r==="discover"?n("dashboard"):r==="onboarding"&&e==="gymSelection"?t("auth"):r==="onboarding"&&e==="gymSelection"&&x&&(f!=null&&f.selected_gym_ids)&&f.selected_gym_ids.length>0?(n("dashboard"),t("complete")):n("dashboard")},me=()=>{n("routeDetail")},we=()=>{n(s)},ge=async()=>{P(!0);const{error:B}=await H.auth.signOut();B&&(alert(`Logout failed: ${B.message}`),P(!1))},ke=()=>{switch(e){case"welcome":return a.jsx(iy,{onNext:()=>t("auth")});case"auth":return a.jsx(kv,{onAuthSuccess:oe});case"gymSelection":return a.jsx(jv,{preSelectedGymsIds:o,onGymsSelected:fe,onNext:U,currentUser:k});default:return null}};return(()=>{if(N||x&&(A||O))return a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ie,{className:"animate-spin mr-2"}),"Loading App..."]});if(!x||x&&e!=="complete"||r==="onboarding")return x&&e!=="complete"&&r!=="onboarding"?(n("onboarding"),a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ie,{className:"animate-spin mr-2"}),"Loading Onboarding..."]})):ke();if(x&&k&&e==="complete"){if(r==="onboarding")return n("dashboard"),a.jsxs("div",{className:"min-h-screen flex items-center justify-center text-brand-gray",children:[a.jsx(ie,{className:"animate-spin mr-2"}),"Redirecting..."]});const M=D(u),te=!["settings","addBeta","routeDetail","log","publicProfile"].includes(r),X=te?a.jsx(Xv,{currentView:r,onNavigate:ue}):null;let Q;switch(r){case"dashboard":Q=a.jsx(sd,{currentUser:k,selectedGyms:o,activeGymId:u,onSwitchGym:K,getGymNameById:D,onNavigateToGymSelection:pe,onNavigate:ue});break;case"routes":Q=a.jsx(Lv,{currentUser:k,activeGymId:u,activeGymName:M,onNavigate:ue,initialSearchTerm:V});break;case"routeDetail":Q=a.jsx(zv,{currentUser:k,route:Z,isLoading:J,error:w,onBack:ce,onNavigate:ue});break;case"addBeta":J?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-brand-gray",children:[a.jsx(ie,{className:"animate-spin mr-2"}),"Loading Route Info..."]}):w||!Z?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-red-500",children:["Error loading route context: ",w||"Route not found."," ",a.jsx("button",{onClick:ce,className:"underline",children:"Go Back"})]}):Q=a.jsx(Iv,{currentUser:k,route:Z,onBack:ce,onSubmitSuccess:me});break;case"log":E?Q=a.jsxs("div",{className:"p-4 pt-16 text-center text-brand-gray",children:[a.jsx(ie,{className:"animate-spin mr-2"}),"Loading Routes..."]}):Q=a.jsx(Dv,{currentUser:k,activeGymId:u,availableRoutes:I,onBack:ce,onSubmitSuccess:we});break;case"discover":Q=a.jsx(Qv,{currentUser:k,activeGymId:u,onNavigate:ue});break;case"profile":Q=a.jsx(Vv,{currentUser:k,viewingProfileId:null,onNavigate:ue,getGymNameById:D});break;case"publicProfile":p?Q=a.jsx(qv,{currentUser:k,viewingProfileId:p,onNavigate:ue,getGymNameById:D,onBack:ce}):(console.error("Error: viewingProfileId is missing for publicProfile view."),n("discover"),Q=a.jsx("div",{className:"p-4 pt-16 text-center text-red-500",children:"Error: Profile ID missing."}));break;case"settings":Q=a.jsx(Yv,{currentUser:k,userMetadata:f,onNavigate:ue,onLogout:ge,onNavigateToGymSelection:pe,onBack:ce});break;default:n("dashboard"),Q=a.jsx(sd,{currentUser:k,selectedGyms:o,activeGymId:u,onSwitchGym:K,getGymNameById:D,onNavigateToGymSelection:pe,onNavigate:ue})}return a.jsxs("div",{className:"font-sans",children:[" ",a.jsxs("div",{className:te?"pb-16":"",children:[" ",Q," "]})," ",X," "]})}return ke()})()}Sh(document.getElementById("root")).render(a.jsx(m.StrictMode,{children:a.jsx(Zv,{})}));export{ex as g};
